<!DOCTYPE html>
<!-- saved from url=(0044)https://leanpub.com/essentialtypescript/read -->
<html class="js no-touch multiplebgs svg inlinesvg svgclippaths no-ie8compat wf-notosans-n7-active wf-notosans-n4-active wf-notosans-i4-active wf-notosans-i7-active wf-notoserif-n4-active wf-notoserif-i4-active wf-notoserif-i7-active wf-notoserif-n7-active wf-active fa-events-icons-failed" lang="en" pp-init="true"><script src="https://js-agent.newrelic.com/nr-1026.min.js"></script><script async="" src="https://static.ads-twitter.com/uwt.js"></script><script src="./Read Essential TypeScript _ Leanpub_files/210960779347704" async=""></script><script async="" src="./Read Essential TypeScript _ Leanpub_files/fbevents.js.download"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script>inject()</script><script>var pb_whitelist = ["google","www.gmail.com","www.pinterest.com","www.youtube.com","www.facebook.com","search.yahoo.com","chrome://newtab"]</script><script>var pb_blacklist = ["adrunnr","successforyu.clickfunnels.com","fmovies.se","in-365-tagen.info","5000-settimanale.com","shop.mazzugioielli.com","maxigossip.com","lp.yazizim.com","beyourxfriend.com","99tab.com","zzqrt.com","canuck-method.net","bewomenly.com","playnow.guru","datingforyou-48e1.kxcdn.com","trafficnetworkads24.com","sistemadedinerogratis.com","canuckmethodprofit.co","consumerresearchnetwork.com","securemacfix.com","zz3d3.ru","zd1.quebec-bin.com","hot-games4you.xyz","om.elvenar.com","superpccleanup.com","gomediaz.com","judithi.xyz","free.atozmanuals.com","yoursuccess.ravpage.co.il","123hop.ir","quizcliente.pw","aussiemethod.biz","hlpnowp-c.com","picbumper.com","shaneless.com","anacondamonster.com","altrk1.com","health.todaydiets.com","download.weatherblink.com","happyluketh.com","go.ameinfo.com","50kaweek.net","thepornsurvey.com","ofsiite.ru","fulltab.com","1000spins.com","time2play-online.net","vintacars.com","welcome.pussysaga.com","free-desktop-games.com","download.televisionfanatic.com","theprofitsmaker.net","sgad.info","algocashmaster.net","sunmaker.com","topvipdreams.com","watchmygirlfriend.gfpornvideos.com","filesharefanatic.com","safedownloadhub.com","7awlalalam.blogspot.com","tvplusnewtab.com","trendingpatrol.com","moneymorning.com","ifileyou.com","classifiedcanada.ca","firefan.com","methode-binaire.com","letmetell.com","kenduktur.com","getafuk.com","yotraleplahnte.ru","jackpot.88beto.com","pwwysydh.com","search.queryrouter.com","v.lvztxy.com","pussysaga.com","saffamethod.com","prezzonline.com","searchprivacy.website","3d2819216eb4e1035879-7c248de0c99745406e9b749fc86ec3e4.ssl.cf1.rackcdn.com","only2date.com","mysagagame.com","themillionaireinpjs.net","wlt.kd2244.com","quickprivacycheck.com","hotchatdate.com","autotraderbot.com","z1.zedo.com","youlucky2014.com","traffic.getmyads.com","appcloudprotected.com","safensecure.com-allsites3.xyz","newpoptab.com","static.williamhill.com","myhealthyblog.co","greatestmobideals.com","sweetclarity.com","mgid.com","securepccure.com","autopengebygger.com","am15.net","es.reimageplus.com","o2.promos-info.com","it.reimageplus.com","westsluts.com","spinandwin.com-ser.pw","reimageplus.com","vodafone.promos-info.com","vinnmatpengar.se","movie.ienjoyapps.com","love4single.com","origin.getprice.com.au","ohmydating.com","lp.want-to-win.com","yabuletchrome.ru","bamdad.net","gotositenow.com","vcrypt.pw","newtabtv.com","mon.setsu.xyz","youforgottorenewyourhosting.com","zone-telechargement.ws","land.pckeeper.software","ad.adpop-1.com","advancedpctools.com","videos.randolphcountyheraldtribune.com","web-start.org","softreadynow.installupgradenowfreshandforyou.website","uplod.ws","pornhubcasino.com","maxbet.ro","2016prizefeed.com","thevideo.me","wantubad.com","tavanero.com","xcusmy.club","daclips.in","gaymenofporn.online","jackpotcitycasino.com","italian-method.com","getsearchincognito.com","youjustwonprize.com","finanz-nachrichten.me","quizcliente.site","da.reimageplus.com","jkanime.net","britmoneymethod.com","uae.souq.com","ka.azzer.net","safensecure.xyz","8t.hootingrhejkz.online","www6.blinkx.com","wizzcaster.com","comparaison-prix.com","vodlocker.lol","fr.reimageplus.com","free.fromdoctopdf.com","userscloud.com","myprivatesearch.com","fanli90.cn","tutticodicisconto.it","mediadec.com","gogamego.thewhizproducts.com","download.weatherblink.com","free.videodownloadconverter.com","we-are-gamers.com","sesso.communityadult.net","lp.blpmovies.com","search.queryrouter.com","bbb-johannesburg.localspecific.com","lp.blpmovies.com","go.ppixelm.com","r0.ru","sesso.communityadult.net","bbb-johannesburg.localspecific.com","ppixelm.com","cyberguardianspe.info","we-are-gamers.com","loginfaster.com/new","www.alfacart.com","www.foresee.com","mobile-win.com","www.plusnetwork.com","www.amicafarmacia.com","www.ienjoyapps.com","cheapcheap.io","screenaddict.thewhizproducts.com","nova.rambler.ru","free.gamingwonderland.com","p9328ujeiw1.ru","mobilecasinoclub.co.uk","pfhsystem.com","regtuneup.com","theprofitsmaker.net","bodogpromotions.eu","heroesreplay.org","financialsecrets.info","mymoneymakingapp.com","sunmaker.com","888casino-promotions.com","vogliosesso.com","scienceremix.com","allinonedocs.com","arabia.starzplay.com","allirishcasino.com","advancepctools.info","movie.ienjoyapps.com","surveyform001.s3-website-us-east-1.amazonaws.com","mgs188.com","pfhsystem.com","lpeva.com","ddsh8.com","theprofitsmaker.net","b2.ijquery11.com","sporthero.thewhizmarketing.com","securefastmac.tech","seen-on-screen.thewhizmarketing.com","1000spins.com","search.queryrouter.com","pfhsystem.com","reimageplus.com","offer.alibaba.com","searchlistings.org","search.queryrouter.com","search.queryrouter.com","mybinaryoptionsrobot.com","duplicashapp.com","search.queryrouter.com","bestgame.directory","droidclub.net",".rivalo.com","yoursuperprize.com","mediaexplained.com","om.elvenar.com","shinar.club","revitoleczemacream.com","freelotto.com","screenaddict.thewhizproducts.com","download.bringmesports.com/","allinonedocs.com","driver-fixer.com","arabydeal.com","cleanyourcomputertoday.com","arabydeal.com","music.mixplugin.com","1se.info","survey12.com","freesoftwaredlul.com","pldist01.com","ad.adpop-1.com","searchanonymous.net","abrst.pro","muzikfury.thewhizmarketing.com","lp.mbtrx.com","th1.forfun.maxisize-pro.com","watchmygirlfriend.gfpornbox.com","new.freelotto.com","desktoptrack.com","search.queryrouter.com","offer.alibaba.com","1000spins.com","promotions.coral.co.uk","search.queryrouter.com","tbsia.com","tbsia.com","multtaepyo.com","search.queryrouter.com","czechmethod.com","consumerview.co","wayretail.com","72onbase.com","funsafetab.com","search.queryrouter.com","speedyfiledownload.com","driver-fixer.com","arabydeal.com","cleanyourcomputertoday.com","arabydeal.com","music.mixplugin.com","1se.info","survey12.com","freesoftwaredlul.com","pldist01.com","ad.adpop-1.com","searchanonymous.net","abrst.pro","muzikfury.thewhizmarketing.com","lp.mbtrx.com","th1.forfun.maxisize-pro.com","watchmygirlfriend.gfpornbox.com","new.freelotto.com","desktoptrack.com","search.queryrouter.com","offer.alibaba.com","1000spins.com","promotions.coral.co.uk","search.queryrouter.com","tbsia.com","tbsia.com","surveyform001.s3-website-us-east-1.amazonaws.com","mgs188.com","pfhsystem.com","lpeva.com","ddsh8.com","theprofitsmaker.net","quantomcoding.com","sporthero.thewhizmarketing.com","popads.net","onclkds.com","consumerview.co","12kotov.ru","ruhotpair2.fingta.com","easytelevisionaccessnow.com","ahwrd.com","lpeva.com","ppgzf.com","zjstx.com","kituure.xyz","join.pro-gaming-world.com","mackeeperapp.mackeeper.com","tracknotify.com","2075.cdn.beyondhosting.net","idollash.com","ds.moviegoat.com","fulltab.com","rackcdn.com","prestoris.com","adsterra.com","swampssovuuhusp.top","streesusa.info","freesoftwaredlul.com","adreactor.com","a-static.com","codeonclick.com","heheme.com","adf.ly","seen-on-screen.thewhizmarketing.com","openload.co"]</script><script id="pb_blockScript">function inject() {
	  var originalOpenWndFnKey = "originalOpenFunction";
	  var originalWindowOpenFn = window.open;
	  var originalCreateElementFn = document.createElement;
	  var originalAppendChildFn = HTMLElement.prototype.appendChild;
	  var originalCreateEventFn = document.createEvent;
	  var windowsWithNames = {};
	  var timeSinceCreateAElement = 0;
	  var lastCreatedAElement = null;
	  var fullScreenOpenTime = void 0;
	  var abd = false;
	  var parentOrigin = window.location != window.parent.location ? document.referrer : document.location;
	  var parentRef = window.parent;

	  window[originalOpenWndFnKey] = window.open; // save the original open window as global param
	  window.pb_isRunning = true; // is running
	  function newWindowOpenFn() {
	    var openWndArguments = arguments;
	    var useOriginalOpenWnd = true;
	    var generatedWindow = null;

	    function getWindowName(openWndArguments) {
	      var windowName = openWndArguments[1];
	      if (windowName != null && !["_blank", "_parent", "_self", "_top"].includes(windowName)) {
	        return windowName;
	      }

	      return null;
	    }

	    function copyMissingProperties(src, dest) {
	      var prop = void 0;
	      for (prop in src) {
	        try {
	          if (dest[prop] === undefined && src[prop]) {
	            dest[prop] = src[prop];
	          }
	        } catch (e) {}
	      }
	      return dest;
	    }

	    // the element who registered to the event
	    var capturingElement = null;
	    if (window.event != null) {
	      capturingElement = window.event.currentTarget;
	    }

	    if (capturingElement == null) {
	      var caller = openWndArguments.callee;
	      while (caller.arguments != null && caller.arguments.callee.caller != null) {
	        caller = caller.arguments.callee.caller;
	      }
	      if (caller.arguments != null && caller.arguments.length > 0 && caller.arguments[0].currentTarget != null) {
	        capturingElement = caller.arguments[0].currentTarget;
	      }
	    }

	    /////////////////////////////////////////////////////////////////////////////////
	    // Blocked if a click on background element occurred (<body> or document)
	    /////////////////////////////////////////////////////////////////////////////////

	    if (capturingElement != null && (capturingElement instanceof Window || capturingElement === document || capturingElement.URL != null && capturingElement.body != null || capturingElement.nodeName != null && (capturingElement.nodeName.toLowerCase() == "body" || capturingElement.nodeName.toLowerCase() == "document"))) {
	      window.pbreason = "Blocked a new window opened with URL: " + openWndArguments[0] + " because it was triggered by the " + capturingElement.nodeName + " element";
	      useOriginalOpenWnd = false;
	    } else {
	      useOriginalOpenWnd = true;
	    }
	    /////////////////////////////////////////////////////////////////////////////////


	    /////////////////////////////////////////////////////////////////////////////////
	    // Block if a full screen was just initiated while opening this url.
	    /////////////////////////////////////////////////////////////////////////////////

	    var fullScreenElement = document.webkitFullscreenElement || document.mozFullscreenElement || document.fullscreenElement;
	    if (new Date().getTime() - fullScreenOpenTime < 1000 || isNaN(fullScreenOpenTime) && isDocumentInFullScreenMode()) {

	      window.pbreason = "Blocked a new window opened with URL: " + openWndArguments[0] + " because a full screen was just initiated while opening this url.";

	      /* JRA REMOVED
	       if (window[script_params.fullScreenFnKey]) {
	       window.clearTimeout(window[script_params.fullScreenFnKey]);
	       }
	       */

	      if (document.exitFullscreen) {
	        document.exitFullscreen();
	      } else if (document.mozCancelFullScreen) {
	        document.mozCancelFullScreen();
	      } else if (document.webkitCancelFullScreen) {
	        document.webkitCancelFullScreen();
	      }

	      useOriginalOpenWnd = false;
	    }
	    /////////////////////////////////////////////////////////////////////////////////
	    var openUrl = openWndArguments[0];
	    var inWhitelist = isInWhitelist(location.href);

	    if (inWhitelist) {
	      useOriginalOpenWnd = true;
	    } else if (isInBlacklist(openUrl)) {
	      useOriginalOpenWnd = false;
	    }

	    if (useOriginalOpenWnd == true) {
	      generatedWindow = originalWindowOpenFn.apply(this, openWndArguments);
	      // save the window by name, for latter use.
	      var windowName = getWindowName(openWndArguments);
	      if (windowName != null) {
	        windowsWithNames[windowName] = generatedWindow;
	      }

	      // 2nd line of defence: allow window to open but monitor carefully...

	      /////////////////////////////////////////////////////////////////////////////////
	      // Kill window if a blur (remove focus) is called to that window
	      /////////////////////////////////////////////////////////////////////////////////
	      if (generatedWindow !== window) {
	        (function () {
	          var openTime = new Date().getTime();
	          var originalWndBlurFn = generatedWindow.blur;
	          generatedWindow.blur = function () {
	            if (new Date().getTime() - openTime < 1000 && !inWhitelist /* one second */) {
	                window.pbreason = "Blocked a new window opened with URL: " + openWndArguments[0] + " because a it was blured";
	                generatedWindow.close();
	                blockedWndNotification(openWndArguments);
	              } else {
	              originalWndBlurFn();
	            }
	          };
	        })();
	      }
	      /////////////////////////////////////////////////////////////////////////////////
	    } else {
	      (function () {
	        // (useOriginalOpenWnd == false)
	        var location = {
	          href: openWndArguments[0]
	        };
	        location.replace = function (url) {
	          location.href = url;
	        };

	        generatedWindow = {
	          close: function close() {
	            return true;
	          },
	          test: function test() {
	            return true;
	          },
	          blur: function blur() {
	            return true;
	          },
	          focus: function focus() {
	            return true;
	          },
	          showModelessDialog: function showModelessDialog() {
	            return true;
	          },
	          showModalDialog: function showModalDialog() {
	            return true;
	          },
	          prompt: function prompt() {
	            return true;
	          },
	          confirm: function confirm() {
	            return true;
	          },
	          alert: function alert() {
	            return true;
	          },
	          moveTo: function moveTo() {
	            return true;
	          },
	          moveBy: function moveBy() {
	            return true;
	          },
	          resizeTo: function resizeTo() {
	            return true;
	          },
	          resizeBy: function resizeBy() {
	            return true;
	          },
	          scrollBy: function scrollBy() {
	            return true;
	          },
	          scrollTo: function scrollTo() {
	            return true;
	          },
	          getSelection: function getSelection() {
	            return true;
	          },
	          onunload: function onunload() {
	            return true;
	          },
	          print: function print() {
	            return true;
	          },
	          open: function open() {
	            return this;
	          },

	          opener: window,
	          closed: false,
	          innerHeight: 480,
	          innerWidth: 640,
	          name: openWndArguments[1],
	          location: location,
	          document: { location: location }
	        };

	        copyMissingProperties(window, generatedWindow);

	        generatedWindow.window = generatedWindow;

	        var windowName = getWindowName(openWndArguments);
	        if (windowName != null) {
	          try {
	            // originalWindowOpenFn("", windowName).close();
	            windowsWithNames[windowName].close();
	          } catch (err) {}
	        }

	        var fnGetUrl = function fnGetUrl() {
	          var url = void 0;
	          if (!(generatedWindow.location instanceof Object)) {
	            url = generatedWindow.location;
	          } else if (!(generatedWindow.document.location instanceof Object)) {
	            url = generatedWindow.document.location;
	          } else if (location.href != null) {
	            url = location.href;
	          } else {
	            url = openWndArguments[0];
	          }
	          openWndArguments[0] = url;

	          blockedWndNotification(openWndArguments);
	        };

	        //why set timeout?  if anyone finds a reason for it, please write it here
	        //in iframes it makes me problems
	        if (top == self) {
	          setTimeout(fnGetUrl, 100);
	        } else {
	          fnGetUrl();
	        }
	      })();
	    }

	    return generatedWindow;
	  }

	  /////////////////////////////////////////////////////////////////////////////////
	  // Replace the window open method with Poper Blocker's
	  /////////////////////////////////////////////////////////////////////////////////
	  window.open = function () {
	    try {
	      return newWindowOpenFn.apply(this, arguments);
	    } catch (err) {
	      return null;
	    }
	  };
	  /////////////////////////////////////////////////////////////////////////////////


	  //////////////////////////////////////////////////////////////////////////////////////////////////////////
	  // Monitor dynamic html element creation to prevent generating <a> elements with click dispatching event
	  //////////////////////////////////////////////////////////////////////////////////////////////////////////
	  HTMLElement.prototype.appendChild = function () {
	    var newElement = originalAppendChildFn.apply(this, arguments);

	    if (newElement.nodeName == 'IFRAME' && newElement.contentWindow) {
	      try {
	        newElement.contentWindow.eval(inject.toString() + ';inject();');
	      } catch (e) {}
	    }

	    return newElement;
	  };

	  document.createElement = function () {

	    var newElement = originalCreateElementFn.apply(document, arguments);

	    if (arguments[0] == "a" || arguments[0] == "A") {
	      (function () {

	        timeSinceCreateAElement = new Date().getTime();

	        var originalDispatchEventFn = newElement.dispatchEvent;

	        newElement.dispatchEvent = function (event) {
	          if (event.type != null && ("" + event.type).toLocaleLowerCase() == "click") {
	            if (!isInWhitelist(newElement.href)) {
	              window.pbreason = "blocked due to an explicit dispatchEvent event with type 'click' on an 'a' tag";

	              parent.postMessage({
	                type: "blockedWindow",
	                args: JSON.stringify({ "0": newElement.href, "abd": abd })
	              }, parentOrigin);
	              return true;
	            }
	          }

	          return originalDispatchEventFn.call(this, event);
	        };

	        lastCreatedAElement = newElement;
	      })();
	    }

	    return newElement;
	  };
	  /////////////////////////////////////////////////////////////////////////////////


	  /////////////////////////////////////////////////////////////////////////////////
	  // Block artificial mouse click on frashly created <a> elements
	  /////////////////////////////////////////////////////////////////////////////////
	  document.createEvent = function () {
	    try {
	      if (arguments[0].toLowerCase().includes("mouse") && new Date().getTime() - timeSinceCreateAElement <= 50) {
	        //block if the origin is not same
	        var isSelfDomain = false;
	        try {
	          var openUrlDomain = new URL(lastCreatedAElement.href).hostname;
	          var topUrl = window.location != window.parent.location ? document.referrer : document.location.href;
	          var topDomain = new URL(topUrl).hostname;
	          isSelfDomain = openUrlDomain == topDomain;
	        } catch (e) {}
	        if (!isInWhitelist(lastCreatedAElement.href) && !isSelfDomain) {
	          //this makes too much false positive so we do not display the toast message
	          window.pbreason = "Blocked because 'a' element was recently created and " + arguments[0] + " event was created shortly after";
	          arguments[0] = lastCreatedAElement.href;

	          parent.postMessage({
	            type: "blockedWindow",
	            args: JSON.stringify({ "0": lastCreatedAElement.href, "abd": abd })
	          }, parentOrigin);

	          return null;
	        }
	      }

	      return originalCreateEventFn.apply(document, arguments);
	    } catch (err) {}
	  };
	  /////////////////////////////////////////////////////////////////////////////////


	  /////////////////////////////////////////////////////////////////////////////////
	  // Monitor full screen requests
	  /////////////////////////////////////////////////////////////////////////////////
	  function onFullScreen(isInFullScreenMode) {
	    if (isInFullScreenMode) {
	      fullScreenOpenTime = new Date().getTime();
	    } else {
	      fullScreenOpenTime = NaN;
	    }
	  }

	  /////////////////////////////////////////////////////////////////////////////////

	  function isDocumentInFullScreenMode() {
	    // Note that the browser fullscreen (triggered by short keys) might
	    // be considered different from content fullscreen when expecting a boolean
	    return document.fullScreenElement && document.fullScreenElement !== null || // alternative standard methods
	    document.mozFullscreenElement != null || document.webkitFullscreenElement != null; // current working methods
	  }

	  function isInWhitelist(url) {
	    return isInList(url, window.pb_whitelist);
	  }

	  function isInBlacklist(url) {
	    return isInList(url, window.pb_blacklist);
	  }

	  function isInList(url, list) {
	    if (list) {
	      return list.some(function (li) {
	        return new RegExp("https?://(www\.|.*\.)?" + li + "+").test(url);
	      });
	    } else {
	      return false;
	    }
	  }

	  function blockedWndNotification(openWndArguments) {
	    openWndArguments["abd"] = abd;

	    parentRef.postMessage({ type: "blockedWindow", args: JSON.stringify(openWndArguments) }, parentOrigin);
	  }

	  //detect adblock to adjust popup blocking behavior to not collide with adblock
	  (function () {
	    try {
	      var tester = document.createElement('div');
	      tester.innerHTML = '&nbsp;';
	      tester.className = 'adsbox';
	      tester.style.cssText = "position:absolute;top-1000px;left:-1000px;";

	      (document.body || document.head).appendChild(tester);
	      window.setTimeout(function () {
	        if (tester.offsetHeight === 0) {
	          abd = true;
	        }

	        tester.remove();
	      }, 100);
	    } catch (e) {}
	  })();

	  document.addEventListener("fullscreenchange", function () {
	    onFullScreen(document.fullscreen);
	  }, false);

	  document.addEventListener("mozfullscreenchange", function () {
	    onFullScreen(document.mozFullScreen);
	  }, false);

	  document.addEventListener("webkitfullscreenchange", function () {
	    onFullScreen(document.webkitIsFullScreen);
	  }, false);

	  document.getElementsByTagName("html")[0].setAttribute("PP-INIT", true);
	}</script><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"316786248d","applicationID":"8006771","transactionName":"e14PEEIKDlsARx1BUllVEktDDQ1A","queueTime":0,"applicationTime":1127,"agent":""}</script>
<script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"VQYCWFVQDBAIVFFUAAYG"};window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o||n)},o,o.exports)}return n[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,n,e){function r(t){try{s.console&&console.log(t)}catch(n){}}var o,i=t("ee"),a=t(15),s={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(s.console=!0,o.indexOf("dev")!==-1&&(s.dev=!0),o.indexOf("nr_dev")!==-1&&(s.nrDev=!0))}catch(c){}s.nrDev&&i.on("internal-error",function(t){r(t.stack)}),s.dev&&i.on("fn-err",function(t,n,e){r(e.stack)}),s.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(s,function(t,n){return t}).join(", ")))},{}],2:[function(t,n,e){function r(t,n,e,r,o){try{d?d-=1:i("err",[o||new UncaughtException(t,n,e)])}catch(s){try{i("ierr",[s,c.now(),!0])}catch(u){}}return"function"==typeof f&&f.apply(this,a(arguments))}function UncaughtException(t,n,e){this.message=t||"Uncaught error with no additional information",this.sourceURL=n,this.line=e}function o(t){i("err",[t,c.now()])}var i=t("handle"),a=t(16),s=t("ee"),c=t("loader"),f=window.onerror,u=!1,d=0;c.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(l){"stack"in l&&(t(8),t(7),"addEventListener"in window&&t(5),c.xhrWrappable&&t(9),u=!0)}s.on("fn-start",function(t,n,e){u&&(d+=1)}),s.on("fn-err",function(t,n,e){u&&(this.thrown=!0,o(e))}),s.on("fn-end",function(){u&&!this.thrown&&d>0&&(d-=1)}),s.on("internal-error",function(t){i("ierr",[t,c.now(),!0])})},{}],3:[function(t,n,e){t("loader").features.ins=!0},{}],4:[function(t,n,e){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t("ee"),i=t("handle"),a=t(8),s=t(7),c="learResourceTimings",f="addEventListener",u="resourcetimingbufferfull",d="bstResource",l="resource",p="-start",h="-end",m="fn"+p,w="fn"+h,v="bstTimer",y="pushState",g=t("loader");g.features.stn=!0,t(6);var b=NREUM.o.EV;o.on(m,function(t,n){var e=t[0];e instanceof b&&(this.bstStart=g.now())}),o.on(w,function(t,n){var e=t[0];e instanceof b&&i("bst",[e,n,this.bstStart,g.now()])}),a.on(m,function(t,n,e){this.bstStart=g.now(),this.bstType=e}),a.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),this.bstType])}),s.on(m,function(){this.bstStart=g.now()}),s.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),"requestAnimationFrame"])}),o.on(y+p,function(t){this.time=g.now(),this.startPath=location.pathname+location.hash}),o.on(y+h,function(t){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance["c"+c]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["c"+c]()},!1):window.performance[f]("webkit"+u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["webkitC"+c]()},!1)),document[f]("scroll",r,{passive:!0}),document[f]("keypress",r,!1),document[f]("click",r,!1)}},{}],5:[function(t,n,e){function r(t){for(var n=t;n&&!n.hasOwnProperty(u);)n=Object.getPrototypeOf(n);n&&o(n)}function o(t){s.inPlace(t,[u,d],"-",i)}function i(t,n){return t[1]}var a=t("ee").get("events"),s=t(18)(a,!0),c=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";n.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,n){var e=t[1],r=c(e,"nr@wrapped",function(){function t(){if("function"==typeof e.handleEvent)return e.handleEvent.apply(e,arguments)}var n={object:t,"function":e}[typeof e];return n?s(n,"fn-",null,n.name||"anonymous"):e});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],6:[function(t,n,e){var r=t("ee").get("history"),o=t(18)(r);n.exports=r,o.inPlace(window.history,["pushState","replaceState"],"-")},{}],7:[function(t,n,e){var r=t("ee").get("raf"),o=t(18)(r),i="equestAnimationFrame";n.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],8:[function(t,n,e){function r(t,n,e){t[0]=a(t[0],"fn-",null,e)}function o(t,n,e){this.method=e,this.timerDuration="number"==typeof t[1]?t[1]:0,t[0]=a(t[0],"fn-",this,e)}var i=t("ee").get("timer"),a=t(18)(i),s="setTimeout",c="setInterval",f="clearTimeout",u="-start",d="-";n.exports=i,a.inPlace(window,[s,"setImmediate"],s+d),a.inPlace(window,[c],c+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(c+u,r),i.on(s+u,o)},{}],9:[function(t,n,e){function r(t,n){d.inPlace(n,["onreadystatechange"],"fn-",s)}function o(){var t=this,n=u.context(t);t.readyState>3&&!n.resolved&&(n.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,w,"fn-",s)}function i(t){v.push(t),h&&(g=-g,b.data=g)}function a(){for(var t=0;t<v.length;t++)r([],v[t]);v.length&&(v=[])}function s(t,n){return n}function c(t,n){for(var e in t)n[e]=t[e];return n}t(5);var f=t("ee"),u=f.get("xhr"),d=t(18)(u),l=NREUM.o,p=l.XHR,h=l.MO,m="readystatechange",w=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],v=[];n.exports=u;var y=window.XMLHttpRequest=function(t){var n=new p(t);try{u.emit("new-xhr",[n],n),n.addEventListener(m,o,!1)}catch(e){try{u.emit("internal-error",[e])}catch(r){}}return n};if(c(p,y),y.prototype=p.prototype,d.inPlace(y.prototype,["open","send"],"-xhr-",s),u.on("send-xhr-start",function(t,n){r(t,n),i(n)}),u.on("open-xhr-start",r),h){var g=1,b=document.createTextNode(g);new h(a).observe(b,{characterData:!0})}else f.on("fn-end",function(t){t[0]&&t[0].type===m||a()})},{}],10:[function(t,n,e){function r(t){var n=this.params,e=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!n.aborted){if(e.duration=a.now()-this.startTime,4===t.readyState){n.status=t.status;var i=o(t,this.lastSize);if(i&&(e.rxSize=i),this.sameOrigin){var c=t.getResponseHeader("X-NewRelic-App-Data");c&&(n.cat=c.split(", ").pop())}}else n.status=0;e.cbTime=this.cbTime,f.emit("xhr-done",[t],t),s("xhr",[n,e,this.startTime])}}}function o(t,n){var e=t.responseType;if("json"===e&&null!==n)return n;var r="arraybuffer"===e||"blob"===e||"json"===e?t.response:t.responseText;return h(r)}function i(t,n){var e=c(n),r=t.params;r.host=e.hostname+":"+e.port,r.pathname=e.pathname,t.sameOrigin=e.sameOrigin}var a=t("loader");if(a.xhrWrappable){var s=t("handle"),c=t(11),f=t("ee"),u=["load","error","abort","timeout"],d=u.length,l=t("id"),p=t(14),h=t(13),m=window.XMLHttpRequest;a.features.xhr=!0,t(9),f.on("new-xhr",function(t){var n=this;n.totalCbs=0,n.called=0,n.cbTime=0,n.end=r,n.ended=!1,n.xhrGuids={},n.lastSize=null,p&&(p>34||p<10)||window.opera||t.addEventListener("progress",function(t){n.lastSize=t.loaded},!1)}),f.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on("open-xhr-end",function(t,n){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&n.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),f.on("send-xhr-start",function(t,n){var e=this.metrics,r=t[0],o=this;if(e&&r){var i=h(r);i&&(e.txSize=i)}this.startTime=a.now(),this.listener=function(t){try{"abort"===t.type&&(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof n.onload))&&o.end(n)}catch(e){try{f.emit("internal-error",[e])}catch(r){}}};for(var s=0;s<d;s++)n.addEventListener(u[s],this.listener,!1)}),f.on("xhr-cb-time",function(t,n,e){this.cbTime+=t,n?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof e.onload||this.end(e)}),f.on("xhr-load-added",function(t,n){var e=""+l(t)+!!n;this.xhrGuids&&!this.xhrGuids[e]&&(this.xhrGuids[e]=!0,this.totalCbs+=1)}),f.on("xhr-load-removed",function(t,n){var e=""+l(t)+!!n;this.xhrGuids&&this.xhrGuids[e]&&(delete this.xhrGuids[e],this.totalCbs-=1)}),f.on("addEventListener-end",function(t,n){n instanceof m&&"load"===t[0]&&f.emit("xhr-load-added",[t[1],t[2]],n)}),f.on("removeEventListener-end",function(t,n){n instanceof m&&"load"===t[0]&&f.emit("xhr-load-removed",[t[1],t[2]],n)}),f.on("fn-start",function(t,n,e){n instanceof m&&("onload"===e&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=a.now()))}),f.on("fn-end",function(t,n){this.xhrCbStart&&f.emit("xhr-cb-time",[a.now()-this.xhrCbStart,this.onload,n],n)})}},{}],11:[function(t,n,e){n.exports=function(t){var n=document.createElement("a"),e=window.location,r={};n.href=t,r.port=n.port;var o=n.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=n.hostname||e.hostname,r.pathname=n.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!n.protocol||":"===n.protocol||n.protocol===e.protocol,a=n.hostname===document.domain&&n.port===e.port;return r.sameOrigin=i&&(!n.hostname||a),r}},{}],12:[function(t,n,e){function r(){}function o(t,n,e){return function(){return i(t,[f.now()].concat(s(arguments)),n?null:this,e),n?void 0:this}}var i=t("handle"),a=t(15),s=t(16),c=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",p=l+"ixn-";a(d,function(t,n){u[n]=o(l+n,!0,"api")}),u.addPageAction=o(l+"addPageAction",!0),u.setCurrentRouteName=o(l+"routeName",!0),n.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,n){var e={},r=this,o="function"==typeof n;return i(p+"tracer",[f.now(),t,e],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],e),o)try{return n.apply(this,arguments)}finally{c.emit("fn-end",[f.now()],e)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,n){h[n]=o(p+n)}),newrelic.noticeError=function(t){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now()])}},{}],13:[function(t,n,e){n.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(n){return}}}},{}],14:[function(t,n,e){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),n.exports=r},{}],15:[function(t,n,e){function r(t,n){var e=[],r="",i=0;for(r in t)o.call(t,r)&&(e[i]=n(r,t[r]),i+=1);return e}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],16:[function(t,n,e){function r(t,n,e){n||(n=0),"undefined"==typeof e&&(e=t?t.length:0);for(var r=-1,o=e-n||0,i=Array(o<0?0:o);++r<o;)i[r]=t[n+r];return i}n.exports=r},{}],17:[function(t,n,e){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],18:[function(t,n,e){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(16),a="nr@original",s=Object.prototype.hasOwnProperty,c=!1;n.exports=function(t,n){function e(t,n,e,o){function nrWrapper(){var r,a,s,c;try{a=this,r=i(arguments),s="function"==typeof e?e(r,a):e||{}}catch(f){l([f,"",[r,a,o],s])}u(n+"start",[r,a,o],s);try{return c=t.apply(a,r)}catch(d){throw u(n+"err",[r,a,d],s),d}finally{u(n+"end",[r,a,c],s)}}return r(t)?t:(n||(n=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,n,o,i){o||(o="");var a,s,c,f="-"===o.charAt(0);for(c=0;c<n.length;c++)s=n[c],a=t[s],r(a)||(t[s]=e(a,f?s+o:o,i,s))}function u(e,r,o){if(!c||n){var i=c;c=!0;try{t.emit(e,r,o,n)}catch(a){l([a,e,r,o])}c=i}}function d(t,n){if(Object.defineProperty&&Object.keys)try{var e=Object.keys(t);return e.forEach(function(e){Object.defineProperty(n,e,{get:function(){return t[e]},set:function(n){return t[e]=n,n}})}),n}catch(r){l([r])}for(var o in t)s.call(t,o)&&(n[o]=t[o]);return n}function l(n){try{t.emit("internal-error",n)}catch(e){}}return t||(t=o),e.inPlace=f,e.flag=a,e}},{}],ee:[function(t,n,e){function r(){}function o(t){function n(t){return t&&t instanceof r?t:t?c(t,s,i):i()}function e(e,r,o,i){if(!l.aborted||i){t&&t(e,r,o);for(var a=n(o),s=h(e),c=s.length,f=0;f<c;f++)s[f].apply(a,r);var d=u[y[e]];return d&&d.push([g,e,r,a]),a}}function p(t,n){v[t]=h(t).concat(n)}function h(t){return v[t]||[]}function m(t){return d[t]=d[t]||o(e)}function w(t,n){f(t,function(t,e){n=n||"feature",y[e]=n,n in u||(u[n]=[])})}var v={},y={},g={on:p,emit:e,get:m,listeners:h,context:n,buffer:w,abort:a,aborted:!1};return g}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var s="nr@context",c=t("gos"),f=t(15),u={},d={},l=n.exports=o();l.backlog=u},{}],gos:[function(t,n,e){function r(t,n,e){if(o.call(t,n))return t[n];var r=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(t,n,e){function r(t,n,e,r){o.buffer([t],r),o.emit(t,n,e)}var o=t("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(t,n,e){function r(t){var n=typeof t;return!t||"object"!==n&&"function"!==n?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");n.exports=r},{}],loader:[function(t,n,e){function r(){if(!x++){var t=b.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&n))return u.abort();f(y,function(n,e){t[n]||(t[n]=e)}),c("mark",["onload",a()+b.offset],null,"api");var e=l.createElement("script");e.src="https://"+t.agent,n.parentNode.insertBefore(e,n)}}function o(){"complete"===l.readyState&&i()}function i(){c("mark",["domContent",a()+b.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(s=Math.max((new Date).getTime(),s))-b.offset}var s=(new Date).getTime(),c=t("handle"),f=t(15),u=t("ee"),d=window,l=d.document,p="addEventListener",h="attachEvent",m=d.XMLHttpRequest,w=m&&m.prototype;NREUM.o={ST:setTimeout,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1026.min.js"},g=m&&w&&w[p]&&!/CriOS/.test(navigator.userAgent),b=n.exports={offset:s,now:a,origin:v,features:{},xhrWrappable:g};t(12),l[p]?(l[p]("DOMContentLoaded",i,!1),d[p]("load",r,!1)):(l[h]("onreadystatechange",o),d[h]("onload",r)),c("mark",["firstbyte",s],null,"api");var x=0,E=t(17)},{}]},{},["loader",2,10,4,3]);</script>
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<meta content="en" name="Content-Language">
<link rel="apple-touch-icon-precomposed" type="image/png" href="https://leanpub.com/assets/favicons/apple-touch-icon-57x57-54e70e6f82df9577817a780b29ecda35.png" sizes="57x57">
<link rel="apple-touch-icon-precomposed" type="image/png" href="https://leanpub.com/assets/favicons/apple-touch-icon-60x60-8f5ad55401b40beee4e5b2016bb63488.png" sizes="60x60">
<link rel="apple-touch-icon-precomposed" type="image/png" href="https://leanpub.com/assets/favicons/apple-touch-icon-72x72-bb004576b18d715f0bd5530797d34dc9.png" sizes="72x72">
<link rel="apple-touch-icon-precomposed" type="image/png" href="https://leanpub.com/assets/favicons/apple-touch-icon-76x76-5942e60fbe5e079c53e84c562eca25d0.png" sizes="76x76">
<link rel="apple-touch-icon-precomposed" type="image/png" href="https://leanpub.com/assets/favicons/apple-touch-icon-114x114-c6e42dbd40e626f342e59d3243f91c6e.png" sizes="114x114">
<link rel="apple-touch-icon-precomposed" type="image/png" href="https://leanpub.com/assets/favicons/apple-touch-icon-120x120-fd7f057745561ad60ae84af57089e95a.png" sizes="120x120">
<link rel="apple-touch-icon-precomposed" type="image/png" href="https://leanpub.com/assets/favicons/apple-touch-icon-144x144-797b56b87c3d9081a7ae917d92c8c04c.png" sizes="144x144">
<link rel="apple-touch-icon-precomposed" type="image/png" href="https://leanpub.com/assets/favicons/apple-touch-icon-152x152-8f1e2e8883a11b5ff20d9f0c05806178.png" sizes="152x152">
<link rel="icon" type="image/png" href="https://leanpub.com/assets/favicons/favicon-16x16-ded2bd99e406de33cbbc8ce1cdee589d.png" sizes="16x16">
<link rel="icon" type="image/png" href="https://leanpub.com/assets/favicons/favicon-32x32-092b00041f106e3ea1fcd813cc580be2.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://leanpub.com/assets/favicons/favicon-96x96-dbe8af7287bfae633eecb6431987707b.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://leanpub.com/assets/favicons/favicon-128x128-ad240b25d25c4c469a99d2b2b0660b01.png" sizes="128x128">
<link rel="icon" type="image/png" href="https://leanpub.com/assets/favicons/favicon-196x196-7d3a43fbe85f899fa7648b0844251883.png" sizes="196x196">
<meta content="Leanpub" name="application-name">
<meta content="#ffffff" name="msapplication-TileColor">
<meta content="favicons/mstile-144x144.png" name="msapplication-TileImage">
<meta content="favicons/mstile-150x150.png" name="msapplication-square150x150logo">
<meta content="favicons/mstile-310x150.png" name="msapplication-wide310x150logo">
<meta content="favicons/mstile-310x310.png" name="msapplication-square310x310logo">
<meta content="favicons/mstile-70x70.png" name="msapplication-square70x70logo">

<title>Read Essential TypeScript | Leanpub</title>
<link href="https://fonts.googleapis.com/" rel="dns-prefetch">
<script src="./Read Essential TypeScript _ Leanpub_files/7d43d23755.js.download"></script><link rel="stylesheet" href="./Read Essential TypeScript _ Leanpub_files/7d43d23755.css" media="all">
<script src="./Read Essential TypeScript _ Leanpub_files/webfont.js.download"></script>
<link rel="stylesheet" href="./Read Essential TypeScript _ Leanpub_files/css" media="all"><script>
  if (typeof WebFont !== 'undefined') {
    WebFont.load({
      google: {
        families: [
          'Noto Sans:400,700,400i,700i',
          'Noto Serif:400,700,400i,700i',
        ]
      }
    });
  }
</script>

<link rel="stylesheet" media="all" href="./Read Essential TypeScript _ Leanpub_files/application-27f6c535bc36f0b6de7e2babdc4f08b8.css">

<script>
  var _rollbarConfig = {
      accessToken: "3d279f41d3804636adbbba833c2c0d2d",
      captureUncaught: true,
      payload: {
        environment: "production"
      }
  };
  !function(r){function o(e){if(t[e])return t[e].exports;var n=t[e]={exports:{},id:e,loaded:!1};return r[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}var t={};return o.m=r,o.c=t,o.p="",o(0)}([function(r,o,t){"use strict";var e=t(1).Rollbar,n=t(2);_rollbarConfig.rollbarJsUrl=_rollbarConfig.rollbarJsUrl||"https://d37gvrvc0wt4s1.cloudfront.net/js/v1.8/rollbar.min.js";var a=e.init(window,_rollbarConfig),i=n(a,_rollbarConfig);a.loadFull(window,document,!_rollbarConfig.async,_rollbarConfig,i)},function(r,o){"use strict";function t(r){return function(){try{return r.apply(this,arguments)}catch(o){try{console.error("[Rollbar]: Internal error",o)}catch(t){}}}}function e(r,o,t){window._rollbarWrappedError&&(t[4]||(t[4]=window._rollbarWrappedError),t[5]||(t[5]=window._rollbarWrappedError._rollbarContext),window._rollbarWrappedError=null),r.uncaughtError.apply(r,t),o&&o.apply(window,t)}function n(r){var o=function(){var o=Array.prototype.slice.call(arguments,0);e(r,r._rollbarOldOnError,o)};return o.belongsToShim=!0,o}function a(r){this.shimId=++s,this.notifier=null,this.parentShim=r,this._rollbarOldOnError=null}function i(r){var o=a;return t(function(){if(this.notifier)return this.notifier[r].apply(this.notifier,arguments);var t=this,e="scope"===r;e&&(t=new o(this));var n=Array.prototype.slice.call(arguments,0),a={shim:t,method:r,args:n,ts:new Date};return window._rollbarShimQueue.push(a),e?t:void 0})}function l(r,o){if(o.hasOwnProperty&&o.hasOwnProperty("addEventListener")){var t=o.addEventListener;o.addEventListener=function(o,e,n){t.call(this,o,r.wrap(e),n)};var e=o.removeEventListener;o.removeEventListener=function(r,o,t){e.call(this,r,o&&o._wrapped?o._wrapped:o,t)}}}var s=0;a.init=function(r,o){var e=o.globalAlias||"Rollbar";if("object"==typeof r[e])return r[e];r._rollbarShimQueue=[],r._rollbarWrappedError=null,o=o||{};var i=new a;return t(function(){if(i.configure(o),o.captureUncaught){i._rollbarOldOnError=r.onerror,r.onerror=n(i);var t,a,s="EventTarget,Window,Node,ApplicationCache,AudioTrackList,ChannelMergerNode,CryptoOperation,EventSource,FileReader,HTMLUnknownElement,IDBDatabase,IDBRequest,IDBTransaction,KeyOperation,MediaController,MessagePort,ModalWindow,Notification,SVGElementInstance,Screen,TextTrack,TextTrackCue,TextTrackList,WebSocket,WebSocketWorker,Worker,XMLHttpRequest,XMLHttpRequestEventTarget,XMLHttpRequestUpload".split(",");for(t=0;t<s.length;++t)a=s[t],r[a]&&r[a].prototype&&l(i,r[a].prototype)}return r[e]=i,i})()},a.prototype.loadFull=function(r,o,e,n,a){var i=function(){var o;if(void 0===r._rollbarPayloadQueue){var t,e,n,i;for(o=new Error("rollbar.js did not load");t=r._rollbarShimQueue.shift();)for(n=t.args,i=0;i<n.length;++i)if(e=n[i],"function"==typeof e){e(o);break}}"function"==typeof a&&a(o)},l=!1,s=o.createElement("script"),u=o.getElementsByTagName("script")[0],p=u.parentNode;s.crossOrigin="",s.src=n.rollbarJsUrl,s.async=!e,s.onload=s.onreadystatechange=t(function(){if(!(l||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)){s.onload=s.onreadystatechange=null;try{p.removeChild(s)}catch(r){}l=!0,i()}}),p.insertBefore(s,u)},a.prototype.wrap=function(r,o){try{var t;if(t="function"==typeof o?o:function(){return o||{}},"function"!=typeof r)return r;if(r._isWrap)return r;if(!r._wrapped){r._wrapped=function(){try{return r.apply(this,arguments)}catch(o){throw o._rollbarContext=t()||{},o._rollbarContext._wrappedSource=r.toString(),window._rollbarWrappedError=o,o}},r._wrapped._isWrap=!0;for(var e in r)r.hasOwnProperty(e)&&(r._wrapped[e]=r[e])}return r._wrapped}catch(n){return r}};for(var u="log,debug,info,warn,warning,error,critical,global,configure,scope,uncaughtError".split(","),p=0;p<u.length;++p)a.prototype[u[p]]=i(u[p]);r.exports={Rollbar:a,_rollbarWindowOnError:e}},function(r,o){"use strict";r.exports=function(r,o){return function(t){if(!t&&!window._rollbarInitialized){var e=window.RollbarNotifier,n=o||{},a=n.globalAlias||"Rollbar",i=window.Rollbar.init(n,r);i._processShimQueue(window._rollbarShimQueue||[]),window[a]=i,window._rollbarInitialized=!0,e.processPayloads()}}}}]);
</script>
<script src="./Read Essential TypeScript _ Leanpub_files/modernizr-475cd16be463e65bd308a1d6bc41b7a9.js.download"></script>
<script src="./Read Essential TypeScript _ Leanpub_files/jsapi"></script>
<script src="./Read Essential TypeScript _ Leanpub_files/chartkick-4ed46cbe2a0c6f2912796965f156256d.js.download"></script>
<script src="./Read Essential TypeScript _ Leanpub_files/MathJax.js.download" type="text/javascript"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
  ga('create', 'UA-911230-9', 'auto');  // Replace with your property ID.
  
  // Visitor type parameters (only settable from non cached)
  
  
  
  
  ga('send', 'pageview');
</script>

<style></style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><meta name="csrf-param" content="authenticity_token"><meta name="csrf-token" content="8TE1KSPq+4TPg7hROEtKUTBMWdB0KtzPY0PbnUmoFcSiplPIeJRJRVetv5jxj7RAGEtD0hfwijpVbMkUEGOgNQ=="><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.1') format('woff'), url('https://leanpub.com/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body id="reads-show"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<div class="flash" id="js-flash-prototype">
<div class="flash__progress-bar"></div>
<div class="container--large">
<div class="flash__message"></div>
<div class="flash__close-icon">

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="25px" id="Layer_1" style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="25px" xml:space="preserve"><path d="M437.5,386.6L306.9,256l130.6-130.6c14.1-14.1,14.1-36.8,0-50.9c-14.1-14.1-36.8-14.1-50.9,0L256,205.1L125.4,74.5  c-14.1-14.1-36.8-14.1-50.9,0c-14.1,14.1-14.1,36.8,0,50.9L205.1,256L74.5,386.6c-14.1,14.1-14.1,36.8,0,50.9  c14.1,14.1,36.8,14.1,50.9,0L256,306.9l130.6,130.6c14.1,14.1,36.8,14.1,50.9,0C451.5,423.4,451.5,400.6,437.5,386.6z"></path></svg>

</div>
</div>
</div>


<header class="header">
<div class="container--large">
<div class="header__section--left">
<a class="header__mobile-menu-icon">
<i class="fa fa-bars" aria-hidden="true"></i>
</a>
<div class="mobile-menu">
<header class="mobile-menu__header">
<div class="btn--close">

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="25px" id="Layer_1" style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="25px" xml:space="preserve"><path d="M437.5,386.6L306.9,256l130.6-130.6c14.1-14.1,14.1-36.8,0-50.9c-14.1-14.1-36.8-14.1-50.9,0L256,205.1L125.4,74.5  c-14.1-14.1-36.8-14.1-50.9,0c-14.1,14.1-14.1,36.8,0,50.9L205.1,256L74.5,386.6c-14.1,14.1-14.1,36.8,0,50.9  c14.1,14.1,36.8,14.1,50.9,0L256,306.9l130.6,130.6c14.1,14.1,36.8,14.1,50.9,0C451.5,423.4,451.5,400.6,437.5,386.6z"></path></svg>

</div>
<div class="mobile-menu__header__logo">
<a href="https://leanpub.com/"><!-- Generator: Adobe Illustrator 19.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="128px" height="87.407px" viewBox="0 0 128 87.407" style="enable-background:new 0 0 128 87.407;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#231F20;}
	.st1{fill:#FFFFFF;}
</style>
<path class="st0" d="M118.343,7.884C114.047,5.467,102.725,0,88.202,0C75.161,0,67.739,4.009,64,6.583  C60.261,4.009,52.839,0,39.798,0C25.275,0,13.953,5.467,9.657,7.884L0,87.407h0.288c5.46,0,10.834-1.259,15.772-3.589  c5.504-2.597,14.182-5.652,24.545-5.652c12.606,0,19.781,5.627,23.395,9.241c3.614-3.614,10.789-9.241,23.395-9.241  c10.363,0,19.041,3.055,24.545,5.652c4.938,2.33,10.313,3.589,15.772,3.589H128L118.343,7.884z"></path>
<path class="st1" d="M111.652,74.536c-5.112-2.103-10.271-3.541-15.332-4.274c-2.974-0.431-5.977-0.649-8.925-0.649  c-8.383,0-15.957,2.09-22.512,6.213L64,76.374l-0.878-0.546c-6.56-4.125-14.134-6.215-22.517-6.215  c-2.948,0-5.951,0.219-8.925,0.649c-5.062,0.733-10.221,2.171-15.333,4.274L9.85,77.209l7.752-63.796l0.574-0.254  c6.535-2.888,14.92-4.612,22.429-4.612c9.302,0,17.167,2.962,23.395,8.808c6.228-5.846,14.092-8.808,23.395-8.808  c7.51,0,15.895,1.724,22.43,4.612l0.574,0.254l7.752,63.796L111.652,74.536z"></path>
<path class="st0" d="M88.824,66.095c-0.797-0.031-1.591-0.047-2.382-0.047c-8.366,0-15.95,2.028-22.542,6.025  c-6.595-3.998-14.177-6.025-22.542-6.025c-2.942,0-5.938,0.214-8.904,0.636c-5.05,0.718-10.191,2.124-15.278,4.179l-2.902,1.172  l6.885-55.627c5.955-2.479,13.455-3.95,20.199-3.95c8.757,0,16.088,2.838,21.789,8.436l0.752,0.739l0.752-0.739  c5.493-5.393,12.502-8.217,20.838-8.417L88.824,66.095z"></path>
</svg>

</a></div>
<div class="mobile-menu__cart">
<a class="shopping-cart__icon" href="https://leanpub.com/shopping_cart?stage=review" title="Shopping Cart">
<div class="icon-link--cart empty"><span class="shopping-cart__count">0</span></div>
</a>
</div>
</header>
<div class="mobile-menu__search">
<div class="search" role="search">
<form action="https://leanpub.com/bookstore" class="search__form" method="get">
<label class="search__label" for="search-query">Search Query</label>
<input class="search__input" id="search-query" name="search" placeholder="Search Leanpub" type="text">
<button class="search__button" type="submit">
<i class="fa fa-search" aria-hidden="true"></i>
</button>
</form>
</div>

</div>
<nav class="mobile-menu__nav">
<ul><li><a href="https://leanpub.com/">Home</a></li><li><a href="https://leanpub.com/bookstore">Store</a></li><li><a href="https://leanpub.com/user_dashboard/library">Read</a></li><li><a href="https://leanpub.com/author_dashboard/books">Write</a></li><li><a href="https://leanpub.com/help">Support</a></li></ul>
</nav>
<div class="mobile-menu__session-links hidden" style="display: flex;">
<a href="https://leanpub.com/sign_in">Sign In</a>
<a href="https://leanpub.com/sign_up">Sign Up</a>
</div>
</div>

</div>
<div class="header__section--center">
<div class="header__logo--black">
<a href="https://leanpub.com/"><!-- Generator: Adobe Illustrator 19.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="128px" height="87.407px" viewBox="0 0 128 87.407" style="enable-background:new 0 0 128 87.407;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#231F20;}
	.st1{fill:#FFFFFF;}
</style>
<path class="st0" d="M118.343,7.884C114.047,5.467,102.725,0,88.202,0C75.161,0,67.739,4.009,64,6.583  C60.261,4.009,52.839,0,39.798,0C25.275,0,13.953,5.467,9.657,7.884L0,87.407h0.288c5.46,0,10.834-1.259,15.772-3.589  c5.504-2.597,14.182-5.652,24.545-5.652c12.606,0,19.781,5.627,23.395,9.241c3.614-3.614,10.789-9.241,23.395-9.241  c10.363,0,19.041,3.055,24.545,5.652c4.938,2.33,10.313,3.589,15.772,3.589H128L118.343,7.884z"></path>
<path class="st1" d="M111.652,74.536c-5.112-2.103-10.271-3.541-15.332-4.274c-2.974-0.431-5.977-0.649-8.925-0.649  c-8.383,0-15.957,2.09-22.512,6.213L64,76.374l-0.878-0.546c-6.56-4.125-14.134-6.215-22.517-6.215  c-2.948,0-5.951,0.219-8.925,0.649c-5.062,0.733-10.221,2.171-15.333,4.274L9.85,77.209l7.752-63.796l0.574-0.254  c6.535-2.888,14.92-4.612,22.429-4.612c9.302,0,17.167,2.962,23.395,8.808c6.228-5.846,14.092-8.808,23.395-8.808  c7.51,0,15.895,1.724,22.43,4.612l0.574,0.254l7.752,63.796L111.652,74.536z"></path>
<path class="st0" d="M88.824,66.095c-0.797-0.031-1.591-0.047-2.382-0.047c-8.366,0-15.95,2.028-22.542,6.025  c-6.595-3.998-14.177-6.025-22.542-6.025c-2.942,0-5.938,0.214-8.904,0.636c-5.05,0.718-10.191,2.124-15.278,4.179l-2.902,1.172  l6.885-55.627c5.955-2.479,13.455-3.95,20.199-3.95c8.757,0,16.088,2.838,21.789,8.436l0.752,0.739l0.752-0.739  c5.493-5.393,12.502-8.217,20.838-8.417L88.824,66.095z"></path>
</svg>

</a></div>
<nav class="header__nav">
<ul class="header__nav-list">
<li class="header__nav-item">
<a href="https://leanpub.com/bookstore">Store</a>
</li>
<li class="header__nav-item">
<a href="https://leanpub.com/user_dashboard/library">Read</a>
</li>
<li class="header__nav-item">
<a href="https://leanpub.com/author_dashboard/books">Write</a>
</li>
<li class="header__nav-item">
<a href="https://leanpub.com/help">Support</a>
</li>
<li class="header__nav-item">
<a href="https://medium.com/@leanpub">Blog</a>
</li>
</ul>
</nav>
</div>
<div class="header__section--right">
<div class="header__search">
<div class="search" role="search">
<form action="https://leanpub.com/bookstore" class="search__form" method="get">
<label class="search__label" for="search-query">Search Query</label>
<input class="search__input" id="search-query" name="search" placeholder="Search Leanpub" type="text">
<button class="search__button" type="submit">
<i class="fa fa-search" aria-hidden="true"></i>
</button>
</form>
</div>

</div>
<div class="header__cart">
<a class="shopping-cart__icon" href="https://leanpub.com/shopping_cart?stage=review" title="Shopping Cart">
<div class="icon-link--cart empty"><span class="shopping-cart__count">0</span></div>
</a>
</div>
<div class="header__session-buttons">
<a href="https://leanpub.com/sign_in"><button class="btn--plain--shark" type="button">Sign In</button>
</a><a href="https://leanpub.com/sign_up"><button class="btn--solid--shark" type="button">Sign Up</button>
</a></div>
<div class="header__account-container">
<div class="account-menu" id="js-account-dropdown">
<ul class="account-menu__list-wrapper">
<li class="account-menu__nav--user">
<div class="user" style="display: none;">
<h5>Account</h5>
<a class="user" href="https://leanpub.com/user_dashboard/library" style="display: none;">Library</a>
<hr>
</div>
<a class="guest" href="https://leanpub.com/sign_in" style="display: block;">Sign In</a>
<a class="guest" href="https://leanpub.com/sign_up" style="display: block;">Sign Up</a>
<a class="user" href="https://leanpub.com/user_dashboard/settings" style="display: none;">Settings</a>
<a class="user" href="https://leanpub.com/user_dashboard/purchases" style="display: none;">Purchases</a>
<a class="user" href="https://leanpub.com/user_dashboard/gifts" style="display: none;">Gifts</a>
<a class="user" href="https://leanpub.com/user_dashboard/refunds" style="display: none;">Refunds</a>
<a class="author" href="https://leanpub.com/user_dashboard/invitations" style="display: none;">Invitations</a>
<a class="user" href="https://leanpub.com/user_dashboard/kindle" style="display: none;">Kindle</a>
<a class="user" href="https://leanpub.com/user_dashboard/email" style="display: none;">Email</a>
</li>
<li class="author-and-publisher">
<div class="account-menu__nav--author" style="display: none;">
<h5>Author</h5>
<a class="reader" href="https://leanpub.com/books/new" style="display: none;">Create a book</a>
<a class="author" href="https://leanpub.com/author_dashboard/books" style="display: none;">Books</a>
<a class="author" href="https://leanpub.com/author_dashboard/bundles" style="display: none;">Bundles</a>
<a class="author course" href="https://leanpub.com/author_dashboard/courses" style="display: none;">Courses</a>
<a class="author" href="https://leanpub.com/author_dashboard/profile" style="display: none;">Profile</a>
<a class="author" href="https://leanpub.com/author_dashboard/royalties" style="display: none;">Royalties</a>
<a class="author" href="https://leanpub.com/author_dashboard/settings" style="display: none;">API</a>
</div>
<div class="account-menu__nav--publisher" style="display: none;">
<h5>Publisher</h5>
<a class="publisher" href="https://leanpub.com/publisher_dashboard/publishers" style="display: none;">Dashboard</a>
</div>
</li>
<li class="author account-menu__nav--books" style="display: none;">
<h5>Edit Books</h5>
</li>
</ul>
<div class="account-menu__actions">
<div class="account-menu__action">
<a href="https://leanpub.com/help">Help</a>
</div>
<div class="account-menu__action">
<span class="account-menu__email"></span>
<a href="https://leanpub.com/sign_out" style="display: none;">Sign Out</a>
</div>
</div>
</div>

<div class="header__account-button"><img class="header__account-avatar" src="./Read Essential TypeScript _ Leanpub_files/missing_avatar.jpg" alt="Avatar">

</div>
</div>
</div>
</div>
</header>


<div class="main">


<div class="container--large" id="read-online" lang="en">
<header>
<h1>Essential TypeScript</h1>
<div class="read-upsell">
<a href="https://leanpub.com/essentialtypescript"><img alt="Essential TypeScript" src="./Read Essential TypeScript _ Leanpub_files/small"></a>
<div>
<div class="book-title">Essential TypeScript</div>
<a class="btn--solid" href="https://leanpub.com/essentialtypescript">Buy on Leanpub</a>
</div>
</div>
</header>
<section class="read">
<div id="leanpub-toc">
<h2>Table of Contents</h2>
<ol class="toc">
<ul class="toc no-parts">
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#preface"><span class="section-number">1. </span>Preface</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#what-you-should-know">What You Should Know</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#source-code-examples">Source Code Examples</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#contributions">Errors, Omissions, and Contributions</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#introduction"><span class="section-number">2. </span>Introduction</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#what-is-typescript">What is TypeScript?</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#what-is-javascript">Defining “JavaScript”</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#first-typescript-function">Writing your first TypeScript function</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#getting-started"><span class="section-number">3. </span>Getting Started</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#choosing-your-editor">Choosing your TypeScript editor</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#visual-studio-installation">Installing TypeScript in Visual Studio</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#npm-installation">Installing the TypeScript Command Line Interface</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#configuration">Configuring the TypeScript compiler</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#ecmascript-features"><span class="section-number">4. </span>ECMAScript 2015 Features</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#optional-parameters">Optional Parameters</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#template-strings">Template Strings</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#let-and-const">Let and const</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-forof-loops">For..of Loops</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#arrow-functions">Arrow Functions</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#destructuring">Destructuring</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#spread-operator">The Spread Operator</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-computed-properties">Computed Properties</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#type-fundamentals"><span class="section-number">5. </span>Type Fundamentals</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-introducing-javascript-types">Introducing JavaScript Types</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-understanding-type-inference">Understanding Type Inference</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-specifying-javascript-types">Specifying JavaScript Types</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-union-types">Union Types</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-function-overloads">Function Overloads</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-custom-types"><span class="section-number">6. </span>Custom Types</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-defining-custom-types-with-interfaces">Defining custom types with Interfaces</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-using-interfaces-to-describe-functions">Using interfaces to describe functions</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-extending-interface-definitions">Extending interface definitions</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-defining-constant-values-with-enums">Defining constant values with enums</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-anonymous-types">Anonymous Types</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-using-interfaces-to-dynamically-access-object-properties">Using interfaces to dynamically access object properties</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-classes"><span class="section-number">7. </span>Classes</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-understanding-prototypical-inheritance">Understanding Prototypical Inheritance</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-defining-a-class">Defining a class</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-applying-static-properties">Applying static properties</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-making-properties-smarter-with-accessors">Making properties smarter with accessors</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-inheriting-behavior-from-a-base-class">Inheriting behavior from a base class</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#abstract-class">Implementing an abstract class</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#access-modifiers">Controlling visibility with access modifiers</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#implementing-interfaces">Implementing interfaces</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-generics"><span class="section-number">8. </span>Generics</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-creating-generic-functions">Creating generic functions</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-creating-generic-classes">Creating generic classes</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-creating-generic-constraints">Creating generic constraints</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-modules"><span class="section-number">9. </span>Modules</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-organizing-your-code-with-namespaces">Organizing Your Code with Namespaces</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-using-namespaces-to-encapsulate-private-members">Using namespaces to encapsulate private members</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-understanding-the-difference-between-internal-and-external-modules">Understanding the difference between Internal and External Modules</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-switching-from-internal-to-external-modules">Switching from internal to external modules</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-importing-modules-using-require-syntax">Importing modules using Require syntax</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-importing-modules-using-ecmascript-2015-syntax">Importing modules using ECMAScript 2015 syntax</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-loading-external-modules">Loading External Modules</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-real-world-application-development"><span class="section-number">10. </span>Real-World Application Development</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-converting-existing-javascript-code-to-typescript">Converting existing JavaScript code to TypeScript</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-generating-declaration-files">Generating Declaration Files</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-referencing-third-party-libraries">Referencing third-party libraries</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-converting-to-external-modules">Converting to External Modules</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-debugging-typescript-with-source-maps">Debugging TypeScript with source maps</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#decorators"><span class="section-number">11. </span>Decorators</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#class-decorators">Implementing Class Decorators</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#property-decorators">Implementing Property Decorators</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-implementing-decorator-factories">Implementing Decorator Factories</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-appendix-syntax-examples"><span class="section-number">12. </span>Appendix: Syntax Examples</a>
    <ul>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-ecmascript-6-features">ECMAScript 6 Features</a>
      </li>
      <li>
        <a href="https://leanpub.com/essentialtypescript/read#leanpub-auto-custom-types-1">Custom Types</a>
      </li>
    </ul>
  </li>
</ul>

</ol>
</div>
<div id="leanpub-main">
<h2 id="preface">
<span class="section-number">1. </span>Preface</h2>

<p>Put simply, TypeScript is a superset of JavaScript, which means that it builds on top of JavaScript’s mature foundations, adding a variety of helpful syntax and tooling onto the language.  It brings the power and productivity of static typing and object-oriented development techniques to the core JavaScript language.  In fact, TypeScript is designed to be compiled into fully-compatible JavaScript.</p>

<p>And, as JavaScript’s reach continues to expand, so do the opportunities to leverage TypeScript to create JavaScript-based applications.</p>

<p>In this book, I will show you everything you need to know in order to create full-fledged JavaScript applications using the TypeScript programming language, starting by revisiting some JavaScript fundamentals and proceeding all the way to demonstrating how to convert an entire existing JavaScript codebase to take full advantage of what TypeScript has to offer.</p>

<p>One of the nicest things about TypeScript is that its tooling is fully cross-platform, which means that you can develop TypeScript applications using Windows, Mac, or even Linux.  Microsoft even offers an online editor to play around with in order to get your feet wet without having to install anything at all!</p>

<h3 id="what-you-should-know">What You Should Know</h3>

<p>Before getting into the content of the book, I want to take a minute to set some expectations - especially when it comes to what you should already know in order to get the most out of this book.</p>

<p>As I mentioned previously, TypeScript is a superset of JavaScript, which means that it is an extension of JavaScript, adding new features and syntax on top of the core language.  </p>

<p>In this book, I’m going to focus the unique features that TypeScript adds to the language rather than explaining the fundamentals of JavaScript itself and I’ll be depending on the assumption that you’ve already got a decent familiarity with the JavaScript language to the point where you should be able to pretty easily recognize where JavaScript ends and TypeScript begins.</p>

<p>In other words, if you’re comfortable using JavaScript to enhance a website to make an AJAX call and update parts of the webpage when the user clicks a button, for example - even if you prefer to use a library like jQuery to help you - you’ll probably be able to follow along with this book just fine.</p>

<p>If, however, you’re relatively new to JavaScript development or don’t have much experience with the language, I strongly suggest you spend some time to learn JavaScript itself first, then come back to this book to see how TypeScript can make your JavaScript experience even more productive.</p>

<h3 id="source-code-examples">Source Code Examples</h3>

<p>Since this is a book about software development, it’s going to have a lot of code.  While I expect you to follow along by running the same code on your local machine, I don’t necessarily expect you to have to copy and paste every character that I show.  And, I don’t know about you, but whenever I am having trouble running some sample code that I’m writing along with a book or training course, I always like to have a full, working version of that code that I can refer to in order to help me figure out what I need to change in order to get my version of the code running.</p>

<p>So, to make that possible, I’ve captured a snapshot of the code I show you at the end of every section and it is available to you through my GitHub repository at: <a href="https://github.com/jchadwick/EssentialTypeScript">github.com/jchadwick/EssentialTypeScript</a>.</p>

<p>You can either browse the repository on the GitHub website or make a local clone of the repository and start looking through it!
Note that this repository also contains snapshots at the end of each section, each one represented as a Tag in the repository.  That means that if you want to see the code for a specific section, you can switch to that tag in your local repository or select that section from the dropdown on the GitHub site. On the GitHub site, this will change the context of the whole source code tree and you can then use the website to browse through the code as it stands at the end of that section. Also note that you can download a zip archive of any tag as well by visiting the Releases tab and clicking on the “zip” link for the tag that you’d like to download.</p>

<p>The full source code is there if you need it – I encourage you to refer to it as much and as often as you need to in order to get the most out of this book!</p>

<h3 id="contributions">Errors, Omissions, and Contributions</h3>

<p>Oh, and guess what else is on GitHub – <em>this very book!</em>  That’s right - if you head on over to <a href="https://github.com/jchadwick/EssentialTypeScriptBook">github.com/jchadwick/EssentialTypeScriptBook</a> you’ll find the repository with this full text.  From there you’re welcome to submit Issues or even fork the whole thing, make your own changes, and submit a pull request!</p>

<h2 id="introduction">
<span class="section-number">2. </span>Introduction</h2>

<h3 id="what-is-typescript">What is TypeScript?</h3>

<p>In this book, I’m going to show you everything you need to know in order to write applications using TypeScript.  In this section, I’m going to start with the basics and explain what, exactly, TypeScript is.</p>

<p>Put simply, TypeScript is a superset of the JavaScript programming language that adds the concept of static typing to the core features of JavaScript.  </p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----superset.png" alt="Superset of JavaScript">
  <figcaption>Superset of JavaScript</figcaption>
</figure>


<p>This is a big deal because JavaScript is - and always has been - a dynamic language.</p>

<p>In order to illustrate why this is a big deal, I’ll quickly define what it means to be a static language or a dynamic language and how they seem, at first, to be completely opposite and incompatible things.  </p>

<table>
  <thead>
    <tr>
      <th>Dynamic Types</th>
      <th>Static Types</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Type System</td>
      <td>Type System</td>
    </tr>
    <tr>
      <td>Forgiving</td>
      <td>Rigid</td>
    </tr>
    <tr>
      <td>Great for web browser object model</td>
      <td>Promotes stability and maintainability</td>
    </tr>
  </tbody>

</table>

<p>Both dynamic and static languages rely on a type system - that is, definitions of data structures and their behaviors - to ensure that programs are correct.  It’s just that the two kinds of languages validate those types in different ways.</p>

<p>Dynamic languages aim to be much more forgiving at development time, relying on the concept of “duck typing” to validate that a particular object can be used in a certain way.  </p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----duck-typing.jpg" alt="Duck typing">
  <figcaption>Duck typing</figcaption>
</figure>


<p>“Duck typing” refers to the idea that if it looks like a duck, walks like a duck, and quacks like a duck, it must be a duck…  In other words, if my code expects an object that has a method called “quack” on it, and I get an object that has a method named “quack”, well that’s good enough for me – I don’t need to validate anything else about that object.  The net result of this approach is that tools don’t have enough information to catch errors before the application runs, for example, if I’ve accidentally typed the method name “quake” rather than “quack”.</p>


<figure class="image floatright">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----duck-typing-error.jpg" alt="Common typing error">
  <figcaption>Common typing error</figcaption>
</figure>


<p>This means that errors are only ever caught while the application is running… after it’s too late to do anything about it.  </p>

<p>Statically-typed languages, on the other hand, are much more rigid.  They aim to catch development errors before the code is even executed and they do this by imposing restrictions on how you can interact with objects, forcing you to very clearly specify everything about the object that you’re going to interact with.  </p>


<figure class="image floatleft">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----static-type.jpg" alt="Example of a static type">
  <figcaption>Example of a static type</figcaption>
</figure>


<p>In static typing world, you can’t just call a “quack” method on any object - you first need to explicitly define a type that has that quack method, as well as any parameters that need to be passed into that method not to mention the value that the quack method will return to its callers.  Only then can you use that instance as a parameter or create an instance of that class to pass around to other objects or methods.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----static-typing-in-action.jpg" alt="Static typing in action">
  <figcaption>Static typing in action</figcaption>
</figure>


<p>With all this information explicitly provided, the tooling is able to easily tell me when I’ve misspelled the call to the “quack” method well before my application is running – heck, with modern tools it’ll likely take less than a second for me to find out that I’ve done something wrong!</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----static-typing-in-action.jpg" alt="Static typing in action">
  <figcaption>Static typing in action</figcaption>
</figure>


<p>If it sounds like I’m making a case for one approach over the other, I’m not – each of the typing approaches lends itself to a different set of scenarios so it quite simply depends on what you’re looking to do with the language.  </p>

<p>But here’s the thing:  who’s to say you can’t use both at the same time?</p>

<p>For better or worse, JavaScript is a dynamically typed language.  This makes it particularly suitable for dealing with the web browser object model that it was originally designed to work with.  But, JavaScript has been asked to do far more these days than what it was originally designed to do, and in some of those cases some people start to find its dynamic nature more of a curse than a gift.  In these scenarios, being able to apply static typing can have a hugely beneficial effect on the stability and maintainability of the code.  </p>

<p>Enter TypeScript.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----typescript-typing.jpg" alt="TypeScript Typing">
  <figcaption>TypeScript Typing</figcaption>
</figure>


<p>TypeScript is a superset of JavaScript – that is, it extends JavaScript with static typing capabilities;  it doesn’t fundamentally change the way that JavaScript works and it especially doesn’t take away any of JavaScript’s powerful dynamic capabilities.  TypeScript simply allows developers to opt-in to the static typing approach whenever it will benefit them.</p>

<p>Let’s go back to the quacking example from earlier:  JavaScript is a dynamic language, which means that I can write code that calls a “quack” method on any object and JavaScript isn’t going to yell at me until runtime when it turns out that quack method doesn’t actually exist.  In some cases, that may be what I want.  But, in other cases – and that case could be 5 lines further down in the same piece of code – maybe I want to be completely sure that the object actually has a quack method before I call it, and I don’t want to wait until runtime to find out.  In that case, I’ll use TypeScript’s language features to make that very clear right in my code and TypeScript will validate that assertion before my code executes.</p>

<p>This all comes at a cost, of course - you’ve got to define types in order to use them, and that means writing more code.  You just have to weigh the cost of writing that code with the value of finding out about these kinds of issues before your code executes.  For many people and many scenarios, having this piece of mind is well worth the extra work of defining the types.</p>

<p>And, if finding out about code issues as early as possible isn’t enough, having to explicitly define the types of objects you work with also tends to make your code easier to understand and maintain, especially if you have multiple developers working on the same codebase.  In cases such as these, static types tend to have an illuminating effect, helping developers understand what they can and can’t do with a particular object.</p>

<p>But perhaps the best thing about TypeScript is that you don’t always have to use static types.  While introducing static typing may help deal with a lot of different scenarios, there are still other scenarios that benefit from maintaining a completely dynamic approach, and TypeScript supports those, too.  With TypeScript, static typing is strongly encouraged, but whenever you feel the need to ditch the safety of type checking in order to take full advantage of JavaScript’s dynamic roots, just let TypeScript know and it will leave you without that type-checking safety net for as long as you like.</p>

<p>At this point, you’re likely starting to form an opinion about whether or not TypeScript sounds like a good fit for you.  If this sounds like just the thing you’ve been looking for, I think you’re going to love this book!  If you’re still hesitant about whether or not TypeScript offers enough value to make up for the extra work you’ll have to do to specify all your types, I urge you to at least read the rest of this chapter to get the full picture before making up your mind.</p>

<p>Either way, head on to the next section where I’ll get a little deeper into TypeScript’s relationship with JavaScript and how you can still benefit from TypeScript even if you never take advantage of its static typing features!</p>

<h3 id="what-is-javascript">Defining “JavaScript”</h3>

<p>I know I’ve already said it a few times, but I’m going to go ahead and say it again because it’s just that important:  TypeScript is a superset of JavaScript.  And, since JavaScript is going to play such a big part in this book, I think it’s pretty important to define what it is that I’m referring to when I use the term JavaScript.  </p>

<p>I’ll start with a real quick history lesson:</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----javascript-timeline.png" alt="JavaScript Timeline">
  <figcaption>JavaScript Timeline</figcaption>
</figure>


<p>The JavaScript language was first introduced in 1996 in the Netscape Navigator browser.  Soon, other browsers started implementing syntax and APIs incredibly similar to - but not exactly compatible with - Netscape’s implementation and within about a year or so, the ECMA International standards body attempted to get everyone on the same page by publishing a standard which defined a common specification for all implementations to follow;  this standard was called ECMAScript.</p>

<p>As such, you’ll often hear the JavaScript language referred to as ECMAScript, or simply “ES” followed by the version number of the standard – for example, “ES5”, “ES6”, or “ES2015”.  And, by the way, the ECMA group decided to reset the version numbering in the sixth version, but not until after the community had already taken to calling it “ES6”, so just keep in mind that “ES6”, “ES2015”, and “ECMAScript 2015” all refer to the same exact thing.  Yeah, confusing, I know…</p>

<p>Semantics aside, and especially throughout this book, it’s generally fine to use the terms JavaScript and ECMAScript interchangeably when referring to the various implementations of the language, as most implementations follow the standard close enough that the names can be used pretty synonymously.</p>


<figure class="image floatright">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----es6-compatibility.png" alt="ES6 Compatibility">
  <figcaption>ES6 Compatibility</figcaption>
</figure>


<p>Fast-forward to today, where we’ve got many more browsers and other platforms that leverage JavaScript, as well as several more versions of the ECMAScript standard.  However, just because a standards body publishes a version of a standard doesn’t mean every feature in that standard is immediately available in all implementations and platforms.  The reality is that some implementations already had some of the features prior to the feature being officially approved and, despite being part of the approved standard, some other features may not actually be available in all implementations for quite a while.</p>

<p>As a JavaScript developer, it can be incredibly frustrating to be aware of a convenient or powerful new feature that is available in the language you’re using, but not being able to leverage that feature out of fear that it won’t be implemented in one or more of the browsers or platforms that you must support.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----transpiler.png" alt="Transpilation">
  <figcaption>Transpilation</figcaption>
</figure>


<p>Enter the world of transpilers, or tools that transform code from one language into another language.  In our example, this means the ability to write code that leverages next-generation ECMAScript features, yet compiles down to JavaScript that is fully compatible with the current generation ECMAScript implementations that are widely available today.</p>

<p>There are handful of popular transpilers available and each of them expose the next-generation ECMAScript features in a different way.  Some transpilers attempt to be true to the ECMAScript standard, allowing you to write your code as if the latest version of the standard were available everywhere.  Other transpilers use a syntax that is effectively a completely different language altogether.<br>
Regardless of what syntax you use to write your code, however, all transpilers compile that code into the JavaScript that is most compatible with all implementations that you’re looking to run your application on.</p>

<p>As of the time of this writing, ECMAScript 2015 has only been recently ratified, which means that it will still be a while until all of its features are available everywhere you want them to be.  The good news is that, in addition to all of the static typing features that I’ll be showing throughout this book, TypeScript also implements a handful of ECMAScript 2015 features as well.  In fact, I’ll spend the entire first chapter of this book just showing you how to implement these ECMAScript features with TypeScript before I even get into showing you how to leverage TypeScript’s static typing features.</p>

<p>And in this way, TypeScript definitely falls under the “transpiler” category.  More importantly, it falls into the class of transpiler that aims to remain true to the ECMAScript standard rather than the kind of transpiler that reinvents its own language.  So, when I say that “TypeScript is a superset of JavaScript”, I’m referring to this idea that TypeScript starts with being as compatible with the latest ECMAScript standard as possible, and then adds even more features on top of that foundation.  </p>

<p>The chart I showed earlier is from an excellent website I like to refer that contains an exhaustive list of all of the ECMAScript standards and which tools, runtimes, and implementations currently support them. TypeScript is among the tools that is compared on this list and as of the time of this writing, this site states that TypeScript implements about a half of the total ECMAScript 2015 standard.  While that may seem unimpressive - especially compared to some of the other tools such as Babel - it’s important to keep in mind that the real value TypeScript offers is adding static typing support to JavaScript – as an added perk, it also implements some ES6 features as well.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Introduction----incompatibility-chart.png" alt="TypeScript: Not a full ECMAScript 2015 implementation">
  <figcaption>TypeScript: Not a full ECMAScript 2015 implementation</figcaption>
</figure>


<p>Also keep in mind that TypeScript also happens to implement some of the future features defined in the next ECMAScript standard, ECMAScript 7, and that standard is not even close to being finalized yet.  I think you can expect TypeScript to continue to growing, remaining as compatible with current, approved standards while also implementing proposed features.  In other words, in addition to all of the benefits of static typing that TypeScript adds, it also helps you leverage many JavaScript features that may not otherwise be available to you.  Personally, I think that’s a great deal.</p>

<p>For more details of the ECMAScript 2015 features that TypeScript supports and how to leverage them, check out the “ECMAScript 2015 Features” chapter of this book.</p>

<p>But, enough about JavaScript and ES6 - head on to the next section to get a glimpse into how you use TypeScript to implement all this static typing that I’ve been raving about!</p>

<h3 id="first-typescript-function">Writing your first TypeScript function</h3>

<p>Over the past few sections, I’ve described what TypeScript is in theory, but now it’s time to see it in action.  In this section I’m going to take you on a whirlwind tour of the most important features of TypeScript - the features that you’ll find yourself using on a daily basis.  If you find that I’m going too fast in this section, don’t worry - I’ll spend the rest of this book diving into all the details so that you won’t miss a thing.</p>

<p>In later sections, I’ll show you how to install TypeScript onto your local system, but I’m going to skip that for now and start by showing you the simplest possible way to start learning TypeScript: TypeScript’s free, online TypeScript editor.  This editor is a powerful tool that gives you full syntax highlighting, auto-complete capability, and compile TypeScript right in the browser</p>

<p>You can get to the editor by opening up your favorite browser and going to <a href="https://typescriptlang.org/">typescriptlang.org</a>, then clicking the “play” menu item at the top of the TypeScript homepage.  </p>

<p>Once the page has loaded, I’ll clear all the code thatâ€™s already in the editor and replace it with this snippet of JavaScript code:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="lineno">1 </code><code class="kd">function</code> <code class="nx">speak</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">2 </code>    <code class="nb">document</code><code class="p">.</code><code class="nx">write</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="lineno">3 </code><code class="p">}</code>
<code class="lineno">4 </code>
<code class="lineno">5 </code><code class="kd">var</code> <code class="nx">greeted</code> <code class="o">=</code> <code class="s2">"World"</code><code class="p">;</code>
<code class="lineno">6 </code><code class="kd">var</code> <code class="nx">greeting</code> <code class="o">=</code> <code class="s2">"Hello, "</code><code class="p">;</code>
<code class="lineno">7 </code><code class="kd">var</code> <code class="nx">whatToSay</code> <code class="o">=</code> <code class="nx">greeting</code> <code class="o">+</code> <code class="nx">greeted</code><code class="p">;</code>
<code class="lineno">8 </code>
<code class="lineno">9 </code><code class="nx">speak</code><code class="p">(</code><code class="nx">whaToSay</code><code class="p">);</code>
</pre></div>

</figure>

<p>Right off the bat, the TypeScript editor is already helping spot problems in this code:  turns out I spelled the variable name wrong in the last line!  That’s simple enough to fix - I’ll just add the missing character.</p>

<p>With that fixed, let’s look at what this snippet is doing:  we’ve got a function called speak which simply writes out the variable to the document, and a couple of variables that we’re adding together to produce the full text that we are passing to the speak function.  </p>

<p>Seems straight-forward enough – what could go wrong, right?
As it turns out, plenty.  For instance, what happens when I change the value of the greeted variable to a different type, such as a number?</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">greeted</code> <code class="o">=</code> <code class="mi">42</code><code class="p">;</code>
</pre></div>

</figure>

<p>Actually, that’s fine, because JavaScript is smart enough to convert that number back into a string when the number is added to a string.  And, since the result will always be a string type and never be ambiguous, TypeScript is happy as well.  But, what if I turned BOTH values into numbers?  Then the resulting value would be a number!</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">greeted</code> <code class="o">=</code> <code class="mi">42</code><code class="p">;</code>
<code class="kd">var</code> <code class="nx">greeting</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
</pre></div>

</figure>

<p>Now, we’ve gone from passing a string value into the <code>speak()</code> function to passing a number value.  True to JavaScript’s dynamic nature, it doesn’t care - it just goes ahead and converts it to a string in order to render it to the browser.  TypeScript is also happy, since the number can be converted to a string.</p>

<p>Here’s the problem: that’s not what I intended to happen.  I only ever intended for the speak method to accept a string value, but JavaScript doesn’t let me express that intent.  The only way I can ever guarantee that the parameter value is a string is to write code to check it at runtime.</p>

<p>Here’s where TypeScript comes in handy.  If I only ever want strings to be passed in, I can say so by explicitly saying that the <code>value</code> parameter is a string using this syntax:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">speak</code><code class="p">(</code><code class="nx">value</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code>
</pre></div>

</figure>

<p>As soon as I add this type, TypeScript immediately notices that I am trying to pass a number value as a parameter to the speak function on the last line of code and underlines that code in red to indicate the error.  When I hover over the error, TypeScript tells me that I’m trying to pass in a number when the function expects a string.</p>

<p>TypeScript is raising this error because it thinks that the variable I’m passing is a number.  TypeScript thinks the variable is a number because it was initialized as the result of adding two numbers together.  To make this error go away, I need to tell TypeScript that the <code>whatToSay</code> variable is, indeed, a string.  I can do that using the same syntax that I just used to define the string type on the method parameter: right after the variable name, and before the assignment.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">whatToSay</code><code class="o">:</code> <code class="nx">string</code> <code class="o">=</code> <code class="nx">greeting</code> <code class="o">+</code> <code class="nx">greeted</code><code class="p">;</code>
</pre></div>

</figure>

<p>Of course, that didn’t actually solve the problem, it just gave TypeScript more information to figure out where the problem was.  Remember - the real problem is that I’m adding two numbers together which produce a number as a result.  What I need to do is change this addition to produce a string rather than a number, and I can do that by explicitly calling the <code>toString()</code> method on one of the number values to turn it into a string.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">whatToSay</code><code class="o">:</code> <code class="nx">string</code> <code class="o">=</code> <code class="nx">greeting</code><code class="p">.</code><code class="nx">toString</code><code class="p">()</code> <code class="o">+</code> <code class="nx">greeted</code><code class="p">;</code>
</pre></div>

</figure>

<p>And, finally, the error goes away completely.</p>

<p>It’s interesting to note that what I’m left with now doesn’t make a whole lot of sense, either:  why in the world am I converting two numbers to strings and adding them together?  The answer is that this is just a demo, but it does illustrate an important point:  TypeScript may help a lot, but it’s not going to solve all your problems - you’re still responsible for writing code that makes sense… but that’s a different book altogether!</p>

<p>Of course, the real solution is for me to never have made them numbers in the first place…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">greeted</code> <code class="o">=</code> <code class="s2">"World"</code><code class="p">;</code>
<code class="kd">var</code> <code class="nx">greeting</code> <code class="o">=</code> <code class="s2">"Hello, "</code><code class="p">;</code>
</pre></div>

</figure>

<p>Now that I’ve shown how to specify the type of variables and function parameters, let’s talk about function return values.  Take a look at what TypeScript says when I hover over the speak function: notice that void at the end?  That’s TypeScript saying that this method doesn’t return any value.  And, when I add a return value, that type changes:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">speak</code><code class="p">(</code><code class="nx">value</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
    <code class="nb">document</code><code class="p">.</code><code class="nx">write</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
    <code class="k">return</code> <code class="nx">value</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>If I hover over the method again I can see that TYpeScript has now determined that the method returns a string value.  Likewise, let’s see what happens when I change the value that I’m returning to the length of the variable:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">return</code> <code class="nx">value</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
</pre></div>

</figure>

<p>Now when I hover over the function I can see that TypeScript thinks that it now returns a number.</p>

<p>When I want to explicitly define which value the function returns, all I have to do is use the same syntax at the end of the function signature as I did with the variable definition.</p>

<p>For example, let’s say that I want to make sure that the <code>speak()</code> function always returns a string type.  I’ll simply add that to the end of the function signature:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">speak</code><code class="p">(</code><code class="nx">value</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">string</code> <code class="p">{</code>
</pre></div>

</figure>

<p>With the return type specified, TypeScript can now tell me when I’m not returning a value that matches that type, which is the case right now since I’m actually returning the length of the value rather than the value itself.  Luckily, that’s pretty easy to fix:</p>

<figure class="code">
<div class="highlight"><pre>function speak(value: string): string {
    document.write(value);
<code class="uil">    return value;
</code>}
</pre></div>

</figure>

<p>Once I fix that, TypeScript is happy again and all the errors go away.</p>

<p>And that’s your whirlwind introduction to TypeScript’s static typing functionality.  Of course, there is far more to learn about TypeScript - and trust me, I’ll show it all to you in the other chapters - but everything else you’re going to see throughout this book rests on top of these fundamentals.</p>

<p>Now that I’ve given you the high-level overview of what TypeScript is and how it might be beneficial to you, head on to the next chapter where I’ll show you how to install and configure the tools you’ll need in order to work with TypeScript on your local machine as opposed to an editor on a website.</p>

<h2 id="getting-started">
<span class="section-number">3. </span>Getting Started</h2>

<h3 id="choosing-your-editor">Choosing your TypeScript editor</h3>

<p>In the last chapter, I described what TypeScript is and how it relates to JavaScript. </p>

<p>In this section, I’m going to talk a little bit about the tools you’ll need in order to work with TypeScript.  </p>

<p>Actually, I don’t really need an entire section because the answer is simple:  since TypeScript is just a superset of JavaScript, you’ll almost certainly end up using the same tools to work with TypeScript as you already use to work with JavaScript today!</p>

<p>TypeScript is a compiled (or “<em>trans</em>piled”) language, so you will need at least two tools to work with TypeScript:  a text editor, and the TypeScript compiler.  </p>

<p>Technically speaking, you can use any text editor you want, however you’re probably going to want an editor that understands TypeScript well enough to offer some nice features such as syntax highlighting and auto-complete functionality built in.</p>

<p>Lucky for us, TypeScript has been around long enough and gained enough popularity that your favorite JavaScript editor almost certainly has some kind of TypeScript support either built-in or available as an extension.  For most of the popular text editors such as Sublime Text, TextMate, Atom, Notepad++, Visual Studio Code, it’s as simple as searching in their library of extensions and installing the feature.</p>

<p>Then, of course, there are full-fledged Integrated Development Environments (or IDEs) such as Visual Studio, WebStorm, or Eclipse.  Just like basic text editors, your favorite IDE will likely have great TypeScript support, but some of them may even have the TypeScript compiler built right in.</p>

<p>In the following sections I’m going to show you a couple of ways of installing TypeScript take make sure that one of them will be a good fit for you:</p>

<ul>
  <li>The next section will be for you Visual Studio developers who like to have everything easily accessible right there in an nice IDE and integrated into the Visual Studio projects and solution structure that you already know and love.  If this describes you, then you may never need to open up a command line to use TypeScript.</li>
  <li>The section after that, however, will be for everyone else.  In that section, I’ll show you how to install the Node Package Manager (or NPM) and use it to install and execute the TypeScript command line interface while editing your TypeScript files in your text editor of choice, whether it’s TextMate, Atom, or the new cross-platform editor, Visual Studio Code.</li>
</ul>

<p>In the rest of this book after these next two sections I will be using Visual Studio Code to edit my TypeScript files and the command-line interface to compile them.  However, after you’ve installed TypeScript using one of these next two sections, you will be able to follow along with me throughout the rest of the course regardless of whether what text editor you choose or even which OS you’re running, be it Windows, Mac, or even Linux.</p>

<p>So, enough talk - choose one of the next two sections that applies to you and let’s get installing!</p>

<h3 id="visual-studio-installation">Installing TypeScript in Visual Studio</h3>

<p>I mentioned in the last section that you can choose any editor that you wanted in order to work with TypeScript and that some editors had support for TypeScript already built-in.  Considering that Microsoft created both the Visual Studio IDE and TypeScript, it should come as no surprise that Visual Studio offers great support for TypeScript built right in… well… kind of.</p>

<p>Let me clarify that a little bit.  Visual Studio has been around a long time and there are several different versions still in wide-spread use today, and each of them offers varying levels of support for TypeScript.</p>

<p>If you’re using Visual Studio 2010 or older, I’m sorry, but there is no built-in TypeScript or extension that I’m aware of.  If you really wanted to, you could jump to the next section and install the command line version of TypeScript, then use Visual Studio 2010 as your HTML and TypeScript editor, but frankly if that is your situation then there are a number of much better TypeScript editors available, and most of them are free.</p>

<p>If you’re using Visual Studio 2013, you didn’t get TypeScript support right out of the box, but you can install the TypeScript extension by visiting <a href="http://www.typescriptlang.org/">typescriptlang.org</a>, then clicking the “Download” button at the top, and selecting “TypeScript for VS2013”.<br>
This will bring you to the “TypeScript for Visual Studio 2013” extension page where you can download the extension and run it to enable full TypeScript support in Visual Studio 2013.</p>

<p>On the other hand, the latest Visual Studio release - Visual Studio 2015 - actually has full TypeScript support right out of the box, but it’s actually a little outdated so you’re going to want to install the most recent version of TypeScript on top of what Visual Studio already provides.  You’ll follow the same steps to install the extension as you did with Visual Studio 2013, except you’ll choose the “TypeScript for VS 2015” option instead.</p>

<p>Once the extension is installed you should have everything you need in order to follow along with the course.  </p>

<aside class="tip blurb">
    <p>Keep in mind that I’ll be using the command line interface and Visual Studio Code in order to demonstrate all my examples, however if you are familiar with Visual Studio you should be able to follow along without any problem at all.<br>
In that case, you’re welcome to read the next section where I install the command line interface, but if you don’t want to, that’s fine - it’s not required, and you can just skip on to the next section where I show you how to configure the TypeScript compiler in your project.</p>

</aside>

<h3 id="npm-installation">Installing the TypeScript Command Line Interface</h3>

<p>If you’re reading this section, either you’re running on a Mac or Linux machine or you’re a Windows user and you’ve decided that you’re going to use a lightweight code editor instead of a full-blown IDE like Visual Studio.</p>

<p>Regardless of how you got here, I think you made a good choice.  Many people find the command line interface rather daunting, but I find that once you get used to it it’s actually quite a nice and lightweight option.</p>

<p>In order to be truly cross-platform compatible, the TypeScript command line interface is actually built in NodeJS.  Don’t worry - you won’t have to learn how to be a NodeJS developer in order to use the TypeScript command line, but you will  need to install the Node Package Manager (or “NPM”), which comes included in the NodeJS installer.</p>

<p>To install NodeJS, simply visit <a href="http://nodejs.org/">nodejs.org</a> and then choose the appropriate download for your environment.	
Feel free to install either the “mature” or “latest” version - as of this writing, TypeScript will work on either.</p>

<p>Once you’ve installed NPM, it’s time to use it to install TypeScript.  In order to do so, simply jump into a command prompt:  in Mac you can open Spotlight and search for  “terminal”, and in Windows you can open the Start menu and search for either “Command Prompt” or “PowerShell” - either one will work fine, but personally I like PowerShell because it offers a resizable window and nicely-colored text highlighting.</p>

<p>Keep in mind that all of the commands I’ll show you in this book should be exactly the same, regardless of which OS or command prompt you’re using.</p>

<p>Once in the command prompt, type the following:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">npm</code> <code class="nx">install</code> <code class="o">-</code><code class="nx">g</code> <code class="nx">typescript</code>
</pre></div>

</figure>

<p>This command tells the Node Package Manager to install the TypeScript compiler (and the “-g” option tells it to install it globally so the command will be available to you regardless of which project you’re working in.
n
Once it’s done, you can verify that everything worked by typing the command “tsc”.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsc</code>
</pre></div>

</figure>

<p>Technically speaking, that’s all you need in order to compile TypeScript files into JavaScript, however in order to follow along with this book you’ll also need to open up a web page, and for that you’ll need a web server.  You could probably get away with just saving the files to your local machine and opening them directly in your browser, but since we’re already at the command prompt and we already have NPM installed, let me introduce you to one of my trade secrets called “lite-server”.</p>

<p>Lite server is a little lightweight web server that not only serves your files for you, it also injects a little script into each of your page that listens for changes to those files.  When the server detects a change, it refreshes the browser automatically.  Trust me, web development is much more enjoyable when you don’t have to keep hitting “refresh” all the time.</p>

<p>To install lite-server, simply use the “npm install” command like you did for typescript, but install “lite-server” instead, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">npm</code> <code class="nx">install</code> <code class="o">-</code><code class="nx">g</code> <code class="nx">lite</code><code class="o">-</code><code class="nx">server</code>
</pre></div>

</figure>

<p>Now that you’ve got all that installed, let’s move on to the next section to create our new project and configure it for TypeScript.</p>

<h3 id="configuration">Configuring the TypeScript compiler</h3>

<p>In this chapter, I’ve shown you how to get TypeScript installed on your local machine, and now it’s time to show you how to start up a new TypeScript project.</p>

<p>Now, you can use TypeScript anywhere that JavaScript is supported – on the client, server… heck, I can even code my Pebble smartwatch using JavaScript!  However, I assume that the majority of the time you’re using TypeScript it’ll be to build web applications in the browser.  </p>

<p>As such, our project starts by simply creating a new folder with an index.html file to host our generated JavaScript.</p>

<p>So, go ahead and create a folder to hold our project.  Throughout this book I’ll be showing you how to build a Todo application, so let’s call the folder “TypeScriptTodo”.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">mkdir</code> <code class="nx">TypeScriptTodo</code>
<code class="nx">cd</code> <code class="nx">TypeScriptTodo</code>
</pre></div>

</figure>

<p>Once I’ve created the folder, I’ll open it up in my favorite text editor, Visual Studio Code.</p>

<figure class="code">
<div class="highlight"><pre><code></code> <code class="nx">code</code> <code class="p">.</code>
</pre></div>

</figure>

<aside>

  <p>Note that if you’re using the Visual Studio IDE instead of following these steps, you can do this instead:</p>

  <p>Open Visual Studio</p>

  <p>Choose “File &gt; New Project”</p>

  <p>Choose the “Web Application” project type</p>

  <p>Then, choose the “Empty Web” template and enter “TypeScriptTodo” as your project’s name</p>


</aside>

<p>Once I have the folder open in my editor, I’ll create a new HTML file named “index.html” and populate it with some markup:</p>

<figure class="code">
  <figcaption>index.html</figcaption>

<div class="highlight"><pre><code></code><code class="cp">&lt;!doctype html&gt;</code>
<code class="p">&lt;</code><code class="nt">html</code> <code class="na">lang</code><code class="o">=</code><code class="s">"en"</code><code class="p">&gt;</code>
<code class="p">&lt;</code><code class="nt">head</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">title</code><code class="p">&gt;</code>TypeScript Todo App<code class="p">&lt;/</code><code class="nt">title</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code> <code class="na">href</code><code class="o">=</code><code class="s">"//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/b\</code>
<code class="s">ootstrap.min.css"</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">head</code><code class="p">&gt;</code>
<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"container"</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code><code class="p">&gt;</code>
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">script</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/javascript"</code> <code class="na">src</code><code class="o">=</code><code class="s">"app.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">html</code><code class="p">&gt;</code>
</pre></div>

</figure>

<p>Other than the fact that I’ve linked to the Bootstrap UI framework stylesheet on line 5 to make my site look a little bit nicer, this is nothing but some boilerplate HTML.  Notice how I have a link to a JavaScript file called <code>app.js</code> on line 10, even though this file doesn’t exist yet.  </p>

<p>That file will be the JavaScript output from this new TypeScript file I’ll create, named <code>app.ts</code>.</p>

<p>Now with all this in place, it’s time to get the TypeScript compiler working!</p>

<aside>
  <p>Note that if you’re in Visual Studio, all that you should have to do at this point is save your project and it should automatically generate the JavaScript file for you.  You won’t have to do any of this command line stuff (but it’s still interesting to read about!).</p>

</aside>

<p>Technically speaking, the simplest way to build compiler your TypeScript files is to jump into your command prompt and simply run the TSC command, passing in the names of all the TypeScript files you want to compile, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsc</code> <code class="nx">app</code><code class="p">.</code><code class="nx">ts</code>
</pre></div>

</figure>

<p>Even though the command doesn’t emit any output, I can see that it works because I now have an <code>app.js</code> file in the same folder.</p>


<figure class="image floatright">
  <img src="./Read Essential TypeScript _ Leanpub_files/GettingStarted----compiler-output.png" alt="TypeScript compiler output">
  <figcaption>TypeScript compiler output</figcaption>
</figure>


<p>I can even have the TypeScript compiler watch for changes to my files and recompile them automatically by passing in the “-w” option, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsc</code> <code class="o">-</code><code class="nx">w</code> <code class="nx">app</code><code class="p">.</code><code class="nx">ts</code>
</pre></div>

</figure>

<p>When I pass in the “-w” option, TypeScript compiles my file, then tells me that it’s waiting for changes.</p>

<p>Then, I can go back to my editor, make some more changes…</p>

<figure class="code">
  <figcaption>app.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">string</code> <code class="o">=</code> <code class="s2">"Pick up drycleaning"</code><code class="p">;</code>
</pre></div>

</figure>

<p>And then look at the app.js file again… </p>

<figure class="code">
  <figcaption>app.js</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="s2">"Pick up drycleaning"</code><code class="p">;</code>
</pre></div>

</figure>

<p>and see that my changes have been compiled.</p>

<p>However, if I run the <code>tsc</code> command again I can see that the TypeScript compiler actually supports a whole lot more options than just “-w”.<br>
And, if I wanted to make use of any of those options, I’d have to type them as command line parameters every time, which would get pretty old after a while.</p>

<p>In fact, if you’re using the full-blown Visual Studio IDE, you don’t have a command line, so where would you put these options!?</p>

<p>Luckily, there is a solution that solves both of these problems:  the TypeScript configuration file, or <code>tsconfig.json</code>.</p>

<p>This file is just a simple JSON file, so just add a new file to the folder named <code>tsconfig.json</code> and, since the TypeScript configuration object is just a JSON object with configuration values, start by defining an empty JSON object:</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, in the Visual Studio Code editor and the full-blown Visual Studio IDE, you can hit <code>Ctl-Space</code> to see the configuration options you have available to you.</p>

<p>Choose the first one, “compilerOptions”.  Then, hit <code>Ctl-Space</code> again to see what compiler options are available:</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
        
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>There are a whole lot of configuration options - and we’ll see a lot of them in this book -  but let’s start with the simplest one:  the ECMAScript version that we want to target.<br>
In order to do that, choose the “target” option.</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
        <code class="s2">"target"</code><code class="o">:</code> <code class="s2">"es3"</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Once it’s added, we can delete the default value and hit Ctl-space again to see what other versions of ECMAScript we can target, and since we’re looking for ES5 compatibility, go ahead and pick the “es5” option.</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
        <code class="s2">"target"</code><code class="o">:</code> <code class="s2">"es5"</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>I’ll explore later how changing the target ECMAScript version changes the JavaScript that TypeScript generates, but for now I’m just going to save the file and go back to the command line to see how just having this configuration file in place changes how the compiler behaves.</p>

<p>When it starts, the TypeScript compiler looks for this <code>tsconfig.json</code> file in the root folder.  If it finds it, it treats the whole folder - and all of its sub-folders - as one big project, and automatically detects any TypeScript files.</p>

<p>So, the biggest difference now is that we no longer have to tell TypeScript which files to compile - just type in “tsc -w” and it will find them, compile them, and wait for changes to any of them:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsc</code> <code class="o">-</code><code class="nx">w</code>
</pre></div>

</figure>

<p>I can tell by the fact that the compiler isn’t showing any errors that it’s working, but just for the heck of it I can go change my app.ts file a bit to test it out…</p>

<figure class="code">
  <figcaption>app.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">string</code> <code class="o">=</code> <code class="s1">'Dryclean cape'</code><code class="p">;</code>
</pre></div>

</figure>

<p>And I can go back to the command prompt and see from the output that everything is still working fine.</p>

<p>And that is how you create and configure your very first TypeScript project!  Be sure to hold on to this folder because we’re going to be using it to build our sample application using TYpeScript throughout the rest of this book.  Also, make sure to keep that “tsc” task running in the background the whole time you’re working on the code samples in this book, because I will be!</p>

<p>Now that you’re all set up, why don’t you head on to the next chapter where I’ll show you all of the latest ECMAScript features that TypeScript makes available to you so that you can begin using this new project to implement tomorrow’s ECMAScript language features today.</p>

<h2 id="ecmascript-features">
<span class="section-number">4. </span>ECMAScript 2015 Features</h2>

<p>In the last chapter, I mentioned that in addition to adding static typing to the JavaScript language, TypeScript also provides the ability to leverage a handful of ECMAScript 2015 and next-generation ECMAScript features that aren’t yet widely supported and compile them down to ES5-compatible JavaScript that will run in all of today’s browsers.  In this chapter I’m going to walk through each of those ECMAScript features in detail, showing you how each feature works and why you might want to use it in your application.  </p>

<p>Notice how I said “might want to use it” – as you read these next few sections, you may notice that I’ll use the term “syntactic sugar” quite a bit.  When I say that something is “syntactic sugar”, what I mean is that they do not change the functionality of your application at all.  They are simply nice, clean ways to express logic that would otherwise take many more keystrokes to write out using the previous ES5 language syntax. </p>

<p>Keep in mind, however, that even though these features are a very nice way to write clean, concise JavaScript - and I will be using most of them in the sample code that I write throughout this book - nothing I’m about to show you is required in order to leverage TypeScript’s static typing abilities.  What’s more, each of these features are independent of each other which means that you don’t need to learn one feature in order to leverage another feature.  Just learn the features that seem like they might have some value to you and ignore the rest. </p>

<p>So, if you are really eager to jump directly into the unique static typing approach that only TypeScript offers, you can feel free to skip any section in this chapter - or even the entire chapter - and then come back and read them later.  They’ll be here waiting for you!</p>

<div class="page-break"></div>
<h3 id="optional-parameters">Optional Parameters</h3>

<p>The first  ECMAScript 2015 feature I’ll demonstrate is called <strong>optional parameters</strong>.  Just as its name implies, the optional parameter syntax allows you to specify a default value for a given parameter in the case that a value is not explicitly passed in.</p>

<p>Take this function, which counts down from an initial number to a final number at a given interval, and it accepts all three of these values as parameters.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">container</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'container'</code><code class="p">);</code>

<code class="kd">function</code> <code class="nx">countdown</code><code class="p">(</code><code class="nx">initial</code><code class="p">,</code> <code class="kr">final</code><code class="p">,</code> <code class="nx">interval</code><code class="p">)</code> <code class="p">{</code>

	<code class="kd">var</code> <code class="nx">current</code> <code class="o">=</code> <code class="nx">initial</code><code class="p">;</code>
	
	<code class="k">while</code><code class="p">(</code><code class="nx">current</code> <code class="o">&gt;</code> <code class="kr">final</code><code class="p">)</code> <code class="p">{</code>
               <code class="nx">container</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="nx">current</code><code class="p">;</code>
	    <code class="nx">current</code> <code class="o">-=</code> <code class="nx">interval</code><code class="p">;</code>
	<code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>The nice thing about this function is that it is very customizable: since all of the variables are exposed as parameters on the function I am able to pass in any values I like for the initial value, the final value, and the interval.</p>

<p>However, let’s say that as I start using this function throughout my application I find that I’m always counting down to 0 with an interval of 1.  In other words, I’m almost always passing in 0 and 1 as the values for the last two parameters, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">countdown</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code>
</pre></div>

</figure>

<p>Notice how I said “almost always”, meaning that there are still some cases where I do want to be able to specify how far down to count or how quickly to do it by passing in values for the last two parameters rather than simply hard-coding them.</p>

<p>This is the perfect scenario for optional parameters.  </p>

<p>I can specify that a parameter is “optional” by simply adding “equals” after the parameter name and then specifying the default value that should be used if the caller omits that parameter:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="lineno"> 1 </code><code class="kd">function</code> <code class="nx">countdown</code><code class="p">(</code><code class="nx">initial</code><code class="p">,</code> <code class="kr">final</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">interval</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno"> 2 </code>
<code class="lineno"> 3 </code>    <code class="kd">var</code> <code class="nx">current</code> <code class="o">=</code> <code class="nx">initial</code><code class="p">;</code>
<code class="lineno"> 4 </code>    
<code class="lineno"> 5 </code>    <code class="k">while</code><code class="p">(</code><code class="nx">current</code> <code class="o">&gt;</code> <code class="kr">final</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno"> 6 </code>        <code class="nx">container</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="nx">current</code><code class="p">;</code>
<code class="lineno"> 7 </code>        <code class="nx">current</code> <code class="o">-=</code> <code class="nx">interval</code><code class="p">;</code>
<code class="lineno"> 8 </code>    <code class="p">}</code>
<code class="lineno"> 9 </code>
<code class="lineno">10 </code><code class="p">}</code>
</pre></div>

</figure>

<p>If we take a look at the ES5-compatible JavaScript code that is generated - especially lines 3 &amp; 4 - we can see that the compiler has added a check for each parameter to see if the caller of the function provided a value for that parameter by looking to see if the value is “void” or not.  When it sees that the parameter was omitted, it initializes the value of that variable to the default value.</p>

<p>With this change in place, I can now call the countdown function by only passing in one parameter:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">countdown</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code>
</pre></div>

</figure>

<p>And when I do this, the final parameter will default to <code>0</code> and the interval parameter with default to <code>1</code>.  </p>

<p>Then, in the cases where I want to specify the final parameter, I can do so:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">countdown</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">4</code><code class="p">)</code>
</pre></div>

</figure>

<p>And the interval parameter will still default to <code>0</code>.</p>

<p>Of course, I can still call the function by passing in all three parameters, just as before:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">countdown</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code>
</pre></div>

</figure>

<p>As this simple example shows, optional parameters and default values are a nice bit of syntactic sugar that can really help make your code cleaner and easier to read.</p>

<div class="page-break"></div>
<h3 id="template-strings">Template Strings</h3>

<p>In this section I’m going to demonstrate one of my favorite ECMAScript features: <strong>template strings</strong>.<br>
Template strings are an incredibly simple but surprisingly powerful bit of syntactic sugar to help you in those scenarios when you want to construct a string that includes the values of your variables.</p>

<p>Here’s a really simple example:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">id</code><code class="o">:</code> <code class="mi">123</code><code class="p">,</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">completed</code><code class="o">:</code> <code class="kc">true</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">displayName</code> <code class="o">=</code> <code class="sb">`Todo #</code><code class="si">${</code><code class="nx">todo</code><code class="p">.</code><code class="nx">id</code><code class="si">}</code><code class="sb">`</code><code class="p">;</code>
</pre></div>

</figure>

<p>The first thing to notice is the syntax.  In JavaScript, there are two ways to define a string literal value: you can wrap the text in single or double quotes.  In order to define a string template you use the backtick symbol - that one right next to your 1 key that you’ve never used for anything else.  Inside the template you can write whatever string literal you want, just like a normal string literal, except for when you want to inject a value - that’s when you open up an expression by typing “dollar open bracket”.  You close the expression by closing the bracket.  Inside of those brackets you can put whatever JavaScript expression you like, and the result will be rendered at that place in the string.</p>

<p>If you take a look at the ES5 that this gets compiled down to, it makes a whole lot more sense:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="s2">"Hello, "</code> <code class="o">+</code> <code class="nx">name</code><code class="p">;</code>
</pre></div>

</figure>

<p>Looking at this compiled code with such a simple example also makes this syntax seems a little silly, but it gets a whole lot more interesting when you consider a more real-world example.  For instance, let’s assume we want to use this chunk of HTML as a template to render the details of a Todo:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="o">&lt;</code><code class="nx">div</code> <code class="nx">todo</code><code class="o">=</code><code class="s1">'[[Todo ID]]'</code> <code class="kr">class</code><code class="o">=</code><code class="s2">"list-group-item}"</code><code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="nx">i</code> <code class="kr">class</code><code class="o">=</code><code class="s2">"[[ If Todo is complete, then "</code><code class="nx">hidden</code><code class="s2">" ]] text-success glyphicon gl\</code>
<code class="s2">yphicon-ok"</code><code class="o">&gt;&lt;</code><code class="err">/i&gt;</code>
    <code class="o">&lt;</code><code class="nx">span</code> <code class="kr">class</code><code class="o">=</code><code class="s2">"name"</code><code class="o">&gt;</code><code class="p">[[</code><code class="nx">Name</code><code class="p">]]</code><code class="o">&lt;</code><code class="err">/span&gt;</code>
<code class="o">&lt;</code><code class="err">/div&gt;</code>
</pre></div>

</figure>

<p>Previously, I might implement this template by reading this from the DOM and then doing a search-and-replace operation to insert the various bits of logic and data such as the Todo ID, Todo Name, and dynamically applying the “hidden” class to hide the “success” icon on the second line when the todo is not yet completed.</p>

<p>So, let’s avoid all of that by converting this into a string template instead.</p>

<p>The first thing to do is wrap the HTML in backticks.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">container</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code>  <code class="sb">`</code>
<code class="sb">    &lt;div todo='[[Todo ID]]' class="list-group-item}"&gt;</code>
<code class="sb">        &lt;i class="[[ If Todo is complete, then "hidden" ]] text-success glyphico</code><code class="err">\</code><code class="sb"></code>
<code class="sb">n glyphicon-ok"&gt;&lt;/i&gt;</code>
<code class="sb">        &lt;span class="name"&gt;[[Name]]&lt;/span&gt;</code>
<code class="sb">    &lt;/div&gt;</code>
<code class="sb">`</code>
</pre></div>

</figure>

<p>Notice how the string template spans multiple lines.  You don’t have to do anything special, just hit enter and keep on typing.  </p>

<p>Also, the fact that this syntax leverages the backtick symbol to open and close the template means that you’re free to use the single- and double-quotes inside of the template, just like any other character.</p>

<p>Then, rather than doing those search-and-replace operations, we can insert the values that we want directly into the template using the “dollar-bracket” syntax, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">id</code><code class="o">:</code> <code class="mi">123</code><code class="p">,</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">completed</code><code class="o">:</code> <code class="kc">true</code>
<code class="p">}</code>

<code class="nx">container</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="sb">`</code>
<code class="sb">    &lt;div todo='</code><code class="si">${</code><code class="nx">todo</code><code class="p">.</code><code class="nx">id</code><code class="si">}</code><code class="sb">' class="list-group-item}"&gt;</code>
<code class="sb">        &lt;i class="[[ If Todo is complete, then "hidden" ]] text-success glyphico</code><code class="err">\</code><code class="sb"></code>
<code class="sb">n glyphicon-ok"&gt;&lt;/i&gt;</code>
<code class="sb">        &lt;span class="name"&gt;</code><code class="si">${</code><code class="nx">todo</code><code class="p">.</code><code class="nx">name</code><code class="si">}</code><code class="sb">&lt;/span&gt;</code>
<code class="sb">    &lt;/div&gt;</code>
<code class="sb">`</code>
</pre></div>

</figure>

<p>One of the cool things about string templates is that you don’t have to restrict yourself to simple variable replacements.  You can actually put more complex statements in that will be evaluated.</p>

<p>For example, I can figure out whether or not to render the “hidden” class on the icon element dynamically by introducing a conditional statement right there in the expression, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">container</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="sb">`</code>
<code class="sb">    &lt;div todo='</code><code class="si">${</code><code class="nx">todo</code><code class="p">.</code><code class="nx">id</code><code class="si">}</code><code class="sb">' class="list-group-item}"&gt;</code>
<code class="sb">        &lt;i class="</code><code class="si">${</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">completed</code> <code class="o">?</code> <code class="s2">""</code> <code class="o">:</code> <code class="s2">"hidden"</code> <code class="si">}</code><code class="sb"> text-success glyphicon gly</code><code class="err">\</code><code class="sb"></code>
<code class="sb">phicon-ok"&gt;&lt;/i&gt;</code>
<code class="sb">        &lt;span class="name"&gt;</code><code class="si">${</code><code class="nx">todo</code><code class="p">.</code><code class="nx">name</code><code class="si">}</code><code class="sb">&lt;/span&gt;</code>
<code class="sb">    &lt;/div&gt;</code>
<code class="sb">`</code>
</pre></div>

</figure>

<p>When the value of todo.completed is true, the expression will evaluate to an empty string and no CSS class will be applied;  when the value is false, the expression will output the string “hidden”, which will be rendered along with the rest of the CSS classes in the template.</p>

<figure class="code">
  <figcaption>app.js</figcaption>

<div class="highlight"><pre><code></code><code class="nx">container</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="s2">"\n\t    &lt;div todo='"</code> <code class="o">+</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">id</code> <code class="o">+</code> <code class="s2">"' class=\"list-group-it\</code>
<code class="s2">em}\"&gt;\n\t        &lt;i class=\"[[ If Todo is complete, then \"hidden\" ]] text-suc\</code>
<code class="s2">cess glyphicon glyphicon-ok\"&gt;&lt;/i&gt;\n\t        &lt;span class=\"name\"&gt;"</code> <code class="o">+</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code><code class="o">\</code>
 <code class="o">+</code> <code class="s2">"&lt;/span&gt;\n\t    &lt;/div&gt;\n\t"</code><code class="p">;</code>
</pre></div>

</figure>

<p>Once again, inspecting the compiled JavaScript reveals that - even with inline conditional statements and everything - this syntax eventually just ends up as a series of concatenated strings and expressions.  </p>

<p>Nonetheless, string templates remains one of my favorite ECMAScript 2015 features:  I find myself using it more every day, and I expect you will, too.</p>

<div class="page-break"></div>
<h3 id="let-and-const">Let and const</h3>

<p>In this section, I’m going to introduce you to two more ways to declare variables in addition to using the <code>var</code> keyword: <strong>the <code>let</code> and <code>const</code> keywords</strong>.  </p>

<p>In order to really appreciate the value of the <code>let</code> and <code>const</code> keywords, it’s important to really understand how the <code>var</code> keyword works and how it has a few undesirable behaviors that can be really troublesome to JavaScript developers.  </p>

<p>To demonstrate, take a look at this simple for loop which creates a variable inside the for loop scope, then tries to access that variable outside of the scope:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">x</code> <code class="o">&lt;=</code> <code class="mi">5</code><code class="p">;</code> <code class="nx">x</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">counter</code> <code class="o">=</code> <code class="nx">x</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">counter</code><code class="p">);</code>
</pre></div>

</figure>

<p>If I execute this code in the browser, I can see that prints out the value of the variable “counter” and guess what - it works because I can see the number 5 printed to the console!  </p>

<p>If you come from a language such as Java or C# or many other similar languages, you’d think this was crazy because you’d expect that everything in that for loop - everything inside those brackets - would be contained in its own scope so that it couldn’t be accessed by the outside.  As this demo illustrates, that’s clearly not the case in JavaScript.</p>

<p>Now let’s replace the <code>var</code> keyword with the <code>let</code> keyword instead:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">x</code> <code class="o">&lt;=</code> <code class="mi">5</code><code class="p">;</code> <code class="nx">x</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">counter</code> <code class="o">=</code> <code class="nx">x</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">counter</code><code class="p">);</code>
</pre></div>

</figure>

<p>With this change, the editor immediately alerts us to the error on that last line that references the counter variable, telling us that it can’t find a variable named <code>counter</code>.   What’s more, if you executed this code in a browser using strict mode, you’d actually get an error at runtime in your browser that the counter variable is not defined – all of this exactly what you’d expect if you’re used to the block scope in languages other than JavaScript.</p>

<p>Where can you use the <code>let</code> keyword?  Well, you can - and you should - feel free to use the <code>let</code> keyword pretty much anywhere that you’re currently used to using the var keyword today.  Everywhere, of course, except the places where you’re actually depending on JavaScript’s interesting behavior that I just demonstrated… but if you’re doing that, you might want to rethink that approach, too!</p>

<p>Now that you’ve seen the <code>let</code> keyword in action, let’s take a look at its sibling, <code>const</code>.  As you might expect if you’ve used this keyword in other languages such as C#, the <code>const</code> keyword means to create a variable and initialize it to a certain value, then never let that value change.</p>

<p>To demonstrate, I’ll change the <code>let</code> keyword from the previous example to <code>const</code> instead.  Everything continues to behave as before (including the fact that the <code>counter</code> variable is not accessible outside of the <code>for</code> loop).</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">x</code> <code class="o">&lt;</code> <code class="mi">5</code><code class="p">;</code> <code class="nx">x</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="kr">const</code> <code class="nx">counter</code> <code class="o">=</code> <code class="nx">x</code><code class="p">;</code>
    <code class="nx">counter</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, if I try to assign the <code>counter</code> variable to another value, the editor yells at me and tells me I can’t do that.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">x</code> <code class="o">&lt;</code> <code class="mi">5</code><code class="p">;</code> <code class="nx">x</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="kr">const</code> <code class="nx">counter</code> <code class="o">=</code> <code class="nx">x</code><code class="p">;</code>
    <code class="nx">counter</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Likewise, if I choose to ignore the editor warning and run this code in the browser in strict mode, the browser will give me a runtime exception that I can’t assign a value to a constant variable after it’s been initialized.</p>

<p>The way that JavaScript deals with variables has always been a sticking point with a lot of developers and it’s certainly been the source of plenty of bugs in my development career.  But now that we have keywords such as <code>let</code> and <code>const</code> at our disposable, we can use them to better express our real intent and these bugs will certainly become a thing of past.</p>

<div class="page-break"></div>
<h3 id="leanpub-auto-forof-loops">For..of Loops</h3>

<p>In this section I’m going to show you a concise new way to loop over arrays of objects.  Prior to ECMAscript 2015, you had to use a clunky <code>for</code>/<code>in</code> syntax in order to iterate over an array.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="lineno">1 </code><code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>  <code class="s2">"Clean Batcave"</code><code class="p">,</code> <code class="s2">"Save Gotham"</code> <code class="p">];</code>
<code class="lineno">2 </code>
<code class="lineno">3 </code><code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">index</code> <code class="k">in</code> <code class="nx">array</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">4 </code>    <code class="kd">var</code> <code class="nx">value</code> <code class="o">=</code> <code class="nx">array</code><code class="p">[</code><code class="nx">index</code><code class="p">];</code>
<code class="lineno">5 </code>    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">index</code><code class="si">}</code><code class="sb">: </code><code class="si">${</code><code class="nx">value</code><code class="si">}</code><code class="sb">`</code><code class="p">);</code>
<code class="lineno">6 </code><code class="p">}</code>
</pre></div>

</figure>

<p>As this example shows, when you use the <code>for</code>/<code>in</code> keywords to iterate over an array, you’re actually iterating over the index values - in other words, 0, 1, 2, etc.  So, in order to actually get the values out of the array you need to use those indexes to reference that values in the array.  </p>

<p>That’s what’s happening in line 4 of this example - I’m using the <code>index</code> to grab the value out of that index in the array.<br>
Then on line 5 I log the value to the console.</p>

<p>Running this in a browser helps to see what’s going on a little better:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="mi">0</code><code class="o">:</code> <code class="nx">Pick</code> <code class="nx">up</code> <code class="nx">drycleaning</code>
<code class="mi">1</code><code class="o">:</code> <code class="nx">Clean</code> <code class="nx">Batcave</code>
<code class="mi">2</code><code class="o">:</code> <code class="nx">Save</code> <code class="nx">Gotham</code>
</pre></div>

</figure>

<p>That’s the <code>for</code>/<code>in</code> keyword - the new feature in ECMAscript 2015 is <code>for</code>/<strong><code>of</code></strong>, which iterates over the values of the array directly and cuts out the middle man.  Here’s that same example using the <code>for</code>/<code>of</code> syntax:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code>
    <code class="s2">"Pick up drycleaning"</code><code class="p">,</code> 
    <code class="s2">"Clean Batcave"</code><code class="p">,</code> 
    <code class="s2">"Save Gotham"</code>
<code class="p">];</code>

<code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">value</code> <code class="k">of</code> <code class="nx">array</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>If I run this snippet in the browser, I can see that it just prints out all of the values without having use the index to pull them out of the array.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">Pick</code> <code class="nx">up</code> <code class="nx">drycleaning</code>
<code class="nx">Clean</code> <code class="nx">Batcave</code>
<code class="nx">Save</code> <code class="nx">Gotham</code>
</pre></div>

</figure>

<p>The <code>for</code>/<code>of</code> syntax is just one more example of syntactic sugar: since you always had the <code>for</code>/<code>in</code> syntax at your disposal and it doesn’t allow you to do anything that you couldn’t do before, but it does allow you to write cleaner, more concise code and over time may save you plenty of lines of code in your application.</p>

<div class="page-break"></div>
<h3 id="arrow-functions">Arrow Functions</h3>

<p>In the <a href="https://leanpub.com/essentialtypescript/read#let-and-const">“let and const” section</a> I showed you how JavaScript can have some wacky behavior when it comes to dealing with variables and their scope.  However, there is perhaps no wackier behavior in JavaScript than the <code>this</code> keyword.  Rather than give a big long technical explanation as to why, let me just show you an example in which the <code>this</code> keyword introduces some unexpected behavior:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="lineno"> 1 </code><code class="kd">var</code> <code class="nx">container</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'container'</code><code class="p">);</code>
<code class="lineno"> 2 </code>
<code class="lineno"> 3 </code><code class="kd">function</code> <code class="nx">Counter</code><code class="p">(</code><code class="nx">el</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno"> 4 </code>
<code class="lineno"> 5 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">count</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
<code class="lineno"> 6 </code>
<code class="lineno"> 7 </code>    <code class="nx">el</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">count</code><code class="p">;</code>
<code class="lineno"> 8 </code>
<code class="lineno"> 9 </code>    <code class="nx">el</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> 
<code class="lineno">10 </code>        <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
<code class="lineno">11 </code>            <code class="k">this</code><code class="p">.</code><code class="nx">count</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
<code class="lineno">12 </code>            <code class="nx">el</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">count</code><code class="p">;</code>
<code class="lineno">13 </code>        <code class="p">})</code>
<code class="lineno">14 </code><code class="p">}</code>
<code class="lineno">15 </code>
<code class="lineno">16 </code><code class="k">new</code> <code class="nx">Counter</code><code class="p">(</code><code class="nx">container</code><code class="p">);</code>
</pre></div>

</figure>

<p>This snippet looks a little long, but really all it does is executes the function on line 10 which increments the counter every time the user clicks the element by incrementing the field “this.count” on line 11.</p>

<p>Just by looking at this example, I’d expect that the count would start at 0, and then every time I clicked on the element, it’d add one more to the count:  1, 2, 3, and so on.  But, I have a little surprise for you.  Let’s switch to the command line and execute the “lite-server” command to run our site in a browser and try it out…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">lite</code><code class="o">-</code><code class="nx">server</code>
</pre></div>

</figure>

<p>When the browser opens, I can see the value <code>0</code> printed.  So far, so good…  But, if I click…</p>


<figure class="image floatleft">
  <img src="./Read Essential TypeScript _ Leanpub_files/ECMAScript----closure-fail.png" alt="Closure fail">
  <figcaption>Closure fail</figcaption>
</figure>


<p>Now I see <code>NaN</code> which means that the value has been lost!</p>

<p>Long story short, the reason that the value got lost is because of the call to <code>this.count</code> on line 11.  Even though it looks like <code>this.count</code> refers to the <code>Counter</code> object that this function lives in, when it’s executed as an event handler for a browser click event, the <code>this</code> keyword actually refers to the global browser scope, which is definitely not the same thing.</p>

<p>If you’re like me, this scenario has caused you many headaches in the past. And, the way you need to work around it is to first save a reference to the <code>this</code> object outside of the function where you still have access to it, and then reference that temporary variable instead of the <code>this</code> keyword inside of the function, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">_this</code> <code class="o">=</code> <code class="k">this</code><code class="p">;</code>

<code class="nx">el</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> 
    <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
        <code class="nx">_this</code><code class="p">.</code><code class="nx">count</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
        <code class="nx">el</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="nx">_this</code><code class="p">.</code><code class="nx">count</code><code class="p">;</code>
    <code class="p">})</code>
</pre></div>

</figure>

<p>Now, this works, but personally I’ve always hated this approach because it just seems awkward and unnecessary to save a reference to <code>this</code> just to be able to access it later on.  </p>

<p>Luckily, ECMAscript 2015 introduces a great new feature called <strong>arrow functions</strong> to help address this very problem, and the syntax of this feature is actually really simple and it may even be familiar to you already.</p>

<p>If you’ve used other languages such as C# and Java, you’ve probably already used an arrow function before – in those languages they’re called “lambda expressions”.</p>

<p>You can convert pretty much any JavaScript function into an arrow function by simply removing the <code>function</code> keyword from the front and then inserting “equals, greater-than” (or “arrow”, hence the name of the feature) after the parameter list.  And.. That’s it!</p>

<p>So, if I undo the ugly hack that I just introduced, I can rewrite the same code like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">el</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> 
    <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">count</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
        <code class="nx">el</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">count</code><code class="p">;</code>
    <code class="p">})</code>
</pre></div>

</figure>

<p>And if I look at the generated JavaScript I can see that it’s actually creating that ugly “_this” variable for me in the background to create ES5-compatible JavaScript.</p>

<p>Now when I run this code in the browser and click on the DOM element, I can see that the counter is incremented, meaning that the call to “this.count” actually points to the variable that I expect it to.</p>

<p>Fixing the reference to the <code>this</code> keyword is the only functional change that this syntax provides, but it does offer a little more syntactic sugar as well.</p>

<p>For example, this example doesn’t require it, but if I wanted to pass in parameters to the function, I can just put them in the parentheses - just like a normal function signature, only without the “function” keyword.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">el</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> 
    <code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">count</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
        <code class="nx">el</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">count</code><code class="p">;</code>
    <code class="p">})</code>
</pre></div>

</figure>

<p>And - even better - if the body of my arrow function had only one expression, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">el</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> 
    <code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>
        <code class="nx">el</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">count</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">);</code>
    <code class="p">})</code>
</pre></div>

</figure>

<p>I could do away with the brackets entirely and just execute that one expression inline.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">el</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">el</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">count</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">))</code>
</pre></div>

</figure>

<p>Now, isn’t that nice and concise?</p>

<p>Note that arrow functions expressions written in this way actually return the output of the expression.  In other words, let’s say I wanted to loop through an array of items using the Array.filter() method.  </p>

<p>I could write the arrow function across multiple lines like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">filtered</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code> <code class="p">].</code><code class="nx">filter</code><code class="p">((</code><code class="nx">x</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">x</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">;</code>
<code class="p">});</code>
</pre></div>

</figure>

<p>Or, get rid of the “return” keyword and just compact it into one expression, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">filtered</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code> <code class="p">].</code><code class="nx">filter</code><code class="p">((</code><code class="nx">x</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">x</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">);</code>
</pre></div>

</figure>

<p>Also note that in this case - when the arrow function accepts only one parameter - I can even omit the parentheses around the parameter name:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">filtered</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code> <code class="p">].</code><code class="nx">filter</code><code class="p">(</code><code class="nx">x</code> <code class="o">=&gt;</code> <code class="nx">x</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">);</code>
</pre></div>

</figure>

<p>I don’t know about you, but I like that syntax a whole lot more than the verbose alternative.
In fact, I mentioned earlier in the chapter that template strings were my favorite ECMAscript 2015 feature, but actually I’m not too sure, because I really love arrow functions.   And I’m willing to bet that once you’ve used them for a while you’ll love them, too!</p>

<div class="page-break"></div>
<h3 id="destructuring">Destructuring</h3>

<p>In this chapter I’ve been demonstrating all of the language features that are new in ECMAScript 2015.  The features I’ve shown so far - features such as arrow functions and string templates - are the ones that I use on a regular basis in just about any TypeScript file that I work in.  The last few features I’m about to show, however, I tend to use a whole lot less (if at all) and I expect that you’ll have the same limited need for them as I do.  Nevertheless, the language offers them, so it’s probably worth your time to learn them for the occasions that they may be useful to you.</p>

<p>The first of these features is something called <strong>destructuring</strong>, which is the ability to assign values to multiple variables from a single object with a single statement.  The easiest way to think of destructuring is that it is the reverse of creating a bunch of variables and combining them into an array.</p>

<p>In its simplest form, destructuring looks like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code><code class="mi">123</code><code class="p">,</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code> <code class="kc">false</code><code class="p">];</code>
<code class="kd">var</code> <code class="p">[</code><code class="nx">id</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">completed</code><code class="p">]</code> <code class="o">=</code> <code class="nx">array</code><code class="p">;</code> 
</pre></div>

</figure>

<p>Destructuring is the thing that happens in line 2, where we assign the values of the variables <code>id</code>, <code>title</code>, and <code>completed</code> all at once using the values contained in the array.  The first value in the array gets assigned to the first variable, the second value to the second variable, etc. </p>

<p>It’s actually a lot easy to understand if you just take a look at the generated JavaScript to see exactly what this translates to:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code><code class="mi">123</code><code class="p">,</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code> <code class="kc">false</code><code class="p">];</code>
<code class="kd">var</code> <code class="nx">id</code> <code class="o">=</code> <code class="nx">array</code><code class="p">[</code><code class="mi">0</code><code class="p">],</code> <code class="nx">title</code><code class="o">=</code> <code class="nx">array</code><code class="p">[</code><code class="mi">1</code><code class="p">],</code> <code class="nx">completed</code> <code class="o">=</code> <code class="nx">array</code><code class="p">[</code><code class="mi">2</code><code class="p">];</code>
</pre></div>

</figure>

<p>That means that if I were to execute this code in a browser:</p>

<ul>
  <li>the variable <code>id</code> would contain the value <code>123</code>
</li>
  <li>the variable <code>title</code> would contain the value <code>"Pick up drycleaning"</code>
</li>
  <li>And the variable <code>completed</code> would contain the value <code>false</code>
</li>
</ul>

<p>The benefits of this syntax might not be immediately obvious with this example, so let me show one example where the destructuring syntax is a little bit cleaner than the ES5 alternative.</p>

<p>Let’s say that you have two variables, “a” and “b” and you want to flip their values.  Using ES5, You can’t just assign the value of variable “b” to variable “a” because you’d lose the value of variable “a” in the process.  So, you’d have to introduce a third temporary value like so:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">a</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
<code class="kd">var</code> <code class="nx">b</code> <code class="o">=</code> <code class="mi">5</code><code class="p">;</code>

<code class="kd">var</code> <code class="nx">temp</code> <code class="o">=</code> <code class="nx">a</code><code class="p">;</code>
<code class="nx">a</code> <code class="o">=</code> <code class="nx">b</code><code class="p">;</code>
<code class="nx">b</code> <code class="o">=</code> <code class="nx">temp</code><code class="p">;</code>
</pre></div>

</figure>

<p>With destructuring, this becomes simple:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">a</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
<code class="kd">var</code> <code class="nx">b</code> <code class="o">=</code> <code class="mi">5</code><code class="p">;</code>

<code class="p">[</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="nx">b</code><code class="p">,</code> <code class="nx">a</code><code class="p">];</code>
</pre></div>

</figure>

<p>Destructuring doesn’t just work on arrays - it actually works with objects as well, although with a slightly different syntax.  In the case of objects, the values aren’t assigned by their location in the object, but by matching the name of the property with the name of variable.</p>

<p>For example, let’s look at a more real-world object:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code> 
    <code class="nx">id</code><code class="o">:</code> <code class="mi">123</code><code class="p">,</code> 
    <code class="nx">title</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code> 
    <code class="nx">completed</code><code class="o">:</code> <code class="kc">false</code>
<code class="p">};</code>
</pre></div>

</figure>

<p>Given this todo object, I can easily assign its three properties - <code>id</code>, <code>title</code>, and <code>completed</code> - to variables of the same names:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="p">{</code> <code class="nx">id</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">completed</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">;</code>
</pre></div>

</figure>

<p>Looking at the generated code, you can see that this gets broken down into individual assignments, based on the variable name:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">id</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">id</code><code class="p">,</code> <code class="nx">title</code><code class="o">=</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">title</code><code class="p">,</code> <code class="nx">completed</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">completed</code><code class="p">;</code>
</pre></div>

</figure>

<p>What’s more, it doesn’t matter at all what order the properties are defined in.  I happened to assign them in the same order that they were declared on the object in this example, but that doesn’t have to be the case.  I can assign them in any order I’d like.  </p>

<p>For instance, this code will achieve the same exact outcome:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="p">{</code> <code class="nx">completed</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">id</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">;</code>
</pre></div>

</figure>

<p>And, if I try to assign a variable with a name that doesn’t match the name of a property on the object, TypeScript will yell at me.</p>

<p>For instance, if I try to assign a new variable named <code>createDate</code>…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="p">{</code> <code class="nx">completed</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">id</code><code class="p">,</code> <code class="nx">createDate</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">source</code><code class="p">;</code>  <code class="c1">// object has no property "c\</code>
<code class="nx">reateDate</code><code class="err">"</code>
</pre></div>

</figure>

<p>TypeScript will tell me that the object doesn’t have a property called “createDate”.</p>

<p>Note that TypeScript will still generate the code anyway, just as it would if it were an ECMAScript 2015 compiler without any type information:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">id</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">id</code><code class="p">,</code> <code class="nx">title</code><code class="o">=</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">title</code><code class="p">,</code> <code class="nx">completed</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">completed</code><code class="p">,</code> <code class="nx">createDate</code><code class="o">=</code> <code class="nx">tod</code><code class="o">\</code>
<code class="nx">o</code><code class="p">.</code><code class="nx">createDate</code><code class="p">;</code>
</pre></div>

</figure>

<p>And here’s a another cool thing about destructuring:  it even works when mapping function return values.  In other words, all of the examples I’ve shown have involved declaring an object and that pulling values from that object, but that object could just as well be the result of a function call rather than a declared object.</p>

<p>For example, if I wrap that <code>todo</code> object in a function and return it from that function like this…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">getTodo</code><code class="p">(</code><code class="nx">id</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="p">{</code> 
	    <code class="nx">id</code><code class="o">:</code> <code class="mi">123</code><code class="p">,</code> 
	    <code class="nx">title</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code> 
	    <code class="nx">completed</code><code class="o">:</code> <code class="kc">false</code>
	<code class="p">};</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then I can still initialize those same variables by calling that function and piping the response right into the declaration, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="p">{</code> <code class="nx">completed</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">id</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">getTodo</code><code class="p">(</code><code class="mi">123</code><code class="p">);</code>
</pre></div>

</figure>

<p>Now, you might be thinking, “That’s nice, but my variable names usually don’t line up that well!  What if I wanted to assign the property to a variable with a different name?”  Well, that’s pretty simple, too - just create a mapping from the property name that you want to pull from by adding a colon after the name of the property, then supply the name of the variable you want to map to.</p>

<p>For example, if you wanted to map the value of the property named <code>completed</code> on the source object to, say, a variable named <code>isCompleted</code>, you’d just use this syntax:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="p">{</code> <code class="nx">completed</code><code class="o">:</code> <code class="nx">isCompleted</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">id</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">getTodo</code><code class="p">(</code><code class="mi">123</code><code class="p">);</code>
</pre></div>

</figure>

<p>All of this is nice, but perhaps the most effective use of destructuring is to reduce a longs list of method parameters down into a single option that contains all of those parameters as properties instead.</p>

<p>To demonstrate, let’s revisit the <code>countdown</code> function from the <a href="https://leanpub.com/essentialtypescript/read#optional-parameters">Optional Parameters</a> section:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">countdown</code><code class="p">(</code><code class="nx">initial</code><code class="p">,</code> <code class="kr">final</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">interval</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code> <code class="p">{</code>

	<code class="kd">var</code> <code class="nx">current</code> <code class="o">=</code> <code class="nx">initial</code><code class="p">;</code>
	
	<code class="k">while</code><code class="p">(</code><code class="nx">current</code> <code class="o">&gt;</code> <code class="kr">final</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">current</code><code class="p">);</code>
		<code class="nx">current</code> <code class="o">-=</code> <code class="nx">interval</code><code class="p">;</code>
	<code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>Now, this function has only got 3 parameters, which isn’t too many, but let’s combine them all into an object anyway, just to see this approach in action.  In order to implement this approach manually, I’d have to write this code:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">countdown</code><code class="p">(</code><code class="nx">options</code><code class="p">)</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="nx">options</code> <code class="o">=</code> <code class="nx">options</code> <code class="o">===</code> <code class="kc">undefined</code> <code class="o">?</code> <code class="p">{}</code> <code class="o">:</code> <code class="nx">options</code><code class="p">,</code> 
        <code class="nx">initial</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="nx">initial</code> <code class="o">===</code> <code class="kc">undefined</code> <code class="o">?</code> <code class="mi">10</code> <code class="o">:</code> <code class="nx">options</code><code class="p">.</code><code class="nx">initial</code><code class="p">,</code>
        <code class="kr">final</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="kr">final</code> <code class="o">===</code> <code class="kc">undefined</code> <code class="o">?</code> <code class="mi">0</code> <code class="o">:</code> <code class="nx">options</code><code class="p">.</code><code class="kr">final</code><code class="p">,</code>
        <code class="nx">interval</code> <code class="o">=</code> <code class="nx">options</code><code class="p">.</code><code class="nx">interval</code> <code class="o">===</code> <code class="kc">undefined</code> <code class="o">?</code> <code class="mi">1</code> <code class="o">:</code> <code class="nx">options</code><code class="p">.</code><code class="nx">interval</code><code class="p">;</code>
        
    <code class="kd">var</code> <code class="nx">current</code> <code class="o">=</code> <code class="nx">initial</code><code class="p">;</code>
    
    <code class="k">while</code><code class="p">(</code><code class="nx">current</code> <code class="o">&gt;</code> <code class="kr">final</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">current</code><code class="p">);</code>
        <code class="nx">current</code> <code class="o">-=</code> <code class="nx">interval</code><code class="p">;</code>
    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>Notice how when I convert the parameters into an object, I keep the default values that I applied in the previous section, but I have to do it the long way, playing it safe by checking each property – and the options object itself – to see if they are defined before trying to access them.  Then, fall back to the default value if they are not defined.</p>

<p>A lot of people prefer to pass around objects rather than lists of parameters, but clearly in some cases it can make the code very unreadable!</p>

<p>Luckily, we can apply the destructuring syntax directly to the object parameter itself, allowing us to use this design pattern without having to write all of that code, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">countdown</code><code class="p">({</code> <code class="nx">initial</code><code class="p">,</code> <code class="kr">final</code><code class="p">,</code> <code class="nx">interval</code> <code class="p">})</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="nx">current</code> <code class="o">=</code> <code class="nx">initial</code><code class="p">;</code>
    
    <code class="k">while</code><code class="p">(</code><code class="nx">current</code> <code class="o">&gt;</code> <code class="kr">final</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">current</code><code class="p">);</code>
        <code class="nx">current</code> <code class="o">-=</code> <code class="nx">interval</code><code class="p">;</code>
    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>I can even pull in that <code>current</code> variable by assigning the <code>initial</code> property to two different variables: </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">countdown</code><code class="p">({</code> <code class="nx">initial</code><code class="p">,</code> <code class="kr">final</code><code class="p">,</code> <code class="nx">interval</code><code class="p">,</code> <code class="nx">initial</code><code class="o">:</code> <code class="nx">current</code> <code class="p">})</code> <code class="p">{</code>

    <code class="k">while</code><code class="p">(</code><code class="nx">current</code> <code class="o">&gt;</code> <code class="kr">final</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">current</code><code class="p">);</code>
        <code class="nx">current</code> <code class="o">-=</code> <code class="nx">interval</code><code class="p">;</code>
    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>With this in place, the only thing left to do is add those default values back into the mix, which I can do with the same syntax I used before:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">countdown</code><code class="p">({</code> <code class="nx">initial</code><code class="p">,</code> <code class="kr">final</code><code class="o">:</code> <code class="kr">final</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">interval</code><code class="o">:</code> <code class="nx">interval</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code> <code class="nx">initial</code><code class="o">:\</code>
 <code class="nx">current</code> <code class="p">})</code> <code class="p">{</code>

    <code class="k">while</code><code class="p">(</code><code class="nx">current</code> <code class="o">&gt;</code> <code class="kr">final</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">current</code><code class="p">);</code>
        <code class="nx">current</code> <code class="o">-=</code> <code class="nx">interval</code><code class="p">;</code>
    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>And there it is:  the destructuring syntax in all its glory!  Of course, while some people consider this code much easier to read and maintain than a list of parameters, others think it looks utterly horrible and wouldn’t consider using it.  Regardless of how you feel about it, it’s another tool in your ECMAscript 2015 toolbox that is there when you need it!</p>

<div class="page-break"></div>
<h3 id="spread-operator">The Spread Operator</h3>

<p>In this section I’m going to show you the <strong>spread operator</strong> - another ECMAscript 2015 function that I tend to use pretty infrequently, but in the right cases it can make some really elegant-looking code.</p>

<p>Rather than start off with the syntax that the spread operator uses, first I’ll demonstrate one of the best use cases for it:  creating a function that takes any number of arguments.  </p>

<p>To do this using ES5 syntax, you’d write a function like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">add</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">values</code> <code class="o">=</code> <code class="nb">Array</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">splice</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">arguments</code><code class="p">,</code> <code class="p">[</code><code class="mi">1</code><code class="p">]),</code>
        <code class="nx">total</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
    
    <code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">value</code> <code class="k">of</code> <code class="nx">values</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">total</code> <code class="o">+=</code> <code class="nx">value</code><code class="p">;</code>
    <code class="p">}</code>
    
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>This function accepts any number of arguments and then uses the very long-winded call to <code>Array.prototype.splice.call()</code> to convert them into an array that can then be iterated over.  </p>

<p>Other than these first few awkward lines of code, the rest of the function is actually pretty straight forward:  loop through the argument values (using the new ECMAscript 2015 <code>for</code>/<code>of</code> syntax I showed you earlier) and add them all together, then return the total.</p>

<p>I say that these lines of code are awkward for two reasons:</p>

<ol class="numeric">
  <li>It’s very long and somewhat difficult to determine at a glance why we are calling a method on the Array prototype object (by the way, it’s because the arguments object isn’t actually an array, but we can trick the <code>Array.splice</code> method to thinking it is if we call it this way)</li>
  <li>At a glance, it looks like this function doesn’t accept any arguments since the signature is empty.  Only once you actually get into the implementation do you see the reference to the <code>arguments</code> object.</li>
</ol>

<p>The spread operator offers us a solution to both of these problems.<br>
Instead of converting the argument list into an array of values and assign it to the variable called <code>values</code> within the function, we simply use the variable named <code>values</code> as the argument and then apply the spread operator - represented by three periods - in front of it, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">add</code><code class="p">(...</code><code class="nx">values</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
    
    <code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">value</code> <code class="k">of</code> <code class="nx">values</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">total</code> <code class="o">+=</code> <code class="nx">value</code><code class="p">;</code>
    <code class="p">}</code>
    
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With the spread operator in place, everything is much cleaner and we still get the original behavior of being able to pass in any number of arguments we like (including no arguments at all, in which case the array with just be empty)!</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">add</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>
</pre></div>

</figure>

<p>And, while the spread operator has to be the last argument in the list, it doesn’t have to be the only argument - we can still define other arguments in front of it, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">calculate</code><code class="p">(</code><code class="nx">action</code><code class="p">,</code> <code class="p">...</code><code class="nx">values</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
    
    <code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">value</code> <code class="k">of</code> <code class="nx">values</code><code class="p">)</code> <code class="p">{</code>
        
        <code class="k">switch</code><code class="p">(</code><code class="nx">action</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">case</code> <code class="s1">'add'</code><code class="o">:</code>
                <code class="nx">total</code> <code class="o">+=</code> <code class="nx">value</code><code class="p">;</code>
                <code class="k">break</code><code class="p">;</code>

            <code class="k">case</code> <code class="s1">'subtract'</code><code class="o">:</code>
                <code class="nx">total</code> <code class="o">-=</code> <code class="nx">value</code><code class="p">;</code>
                <code class="k">break</code><code class="p">;</code>
        <code class="p">}</code>
        
    <code class="p">}</code>
    
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Here I’ve renamed and refactored this method to handle multiple operations, depending on the value of the first argument - either <code>'add'</code> or <code>'subtract'</code>.  I can then call it like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">calculate</code><code class="p">(</code><code class="s1">'subtract'</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>
</pre></div>

</figure>

<p>Cleaning up argument lists isn’t the only thing that the spread operator is for.  You can use it to work with arrays, as well.  For instance, say you have one array:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">source</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code> <code class="p">];</code>
</pre></div>

</figure>

<p>…and you want to inject it into the middle of another array, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">target</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="cm">/* Insert here */</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">7</code> <code class="p">]</code>
</pre></div>

</figure>

<p>You can use the spread operator just as you would any other value in the array, except instead of adding one value to the target array, it will expand that source array to add all of its values, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">target</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="p">...</code><code class="nx">source</code> <code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">7</code> <code class="p">]</code>
</pre></div>

</figure>

<p>After we execute this line, the target variable will be an array populated with all the values in the order they were defined:  </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">target</code>  <code class="c1">// 1, 2, 3, 4, 5, 6, 7</code>
</pre></div>

</figure>

<p>And, just like we used the spread operator to remove a call to the splice method on the Array prototype, we can replace similar code used to concatenate two arrays together which would have been much more awkward using the ES5 syntax:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">list</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code> <code class="p">];</code>
<code class="kd">var</code> <code class="nx">toAdd</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code> <code class="p">];</code>

<code class="nb">Array</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">push</code><code class="p">.</code><code class="nx">apply</code><code class="p">(</code><code class="nx">list</code><code class="p">,</code> <code class="nx">toAdd</code><code class="p">);</code>
</pre></div>

</figure>

<p>Where we previously used the spread operator in place of the call to <code>Array.prototype.splice</code>, we can replace this call to push with a simple:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">list</code><code class="p">.</code><code class="nx">push</code><code class="p">(...</code><code class="nx">toAdd</code><code class="p">);</code>
</pre></div>

</figure>

<p>And that’s the spread operator in action!  It may not be a language feature that you use every day, but it can be a great help if you are looking to implement a method with an unlimited number of arguments or clean up code that does a lot of array manipulation.</p>

<h3 id="leanpub-auto-computed-properties">Computed Properties</h3>

<p>In this last section of the ECMAScript 2015 feature chapter, I’m going to show a new language feature that I, quite frankly, have not yet felt the need to use in my applications.  However, it is a feature that can come in quite handy if you are implementing an application that is really taking advantage of JavaScript’s dynamic nature.  This feature is called <strong>computed properties</strong> and it allows you to define a property on an object with a name that is computed dynamically at runtime.</p>

<p>To demonstrate why you might want to use a computed property, consider the following situation:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">support</code> <code class="o">=</code> <code class="p">{</code>
    <code class="s1">'os_Windows'</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'Windows'</code><code class="p">),</code>
    <code class="s1">'os_iOS'</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'iOS'</code><code class="p">),</code>
    <code class="s1">'os_Android'</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'Android'</code><code class="p">),</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">isSupported</code><code class="p">(</code><code class="nx">os</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nb">Math</code><code class="p">.</code><code class="nx">random</code><code class="p">()</code> <code class="o">&gt;=</code> <code class="mf">0.5</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>An object that defines a property for the three operating systems that the application understands - Windows, iOS, and Android - and sets the value of that property to a boolean indicating whether that operating system is supported or not.<br>
(Don’t worry about how we’re figuring out whether an OS is supported or not - it’s not important.  Let’s just say it’s not guaranteed to be the same all the time…)</p>

<p>Notice how each property is prefixed with the string “os_”.  Let’s say that this is an important convention and I want to be sure that is applied the same way to every property name.  Of course, we can’t just use string concatenation to add the prefix to the beginning of every property… but we can if we use computed properties!</p>

<p>The first thing we need to do is convert the property names into computed properties by first wrapping them in brackets like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">support</code> <code class="o">=</code> <code class="p">{</code>
    <code class="p">[</code><code class="s1">'os_Windows'</code><code class="p">]</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'Windows'</code><code class="p">),</code>
    <code class="p">[</code><code class="s1">'os_iOS'</code><code class="p">]</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'iOS'</code><code class="p">),</code>
    <code class="p">[</code><code class="s1">'os_Android'</code><code class="p">]</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'Android'</code><code class="p">),</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now that they are computed properties, we can turn them into expressions, like adding the value of the OS prefix variable to them:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">const</code> <code class="nx">osPrefix</code> <code class="o">=</code> <code class="s1">'os_'</code><code class="p">;</code> 

<code class="kd">var</code> <code class="nx">support</code> <code class="o">=</code> <code class="p">{</code>
    <code class="p">[</code><code class="nx">osPrefix</code> <code class="o">+</code> <code class="s1">'Windows'</code><code class="p">]</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'Windows'</code><code class="p">),</code>
    <code class="p">[</code><code class="nx">osPrefix</code> <code class="o">+</code> <code class="s1">'iOS'</code><code class="p">]</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'iOS'</code><code class="p">),</code>
    <code class="p">[</code><code class="nx">osPrefix</code> <code class="o">+</code> <code class="s1">'Android'</code><code class="p">]</code><code class="o">:</code> <code class="nx">isSupported</code><code class="p">(</code><code class="s1">'Android'</code><code class="p">),</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">isSupported</code><code class="p">(</code><code class="nx">os</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nb">Math</code><code class="p">.</code><code class="nx">random</code><code class="p">()</code> <code class="o">&gt;=</code> <code class="mf">0.5</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With that in place, we can run this code and inspect the <code>support</code> object to see the defined properties:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">support</code> <code class="c1">// {os_Windows: false, os_iOS: false, os_Android: true}</code>
</pre></div>

</figure>

<p>This example may seem a bit contrived because, quite frankly, the cases in which you use computed properties tend to be a bit more complex than is suitable for a simple easy-to-understand tutorial.   However, the next time you are dealing with particularly dynamic code and struggling to find the best way to create properties with dynamic names,  you may find computed properties to be quite useful in helping you do that.</p>

<p>This concludes the chapter on the new ECMAscript 2015 features that TypeScript allows you to start using now, regardless of whether or not they have been implemented in your target browsers.  TypeScript is far more than just a simple ECMAscript 2015 transpiler, however, and the real magic lies in its advanced typing system.  Check out the next chapter where I’ll show you how to take advantage of TypeScript’s powerful static type support.</p>

<h2 id="type-fundamentals">
<span class="section-number">5. </span>Type Fundamentals</h2>

<h3 id="leanpub-auto-introducing-javascript-types">Introducing JavaScript Types</h3>

<p>In the introductory chapter I explained that TypeScript brings static typing capabilities to the JavaScript language.  In this chapter I’ll show you the syntax that TypeScript uses to apply type information to your code, and even how to define the complex data structures that your application depends on.</p>

<p>Before I get into complex data structures, however, let’s just start by calling out all the types that JavaScript offers you right out of the box, since these are at the core of everything we do in JavaScript and will be the building blocks that we will use when defining our own complex types later on.</p>

<p>Though it may sound sparse, the ECMAScript 5 specification only defines six data types.  </p>

<ul>
  <li><code>boolean</code></li>
  <li><code>number</code></li>
  <li><code>string</code></li>
  <li>
<code>null</code> / <code>undefined</code>
</li>
  <li><code>object</code></li>
</ul>

<p>The first three are very popular primitive values: <code>boolean</code>, <code>number</code>, and <code>string</code>.<br>
These types are immutable, meaning once one of these values are defined, it cannot be changed.</p>

<p>Then there are two special types:  <code>null</code> and <code>undefined</code> – that’s right, JavaScript has two different ways to refer to nothing!
And, finally, there’s the type that encompasses all other JavaScript types:  <code>object</code>.  </p>

<h4 id="leanpub-auto-objects">Objects</h4>
<p>You can think of JavaScript objects as simply a dictionary of properties, identified or indexed by string keys.  And, unlike the other data types, object properties may be changed after they’re defined - you can even add new properties on the fly! </p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>"name"</code></td>
      <td><code>"Jess Chadwick"</code></td>
    </tr>
    <tr>
      <td><code>"age"</code></td>
      <td><code>21</code></td>
    </tr>
    <tr>
      <td><code>"gender"</code></td>
      <td><code>"Male"</code></td>
    </tr>
  </tbody>

</table>

<p>The fact that ES5 only defines six data types may surprise you since you’ve probably used a lot of other types such as <code>Date</code>, <code>Regex</code>, etc., but those are all just different kinds of objects.  </p>

<p>But, perhaps the most important object types are <strong>functions</strong> and <strong>arrays</strong>.</p>

<h4 id="leanpub-auto-functions">Functions</h4>
<p>Functions are regular objects in that they are a collection of properties, but the aspect that sets them apart from all other objects is that they contain logic that can be executed.  </p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Fundamentals----function-object.png" alt="Function object">
  <figcaption>Function object</figcaption>
</figure>


<p>Because of this important ability, functions play an incredibly crucial role in most any JavaScript application so we will be dedicating plenty of time throughout this book to working with functions in a strongly-typed manner.</p>

<h4 id="leanpub-auto-arrays">Arrays</h4>

<p>The other special kind of object type is an array.  Arrays are special kinds of objects containing a collection of values, with each value represented by an integer key.  </p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>"name"</code></td>
      <td><code>"Jess Chadwick"</code></td>
    </tr>
    <tr>
      <td><code>0</code></td>
      <td><code>"Pick up drycleaning"</code></td>
    </tr>
    <tr>
      <td><code>1</code></td>
      <td><code>true</code></td>
    </tr>
    <tr>
      <td><code>2</code></td>
      <td><code>1.2.3</code></td>
    </tr>
  </tbody>

</table>

<h4 id="leanpub-auto-object-prototype">Object Prototype</h4>
<p>Both functions and arrays are also enhanced with additional methods that pertain to working with functions and collections, which they receive from their <strong>prototype</strong>.  </p>

<p>If this prototype sounds important, it is.  As an object-oriented language, JavaScript offers the ability to share properties and behavior between different types through inheritance - a kind of inheritance called <strong>prototypical inheritance</strong>.  </p>

<p>Prototypical inheritance simply means that an object is defined that contain the properties and behavior to be shared, and when new instances of that type are created, JavaScript links those properties and behaviors to the new instance.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Fundamentals----prototypical-inheritance.png" alt="Prototypical inheritance">
  <figcaption>Prototypical inheritance</figcaption>
</figure>


<p>This approach to creating objects is important - and I will definitely get more into prototypes and prototypical inheritance in later chapters - but not all JavaScript objects must be created from a constructor that has a prototype.  </p>

<h4 id="leanpub-auto-object-literal">Object Literal</h4>
<p>There’s an even simpler way to define a JavaScript object called <strong>object literals</strong>.<br>
An object literal is nothing more than a way to define and instantiate an object all at the same time using a very simple and straight-forward syntax.</p>

<p>For example, here is the most basic object literal, representing a completely empty object:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="p">{</code>  <code class="p">}</code>
</pre></div>

</figure>

<p>Notice how the brackets are used to indicate the beginning and end of the object definition.
Then, we can add properties to the object by defining key/value pairs split with a colon in the middle, and those values can be any type, like so:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="p">{</code>
	<code class="nx">name</code><code class="o">:</code>  <code class="s2">"Fido"</code><code class="p">,</code>
	<code class="nx">species</code><code class="o">:</code> <code class="s2">"Dog"</code><code class="p">,</code>
	<code class="nx">age</code><code class="o">:</code>  <code class="mi">5</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>In this example, I’ve defined three different properties, and assigned them all values.<br>
I’ve also separated all of the values with both a comma and a line break, though whitespace doesn’t matter when defining object literals, which means that I could remove all the spaces and line breaks and end up with this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="p">{</code><code class="nx">name</code><code class="o">:</code><code class="s2">"Fido"</code><code class="p">,</code><code class="nx">species</code><code class="o">:</code><code class="s2">"Dog"</code><code class="p">,</code><code class="nx">age</code><code class="o">:</code><code class="mi">5</code><code class="p">}</code>
</pre></div>

</figure>

<p>Yes, it’s true that that this would be exactly the same object…  but it’s far less readable, so let’s add them back before I get a headache!</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="p">{</code>
	<code class="nx">name</code><code class="o">:</code>  <code class="s2">"Fido"</code><code class="p">,</code>
	<code class="nx">species</code><code class="o">:</code> <code class="s2">"Dog"</code><code class="p">,</code>
	<code class="nx">age</code><code class="o">:</code>  <code class="mi">5</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now that I can see the object clearly again, let’s go the next step and give this object some behavior by defining a function.  As I mentioned earlier, functions are just regular values so I can define and assign them in exactly the same way that I assign other values:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="p">{</code>
	<code class="nx">name</code><code class="o">:</code>  <code class="s2">"Fido"</code><code class="p">,</code>
	<code class="nx">species</code><code class="o">:</code> <code class="s2">"Dog"</code><code class="p">,</code>
	<code class="nx">age</code><code class="o">:</code>  <code class="mi">5</code><code class="p">,</code>
	<code class="nx">speak</code><code class="o">:</code>  <code class="kd">function</code><code class="p">()</code>  <code class="p">{</code>  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Woof!'</code><code class="p">);</code> <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Again, whitespace doesn’t matter:  I can put the whole function definition on one line, or spread it across multiple lines - it’s up to me.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="p">{</code>
	<code class="nx">name</code><code class="o">:</code>  <code class="s2">"Fido"</code><code class="p">,</code>
	<code class="nx">species</code><code class="o">:</code> <code class="s2">"Dog"</code><code class="p">,</code>
	<code class="nx">age</code><code class="o">:</code>  <code class="mi">5</code><code class="p">,</code>
	<code class="nx">speak</code><code class="o">:</code>  <code class="kd">function</code><code class="p">()</code>  <code class="p">{</code> 
		<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Woof!'</code><code class="p">);</code> 
	<code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now that I have this object, I can do things with it, like pass it to a function:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">makeTheAnimalSpeak</code><code class="p">(</code><code class="nx">animal</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">animal</code><code class="p">.</code><code class="nx">speak</code><code class="p">();</code>
    <code class="nx">animal</code><code class="p">.</code><code class="nx">speak</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">var</code> <code class="nx">animal</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code>  <code class="s2">"Fido"</code><code class="p">,</code>
    <code class="nx">species</code><code class="o">:</code> <code class="s2">"Dog"</code><code class="p">,</code>
    <code class="nx">age</code><code class="o">:</code>  <code class="mi">5</code><code class="p">,</code>
    <code class="nx">speak</code><code class="o">:</code>  <code class="kd">function</code><code class="p">()</code>  <code class="p">{</code> 
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Woof!'</code><code class="p">);</code> 
    <code class="p">}</code>
<code class="p">};</code>

<code class="nx">makeTheAnimalSpeak</code><code class="p">(</code><code class="nx">animal</code><code class="p">);</code>
</pre></div>

</figure>

<p>Notice how the function just calls the <code>speak()</code> method on the object that it’s given.  This is a great example of duck typing in action – the function doesn’t check to see if the object is a certain type, or if the method exists before calling it – it just calls the method and assumes that the code that passed the object in knew what they were doing.</p>

<p>In addition to being a great example of duck typing in action, it’s also a great example of a place where static typing can really help, and I’ll build upon this simple example throughout this book to show you how.</p>

<p>In this section, I gave you an overview of the fundamental types that JavaScript provides, and a quick demonstration of how to create, instantiate, and populate your own types on the fly using object literals.  In the next section, I’m going to talk about how TypeScript uses a concept called <strong>type inference</strong> to analyze this code just as it is to start giving you feedback and help you write better code without having to do anything more than what you see here.</p>

<div class="page-break"></div>
<h3 id="leanpub-auto-understanding-type-inference">Understanding Type Inference</h3>

<p>In the previous section, I showed you how to create, instantiate, and populate a new type of object on the fly using the object literal syntax.  In this section, I’m going to talk about how TypeScript’s powerful static analysis capabilities can give you significant insights into your code using a concept called <strong>type inference</strong>… all while still using standard JavaScript.</p>

<p>Static analysis means that - regardless of whether you explicitly define types or not - TypeScript looks through your code, doing its best to guess (or “infer”) what type any given object could be.  </p>

<p>In other words, even though this is just plain old JavaScript, just using the code that is written TypeScript is able to figure out that the type of the <code>name</code> and <code>species</code> properties are strings, the <code>age</code> property is a number, and the <code>speak</code> property is a function.  Heck, it even knows that the <code>animal</code> variable is a type that has 4 properties: <code>name</code>, <code>species</code>, <code>age</code>, and <code>speak</code>!  It knows all of this because it can inspect the assignment of each of these properties to see what type of value was assigned to them.</p>

<p>Even though I never asked it to, TypeScript will even start to enforce these inferred types, yelling at me if I try to set the <code>name</code> property (which is a string) to a number value.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">animal</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code>  <code class="s2">"Fido"</code><code class="p">,</code>
    <code class="nx">species</code><code class="o">:</code> <code class="s2">"Dog"</code><code class="p">,</code>
    <code class="nx">age</code><code class="o">:</code>  <code class="mi">5</code><code class="p">,</code>
    <code class="nx">speak</code><code class="o">:</code>  <code class="kd">function</code><code class="p">()</code>  <code class="p">{</code> 
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Woof!'</code><code class="p">);</code> 
    <code class="p">}</code>
<code class="p">};</code>

<code class="nx">animal</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
</pre></div>

</figure>

<p>The same thing goes for return types, too.  If I create a function that returns a value with a type that TypeScript can determine through static analysis - such as a string, a number, or even an object literal - TypeScript can use that information wherever that return value is used.</p>

<p>For example, let’s say I add a function to calculate the animal’s current age by subtracting the year it was born from the current year:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">calculateAge</code><code class="p">(</code><code class="nx">birthYear</code><code class="p">)</code> <code class="p">{</code>
	<code class="k">return</code> <code class="nb">Date</code><code class="p">.</code><code class="nx">now</code><code class="p">()</code> <code class="o">-</code> <code class="nx">birthYear</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>When I hover over the method, I can see that TypeScript has figured out that the type of the return value will be a number.  What’s more, it’s figuring that out regardless of the fact that I didn’t specify the type of the <code>birthYear</code> parameter!<br>
TypeScript is smart enough to know that the result of <code>Date.now()</code> is a number, and any time you subtract something from a number, you’re going to get a number.</p>

<p>Likewise, I can change the assignment of the <code>age</code> property to call this function instead: </p>

<figure class="code">
<div class="highlight"><pre><code class="udl">    age:  5,
</code><code class="uil">	age:  calculateAge(2010),
</code></pre></div>

</figure>

<p>And, when I do, I can hover over the property to see that TypeScript is assigning the number type from the function’s return type.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Fundamentals----type-inference.png" alt="Type inference in action">
  <figcaption>Type inference in action</figcaption>
</figure>


<p>Now think about the effect this would have if this function were called by many other places throughout the code.  Knowing the return type of this code would allow TypeScript to make better inferences about the code that calls this function, which may then trickle into the code that calls those functions, and so on.</p>

<p>Because of this, strategically applying type information to common, low-level functions and API calls is a great way to start getting the most out of TypeScript’s type inference in your existing JavaScript codebase without having to write any TypeScript-specific code.</p>

<p>While TypeScript’s ability to infer types may be impressive, it does have its limits.<br>
For example, look at this function which takes in two parameters and adds the value of their length properties. </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="p">,</code> <code class="nx">y</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> 
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Since every object has a length property that is a number value, this function should work with pretty much any inputs and return a number every time.  However, even though we can understand it relatively easily, TypeScript has no idea what to do with it.</p>

<p>Whenever this situation occurs – whenever TypeScript doesn’t have enough information to definitively figure out what the type of a given object is – it simply gives up and says that it’s the most unrestrictive type of all:  the <code>any</code> type.</p>

<p>The <code>any</code> type is the most dynamic and unrestrictive type available - in other words, the default dynamic type behavior of JavaScript-  and that means that anything goes:  you can call it as a function, set its value to one type, and then go ahead and set that same object to a value of another type.</p>

<p>Working with dynamic types like this can be quite powerful - in fact, it’s one of the reasons that so many people love JavaScript.  However, whenever you switch into the <code>any</code> mode, you lose any and all help that TypeScript provides by enforcing types in your code, even something as common as the <code>length</code> property.  </p>

<p>That means that TypeScript isn’t even able to offer us even the most basic static typing protection to warn me if I spell a property name like <code>length</code> wrong:</p>

<figure class="code">
<div class="highlight"><pre><code class="udl">    var total = x.length + y.length;
</code><code class="uil">    var total = x.length + y.lengt;
</code></pre></div>

</figure>

<p>Sometimes a truly dynamic object may be what you want, but it’s important to keep in mind that TypeScript’s type checking exists to help you avoid mistakes in your code so most of the time you’re going to want to work with TypeScript to give it the information it needs and avoid the <code>any</code> type as much as possible.  Reserving the any type only for cases when you’re actually working with a dynamic object will make your life much easier.</p>

<p>In this section, I showed how to leverage TypeScript’s type inference to help you write better JavaScript without introducing any TypeScript syntax, but we ended up in a situation where TypeScript didn’t have enough information to safely infer the type of an object and needed a little more help.  In the next section, I’ll show you how to give TypeScript the information it needs </p>

<div class="page-break"></div>
<h3 id="leanpub-auto-specifying-javascript-types">Specifying JavaScript Types</h3>

<p>In the previous few sections I introduced you to the handful of primitive types that JavaScript offers out of the box and how TypeScript is able to figure out which type a variable is just by inspecting how you use it.  At the end of the last section, I also showed you that TypeScript is only so smart and can’t always figure out variable types without a little help.  In this section I’ll show you how to clear up the confusion by explicitly defining the type of variables, function parameters, and return values to take most of the guessing out of the way and give TypeScript all the information it needs to figure out the type of every object in your application.</p>

<p>Let’s start off where we left in the last section, with this method, complete with the spelling error that I left it with:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="p">,</code> <code class="nx">y</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">lengt</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>First I’ll tackle that misspelling by specifying the type of the <code>y</code> parameter.  I’ll specify the type by adding a colon after the parameter followed by the name of the type.  For this example, I’ll say it’s a string:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">lengt</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>As soon as I do that, TypeScript finally has enough information to notice that I have a mistake in my property name and let me know by highlighting it as an error.  Now I can fix that and keep applying my type information.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">total</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
</pre></div>

</figure>

<p>Since I’ve already shown you how to define the type of a parameter, I’m going to hold off on giving the <code>x</code> parameter a type – plus for now I want to keep the <code>x</code> parameter as an any type so that TypeScript still doesn’t know anything about it.  </p>

<p>I want to leave it as the <code>any</code> type to show you that if I hover over the <code>total</code> variable I see that TypeScript is telling me the <code>total</code> variable has the type <code>any</code> as well.  In other words, even though TypeScript now knows for a fact that the <code>y.length</code> property is a number type, because the <code>x</code> parameter is the <code>any</code> type, TypeScript has no idea what its properties are and can’t validate that the <code>length</code> property even exists, let alone what its type is.  So, it just completely gives up and says that the whole equation returns a value of the <code>any</code> type.</p>

<p>Here’s where I need to step in and give TypeScript enough information that it stops giving up and starts helping me again.
Since I happen to know that the total variable is a number type, I’ve got two options here:  </p>

<ol class="numeric">
  <li>I can specify type information for the <code>x</code> parameter so that TypeScript knows that the <code>length</code> property is a number, just like I did with the <code>y</code> parameter…  or…</li>
  <li>I can explictly tell TypeScript that the <code>total</code> variable is a number type by applying that same type syntax to the variable declaration itself, like this:</li>
</ol>

<figure class="code">
<div class="highlight"><pre>function totalLength(x, y: string) {
<code class="udl">    var total = x.length + y.length;
</code><code class="uil">    var total: number = x.length + y.length;
</code>    return total;
}
</pre></div>

</figure>

<p>In this case, I’m telling TypeScript:  “Don’t worry, I know that this equation will return a number, so just go ahead and enforce that from now on.</p>

<p>Something else interesting happens now, too.  If I hover over the function signature, I can see that TypeScript has used its type inference to figure out that the function’s return type is indeed a number.  Now, that happens to be true, but what if I wanted to change that?  What if I wanted to explictly say that this function returned, say, a string instead of a number?</p>

<p>Well, that’s easy, too:  just apply the same type syntax to the function itself, right after the parentheses holding the function arguments:</p>

<figure class="code">
<div class="highlight"><pre><code class="udl">function totalLength(x, y: string) {
</code><code class="uil">function totalLength(x, y: string): string {
</code>    var total: number = x.length + y.length;
    return total;
}
</pre></div>

</figure>

<p>Of course, as soon as I do that, TypeScript now highlights the return statement, yelling at me that I’m returning a number instead of string – and that’s a good thing, because it’s wrong!  So, let’s go ahead and fix that by specifying the return type as a number instead of string, like it’s supposed to be:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>You might be wondering why I am choosing to explicitly declare the function’s return type even though TypeScript is smart enough to figure it out.  That’s a good question, and the answer comes back to one of the primary reasons for using static types at all: the more explicit you are in your intent, the better the type system can help you find mistakes!  </p>

<p>Yes, this method happens to return a number now, but if I come back later and change the code to return a string instead of a number, I will still have that check in place so that TypeScript can warn me that the code I just wrote doesn’t match how I originally said the function should behave.  Maybe I meant to change the type, or maybe I did it on accident - either way, TypeScript has notified me of the mismatch and I can then decide how to resolve it.</p>

<p>And, speaking of being explicit, let’s wrap up this example by giving the <code>x</code> argument a type, too.  This time, though, I’m going to get a little crazy and say that I expect the <code>x</code> argument to be an array of objects.  Since I’m only interested in the length of the array, I don’t really care what values are in the array, as long as its an array… in other words, an array of <code>any</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">any</code><code class="p">[],</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With that in place, I’ve now explicitly defined all of the types on my function, including its return value, which should help keep me from adding bugs later on as well as help me to consume this method in the rest of my application.</p>

<p>Now, if you’re scratching your head right now wondering why I’d make a method like this at all – a method that takes one array parameter and one string parameter and adds their lengths together – I don’t blame you.  In the next section, I’ll show you how to use union types to allow either of the arguments to accept a string or an array.</p>

<div class="page-break"></div>
<h3 id="leanpub-auto-union-types">Union Types</h3>

<p>In the previous section, I showed you how to add type information to a function and ended up with the following function that takes two arguments - an array and a string - and adds their lengths together.  I also mentioned that it’s kind of weird that the first argument <em>must</em> be an array and the second <em>must</em> be a string.  In this section, I’m going to show you how to use a TypeScript feature called <strong>union types</strong> to allow each of the arguments to accept either a string or an array.</p>

<p>To specify a union type, you simply wrap the type definition in parenthesis and use the pipe operator (also sometimes known as the OR operator) to list additional types that are acceptable.  </p>

<p>For example, I want the function I’ve been working on to allow the x and y arguments to accept either a string or an array, and I’ll do that with this syntax:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]),</code> <code class="nx">y</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]))</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Since the string type and the array type both have a <code>length</code> property, my code continues to be perfectly valid.  In fact, the string type and the array type happen to share a couple of members, and TypeScript gladly offers them as autocomplete options:</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Fundamentals----union-types-autocomplete.png" alt="Autocomplete options on union types">
  <figcaption>Autocomplete options on union types</figcaption>
</figure>


<p>If, however, I attempt to access a member that only belongs to one type or the other TypeScript will yell at me, telling me that I can’t access the member because doesn’t exist on both types:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]),</code> <code class="nx">y</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]))</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    
    <code class="nx">x</code><code class="p">.</code><code class="nx">slice</code><code class="p">(</code><code class="mi">0</code><code class="p">);</code> <code class="c1">// Works fine!</code>
    <code class="nx">x</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="s1">'abc'</code><code class="p">);</code> <code class="c1">// Error: only exists on arrays</code>
    <code class="nx">x</code><code class="p">.</code><code class="nx">substr</code><code class="p">(</code><code class="mi">1</code><code class="p">);</code> <code class="c1">// Error: only exists on strings</code>
    
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>This is fine for our example, but let’s say that I really do want to be able to treat each variable differently depending on which type it is.  In other words, it’s nice that I can add up the total of the length property, or even call slice, but what if I want to be able to push a value onto an array if it’s an array type or get the substring of a string if it is the string type.  </p>

<p>Luckily, TypeScript is smart enough to handle that too - just use the built-in JavaScript keyword <code>instanceof</code> to test the variable’s type, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code> <code class="k">if</code><code class="p">(</code><code class="nx">x</code> <code class="k">instanceof</code> <code class="nb">Array</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">x</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="s1">'abc'</code><code class="p">);</code> <code class="c1">// Works, because we know x is an array!</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>After doing that, TypeScript knows that in order to make it into the if block, the object had to be an Array so TypeScript lets you treat it like an array.  This is known as the <strong>type guard</strong> syntax.</p>

<p>Once I exit the if block and am outside of the scope and safety of the type guard, TypeScript can no longer guarantee the variable’s type, so I’m back to only being able to access the members that both union types share.</p>

<p>I can also do the same thing with the string type:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">if</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">x</code> <code class="o">===</code> <code class="s1">'string'</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">x</code><code class="p">.</code><code class="nx">substr</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code> <code class="c1">// Works, because we know it's a string!</code>
<code class="p">}</code> 
</pre></div>

</figure>

<p>Notice how in this case I had to use the <code>typeof</code> operator and match it against the type name <code>string</code>.  That’s because <code>string</code> is a primitive type and this syntax is only reserved for the couple of primitive types.  You’ll almost always use the <code>instanceof</code> operator.</p>

<p>TypeScript’s Union Types and Type Guard syntax can be really helpful in creating flexible and forgiving functions and variables that let you take advantage of JavaScript’s dynamic nature while not completely giving up the safety of static typing.  It may not be a feature you end up using a lot, but when you come across a situation where you want to be able to accept multiple different types in the same variable, it can be a great fit.</p>

<div class="page-break"></div>
<h3 id="leanpub-auto-function-overloads">Function Overloads</h3>

<p>In the previous section, I showed you how to use union types to give the option for consumers of a function to pass in several different types for a given property, but I ended by complaining that in some cases union types aren’t restrictive enough.</p>

<p>In other words, I’ve got two parameters -  <code>x</code> and <code>y</code> - and each of them can accept a string or an array.  However - even though this happens to work because they both share a <code>length</code> property - it really doesn’t make sense to add the length of a string to the length of an array.  What I really want to do is expose two different signatures for this method: one that allows you to pass in two strings, and one that allows you to pass two arrays.</p>

<p>If you’ve got experience with a statically-typed language like C# or Java, you’d probably implement this using multiple different signatures of the function sharing the same name;  in other words, you’d create an overloaded function that might look something like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">any</code><code class="p">[],</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">any</code><code class="p">[])</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>TypeScript also supports the idea of overloaded functions, but not in the same way that these other languages do.  In languages like C# and Java you’d implement two completely different functions and you’d associate them together simply by giving them the same name.  </p>

<p>But, this just simply won’t work in JavaScript because if you wrote the example I just did, the second definition of the <code>totalLength</code> function would simply overwrite the first definition!</p>

<p>So, in JavaScript we can only have one single implementation of a function:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]),</code> <code class="nx">y</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]))</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>

    <code class="k">if</code><code class="p">(</code><code class="nx">x</code> <code class="k">instanceof</code> <code class="nb">Array</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">x</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="s1">'abc'</code><code class="p">);</code> <code class="c1">// Works, because we know x is an array!</code>
    <code class="p">}</code>

    <code class="k">if</code><code class="p">(</code><code class="nx">x</code> <code class="k">instanceof</code> <code class="nb">String</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">x</code><code class="p">.</code><code class="nx">substr</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code> <code class="c1">// Works, because we know it's a string!</code>
    <code class="p">}</code> 

    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>The way that TypeScript allows us to define overloaded functions is to simply add the alternate signatures that we want to expose right on top of the actual function implementation, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">number</code>
<code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">any</code><code class="p">[],</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">any</code><code class="p">[])</code><code class="o">:</code> <code class="nx">number</code>
<code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]),</code> <code class="nx">y</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]))</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>

    <code class="k">if</code><code class="p">(</code><code class="nx">x</code> <code class="k">instanceof</code> <code class="nb">Array</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">x</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="s1">'abc'</code><code class="p">);</code> <code class="c1">// Works, because we know x is an array!</code>
    <code class="p">}</code>

    <code class="k">if</code><code class="p">(</code><code class="nx">x</code> <code class="k">instanceof</code> <code class="nb">String</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">x</code><code class="p">.</code><code class="nx">substr</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code> <code class="c1">// Works, because we know it's a string!</code>
    <code class="p">}</code> 

    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Notice that I haven’t changed the underlying implementation at all - it still accepts either a string or an array for either parameter and its logic still works exactly the same.  The only difference is that when I attempt to consume this function…</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Fundamentals----function-overload-intellisense.png" alt="Overloaded function auto-complete">
  <figcaption>Overloaded function auto-complete</figcaption>
</figure>


<p>I only see the two overload signatures that allow me to pass two strings or two arrays, but TypeScript does not show me the option to call the underlying function that takes both a string and an array together.</p>

<p>Function overloads, like all other type information, is the first thing to be ripped out of the source code when TypeScript compiles it to JavaScript.  So, the end result is that when you look at the generated JavaScript you will only see the underlying function and not have any hint that these overloads were ever defined in the TypeScript version.</p>

<p>Because it doesn’t actually change the functionality of the function, you can think about function overloads in the exact same way that you think about specifying variable or parameter types – it’s simply metadata for TypeScript to help you write better code.</p>

<h2 id="leanpub-auto-custom-types">
<span class="section-number">6. </span>Custom Types</h2>

<h3 id="leanpub-auto-defining-custom-types-with-interfaces">Defining custom types with Interfaces</h3>

<p>So far in the book I’ve showed you how to use TypeScript as a transpiler that allows you to take advantage of ECMAScript 2015 language features and as a way to guard yourself against many common bugs such as misspelling member names or returning the wrong type from a function.  That’s all very valuable, but the real value in using TypeScript is the fact that you can go above and beyond the types that JavaScript provides out of the box and define custom types that describe the data structures and behavior that your application uses.</p>

<p>TypeScript offers three ways to define a custom type - interfaces, classes, and enums - and in this chapter I’m going to start with the easiest of those three: interfaces.</p>

<p>An interface in TypeScript is the same as an interface in just about any other staticly-typed language like C# or Java:  it acts as a contract that describes the data and behaviors that the object exposes for others to interact with.  In order to define an interface, you use this straightforward syntax:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Here I’ve defined an empty interface called <code>Todo</code> that I’ll use to describe the Todo type that I’ll be using to build the sample application through the rest of the book.  I’ll start by defining two properties:  a <code>name</code> property to contain the display name of the Todo, and a <code>completed</code> property to indicate whether the Todo has been completed or still remains to be done:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">name</code><code class="p">;</code>
    <code class="nx">completed</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now, this is perfectly legitimate, but as I just got done describing in the last chapter, since we have the ability to be very descriptive about our types, we should use it!  So, let’s specify a type for each of these properties.</p>

<p>Since the <code>name</code> property is going to hold a string value containing the name of the Todo, I’ll specify the <code>string</code> type using the same syntax that I used to apply type information to variables and function parameters last chapter:  a colon, followed by the type name:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    <code class="nx">completed</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then I’ll do the same thing with the <code>completed</code> property, defining it as a boolean:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    <code class="nx">completed</code><code class="o">:</code> <code class="kr">boolean</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Before I begin using this interface, take a look at the code that TypeScript generates to represent this interface at runtime:</p>

<figure class="code">
  <figcaption>Generated JavaScript</figcaption>

<div class="highlight"><pre><code></code>
</pre></div>

</figure>

<p>It’s blank!  That’s because interfaces are strictly used for compile-time checks only, and have no effect on the code at runtime.  Consider interfaces a way to tell TypeScript information about objects to help you catch more errors at build time, but don’t ever rely on them being there at runtime.  In fact, the first thing that TypeScript does when it compiles the final JavaScript output is to strip out all of the interface definitions.</p>

<p>Let’s put this new interface to work by applying it to a new variable:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
</pre></div>

</figure>

<p>And then I’ll try to assign that variable with an object that doesn’t fit the description that we’ve laid out in the <code>Todo</code> interface.  We’ll start with just an empty object by creating an object literal with no members defined:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="p">{</code> <code class="p">};</code>
</pre></div>

</figure>

<p>Notice how TypeScript warns us that this object is not compatible with the <code>Todo</code> type because it doesn’t have the <code>name</code> property.  </p>

<p>Alternatively, I could go the opposite right and instead of the defining the type of the variable I can specify the type of the object itself using the “casting” syntax, which looks like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">Todo</code><code class="o">&gt;</code><code class="p">{</code> <code class="p">};</code>
</pre></div>

</figure>

<p>However, I tend to stick with the other way because I find it a little bit cleaner to tell TypeScript what type I want the variable to be and have it make sure I’m assigning the right object, rather then the other way around…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="p">{</code> <code class="p">};</code>
</pre></div>

</figure>

<p>So, now that I have an object that TypeScript is warning me is not really a Todo, let’s go ahead and add a name property… but instead of defining it as a string type like TypeScript is expecting, let’s try to trick TypeScript and initialize it to a number value instead:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="p">{</code> 
    <code class="nx">name</code><code class="o">:</code> <code class="mi">123</code>
<code class="p">};</code>
</pre></div>

</figure>

<p>Nope, TypeScript doesn’t like that, either!  Now it’s telling us that it did find a property called <code>name</code>, but that property is not compatible with the type of the <code>name</code> property that we defined on the <code>Todo</code> interface…  In other words, TypeScript is telling us, “You told me this was supposed to be a string, but you’re trying to set it to a number and I’m not gonna let you do that!”</p>

<p>If we correct this issue by assigning the property to a string…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="p">{</code> 
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Pick up drycleaning'</code>
<code class="p">};</code>
</pre></div>

</figure>

<p>TypeScript gives us the next error: that this object is now missing the <code>completed</code> property.  At this point we’ve got two options:  </p>

<ol class="numeric">
  <li>Satisfy the interface by adding a <code>completed</code> property with a boolean value,   or…</li>
  <li>Decide that maybe not all <code>Todo</code> instances really do require a completed property and update the interface to make this property optional by adding a question mark right after the name:
    <p>interface Todo {
     name: string;
     completed?: boolean;
 }</p>
  </li>
</ol>

<p>What this does is tells TypeScript: “Not every Todo object needs to have a completed property in order to be considered a Todo… <em>but</em>, when it does have the completed property, that property should always be a boolean value.”</p>

<p>It’s important to note at this point that interfaces just describe what you intend or expect to happen - they don’t actually enforce the fact that values will be of a certain type or have the expected properties at runtime.  To illustrate this point, consider a scenario where these objects are coming from outside of our application, for instance if we were retrieving them from a remote web service through an AJAX call.  In this scenario we have no way of controlling what will actually come back from that server, and in fact the server could choose to change its data structure even after our application had been running successfully for some time.  When the server changes the data it sends back, our TypeScript interfaces aren’t going to do anything to help guard us against that – but what they will do is allow us to update the interface in one place and more easily fix the issue throughout our application.</p>

<p>Data fields aren’t the only thing that you can define in an interface:  you can also specify the behaviors that an object might have by defining method signatures on the interface.  To define a method signature, you use the same exact syntax that you use to define a function, except you just drop the <code>function</code> keyword.</p>

<p>Since I am plan to only use this <code>Todo</code> interface to describe the data structure of a <code>Todo</code> object with no behavior, I’ll create a new interface called <code>ITodoService</code> that I will use to do things like create, retrieve, update, and delete <code>Todo</code>s:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, I’ll define some method definitions to give it some behavior.</p>

<p>First I’ll define a method that gets me a single <code>Todo</code>, called <code>getById()</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
    <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>This method takes one argument - the number of the <code>Todo</code> to get - and returns a single <code>Todo</code> value.</p>

<p>Then, I’ll define a method that gets me all of my <code>Todo</code>s called <code>getAll()</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
    <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
    <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>This method takes no arguments and returns an array of <code>Todo</code> objects.</p>

<p>Next, I’ll add a method to delete a <code>Todo</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
    <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
    <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
    <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>This method takes one argument called <code>todoId</code> which is the numeric ID of the <code>Todo</code> item to delete and it doesn’t return anything which I’ll indicate by using <code>void</code> as the return type.</p>

<p>Finally, I’ll define an <code>add</code> method that’ll let me add new <code>Todos</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
    <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
    <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
    <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
    <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>This method takes in a <code>Todo</code> object and then returns the newly-created <code>Todo</code> object (which may or may not be the same <code>Todo</code> object that was passed in).</p>

<p>And that’s it - I’ve now shown you how to create two interfaces:  one that describes a service that has methods that I can call and another one that simply defines the data structure of an object to make it easier for me to interact with instances of those objects.  </p>

<p>Note that I’m not actually going to implement this <code>ITodoService</code> just yet - that’s not what this chapter is about.  Instead, I’ll save that for the  next chapter where I show you how to create classes that implement interfaces.  However, keep reading the rest of the sections in this chapter where I’ll show you all the interesting things that you can do with TypeScript interfaces, such as using the concept of structural typing to match objects to interfaces implicitly.</p>

<div class="page-break"></div>
<h3 id="leanpub-auto-using-interfaces-to-describe-functions">Using interfaces to describe functions</h3>

<p>In the previous sections I showed you how to create an interface that describes the data members or methods of an object.  This is great when you’re dealing with a simple object, but in addition to being a dynamic language, JavaScript is also a functional language, meaning that not only can you assign a function to a variable like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">$</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">selector</code><code class="p">)</code> <code class="p">{</code>
	<code class="c1">// Find DOM element</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>But that functions are also objects that can have their own properties and methods as well!  In other words, this is perfectly legitimate JavaScript code:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">$</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">selector</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// Find DOM element</code>
<code class="p">}</code>

<code class="nx">$</code><code class="p">.</code><code class="nx">version</code> <code class="o">=</code> <code class="mf">1.12</code><code class="p">;</code>
</pre></div>

</figure>

<p>If this is legitimate JavaScript code, that means that sooner or later we’re going to want to describe it with an interface, and that’s exactly what I’ll show you how to do in this section.</p>

<p>First, let’s start off with what we already know how to do and give the interface a <code>version</code> property that’s a number type:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">jQuery</code> <code class="p">{</code>
    <code class="nx">version</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now, in order to define the function itself we simply add a function property without a name:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">jQuery</code> <code class="p">{</code>
    <code class="p">(</code><code class="nx">selector</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">HTMLElement</code><code class="p">;</code>
    <code class="nx">version</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Other than the fact that it doesn’t have a name, all of the normal rules apply: I can specify parameters and return values and everything.  </p>

<p>Here I’ve chosen to return an <code>HTMLElement</code>, which is a built-in type that is exactly what it sounds like - a DOM element!  That means that if I call this method TypeScript will be able to give me an object with full autocomplete on all the properties and behaviors available to HTML elements.</p>

<p>Once I’ve defined the interface, I can apply it to the function that I’ve defined by using the casting syntax to force TypeScript into treating this function an instance of this interface.  </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">$</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">jQuery</code><code class="o">&gt;</code><code class="kd">function</code><code class="p">(</code><code class="nx">selector</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// Find DOM element</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With this interface defined and applied to the <code>$</code> variable, I can now call the <code>$</code> function and get the full typing of the <code>jQuery</code> interface:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">element</code> <code class="o">=</code> <code class="nx">$</code><code class="p">(</code><code class="s1">'#container'</code><code class="p">);</code>
</pre></div>

</figure>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/CustomTypes----jquery-intellisense.png" alt="HTMLElement autocomplete options">
  <figcaption>HTMLElement autocomplete options</figcaption>
</figure>


<p>In this section, I showed you how to define interfaces that describe functions, and I did using the popular jQuery API as my example.  However, for those of you who are familiar with the jQuery API, you know that it offers far more features than just what I’ve shown here.  And, not only that, but it also offers a plugin model that lets anyone come along and dynamically add functionality to the API as well.</p>

<p>In the next section, I’ll show you how you can extend this interface to describe all of this functionality without having to actually modify it.</p>

<div class="page-break"></div>
<h3 id="leanpub-auto-extending-interface-definitions">Extending interface definitions</h3>

<p>In this chapter I’ve shown you how to define and apply interfaces that describe the properties and methods of an object, but JavaScript is a dynamic language, which means that it is very easy to extend the structure of an object by adding methods and data properties on the fly.</p>

<p>Perhaps the best example of this is the jQuery library and the way it allows you to extend its behavior through its plugin design pattern.  </p>

<p>If you’re not familiar with jQuery, it is a library that makes it very easy to work with DOM elements and in fact, I started to describe it with the ‘jQuery’ interface that I made in the last section, and have updated just a little bit to make it behave a little more like the real jQuery library for this demo.</p>

<p>The biggest difference between this interface and the jQuery library, however, is that instead of HTML elements, the real <code>jQuery</code> function returns a <code>jQueryElement</code>, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">jQuery</code> <code class="p">{</code>
    <code class="p">(</code><code class="nx">selector</code><code class="o">:</code>  <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">))</code><code class="o">:</code> <code class="nx">jQueryElement</code> <code class="p">;</code>
   <code class="nx">fn</code><code class="o">:</code> <code class="nx">any</code><code class="p">;</code>
    <code class="nx">version</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>A <code>jQueryElement</code> is a JavaScript object that has helper methods like the <code>data()</code> method which allows you to assign data to an HTML data property, or extract a previously-assigned value from a data property. </p>

<p>In other words, the interface for the <code>jQueryElement</code> (or at least the part that I’m interested in right now) might look like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">jQueryElement</code> <code class="p">{</code>
    <code class="nx">data</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">any</code><code class="p">;</code>
    <code class="nx">data</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">data</code><code class="o">:</code> <code class="nx">any</code><code class="p">)</code><code class="o">:</code> <code class="nx">jQueryElement</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>And I would use jQuery to modify data properties like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code> <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code> <code class="p">};</code>
<code class="kd">var</code> <code class="nx">element</code> <code class="o">=</code> <code class="nx">$</code><code class="p">(</code><code class="s1">'#my-element'</code><code class="p">);</code>
<code class="nx">element</code><code class="p">.</code><code class="nx">data</code><code class="p">(</code><code class="s1">'todo'</code><code class="p">,</code> <code class="nx">todo</code><code class="p">);</code>
<code class="kd">var</code> <code class="nx">savedTodo</code> <code class="o">=</code> <code class="nx">element</code><code class="p">.</code><code class="nx">data</code><code class="p">(</code><code class="s1">'todo'</code><code class="p">)</code> <code class="c1">// returns todo</code>
</pre></div>

</figure>

<p>In the first line I use the jQuery <code>$</code> function to get a reference to a DOM element.  Then, I use the <code>data()</code> method to assign the <code>todo</code> object to the DOM element’s data property named <code>"todo"</code>.  Finally, I use the <code>data("todo")</code> method again to extract the value I just set by calling it with only the name of the data property that I want to retrieve.</p>

<p>Now, that’s the behavior that comes out of the box in the jQuery library.  But, as I mentioned a minute ago, jQuery allows you to extend this API by simply attaching new functions to its <code>fn</code> property, like this custom method that assigns an instance of a Todo to the data of an HTML element, or retrieves the previously-assigned Todo instance:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">$</code><code class="p">.</code><code class="nx">fn</code><code class="p">.</code><code class="nx">todo</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">todo</code><code class="o">?:</code> <code class="nx">Todo</code><code class="p">)</code> <code class="p">{</code>

    <code class="k">if</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">$</code><code class="p">(</code><code class="k">this</code><code class="p">).</code><code class="nx">data</code><code class="p">(</code><code class="s1">'todo'</code><code class="p">,</code> <code class="nx">todo</code><code class="p">)</code>    
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
        <code class="k">return</code> <code class="nx">$</code><code class="p">(</code><code class="k">this</code><code class="p">).</code><code class="nx">data</code><code class="p">(</code><code class="s1">'todo'</code><code class="p">);</code>
    <code class="p">}</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>What’s more, the jQuery plugin model says that once I add this method to the <code>fn</code> property, I <em>should</em> be able to simply call it from any jQueryElement, just like I called the <code>data()</code> method I just showed.  In other words, I should be able to do this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">element</code><code class="p">.</code><code class="nx">todo</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>
</pre></div>

</figure>

<p>But, if I try to do that TypeScript yells at me since my custom <code>todo</code> extension method is not listed on the <code>jQueryElement</code> interface, even though I know that jQuery will make it available to me so it should be listed as a valid method!</p>

<p>Of course, I just created the <code>jQueryElement</code> interface so in this example I could fix this by just updating the interface definition to include the new method, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">jQueryElement</code> <code class="p">{</code>
    <code class="nx">data</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">any</code><code class="p">;</code>
    <code class="nx">data</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">data</code><code class="o">:</code> <code class="nx">any</code><code class="p">)</code><code class="o">:</code> <code class="nx">jQueryElement</code><code class="p">;</code>
    
    <code class="nx">todo</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
    <code class="nx">todo</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">jQueryElement</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>I <em>could</em> do that, but since jQuery is a third-party library that I didn’t create, let’s assume that this interface was actually created by the jQuery team and not me. In that case, it’s a really bad idea to update their interface to add my own extensions.  </p>

<p>Luckily, TypeScript will let you extend any interface without actually changing the original definition, and it’s actually much simpler than you might expect.</p>

<p>Rather than update the jQuery team’s interface, I can create a brand new interface that shares the same exact name as the one that I want to extend:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">jQueryElement</code> <code class="p">{</code>
    <code class="nx">data</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">any</code><code class="p">;</code>
    <code class="nx">data</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">data</code><code class="o">:</code> <code class="nx">any</code><code class="p">)</code><code class="o">:</code> <code class="nx">jQueryElement</code><code class="p">;</code>
    
    <code class="nx">todo</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
    <code class="nx">todo</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">jQueryElement</code><code class="p">;</code>
<code class="p">}</code>

<code class="kr">interface</code> <code class="nx">jQueryElement</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With this in place, I can move my custom methods into this new interface, keeping them completely separate from the original interface that the jQuery team owns:</p>

<figure class="code">
<div class="highlight"><pre>interface jQueryElement {
    data(name: string): any;
    data(name: string, data: any): jQueryElement;
<code class="udl">    todo(): Todo;
</code><code class="udl">    todo(todo: Todo): jQueryElement;
</code>}

interface jQueryElement {
<code class="uil">    todo(): Todo;
</code><code class="uil">    todo(todo: Todo): void;
</code>}
</pre></div>

</figure>

<p>Now if I look at the autocomplete options for the element I see both the data and the todo methods listed, even though my custom methods were not on the original interface.</p>

<p>Even though it seems like a second definition of the same interface would just conflict with or overwrite the first definition, it doesn’t.  Anything added to this second definition (or a third, or any number of additional definitions) will simply be tacked on to the original interface just as if it were directly added directly to it. </p>

<p>Generally speaking, it’s a pretty good idea to only apply this approach to code that you don’t own, as I’ve done in this example.  In other words, if I wanted to extend one of the interfaces in my own application - such as the <code>Todo</code> or <code>ITodoService</code>  interfaces that I made earlier - I’d be better off just going and adding these new methods directly to the original interface.  If, however, I extend the behavior of a third-party library, using this approach is a pretty good way to extend the library’s interface without actually changing the original code.</p>

<div class="page-break"></div>
<h3 id="leanpub-auto-defining-constant-values-with-enums">Defining constant values with enums</h3>

<p>In the beginning of this chapter I mentioned that TypeScript offers three different ways to define custom types: interfaces, classes, and enums.  I showed you how to define interfaces in the previous two sections, and I’ll spend the whole next chapter showing you how to use classes.  So that leaves enums, which is what I’ll cover in this section.</p>

<p>If you’re familiar with the concept of enums from other languages such as C# or Java, enums in TypeScript act in pretty much the same way:  they are a way to define a set of meaningful - and constant - values that you can use to replace the “magic” strings and numbers that you would otherwise use.</p>

<p>What’s a “magic” value?  The easiest way to explain is to look at an example.</p>

<p>Up to now, I’ve been using a boolean value - either true or false - as the type of the <code>completed</code> property that describes whether a todo is completed or not:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">completed</code><code class="o">:</code> <code class="kc">true</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>But, let’s say instead of that a todo can be in one of several different states:  New, Active, Complete, and Deleted.  </p>

<p>In other words, instead of that <code>completed</code> property, I want to have a <code>state</code> property, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">state</code><code class="o">:</code> <code class="mi">1</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Here I’ve used a number to indicate which state the todo is in, but I’ve got a couple of different options.  </p>

<p>I might assign each state a number, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="cm">/*</code>
<code class="cm">New = 1</code>
<code class="cm">Active = 2</code>
<code class="cm">Complete = 3</code>
<code class="cm">Deleted = 4</code>
<code class="cm">*/</code>
</pre></div>

</figure>

<p>Or, I could assign them all a string or a character, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="cm">/*</code>
<code class="cm">New = 'N'</code>
<code class="cm">Active = 'A'</code>
<code class="cm">Complete = 'C'</code>
<code class="cm">Deleted = 'D'</code>
<code class="cm">*/</code>
</pre></div>

</figure>

<p>Whatever values I decide to use, I’ll end up hard-coding those values all throughout my code.</p>

<p>For example, let’s say a todo must be in the “Complete” state in order to delete it, so I’d end up writing this logic:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">deleteTodo</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code> <code class="p">{</code>
    
    <code class="k">if</code><code class="p">(</code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">!=</code> <code class="mi">3</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">throw</code> <code class="s2">"Can't delete incomplete task!"</code>
    <code class="p">}</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>This makes a lot of sense right now because I just told you that the value <code>3</code> means the “Complete” state.  But, what happens when we have to read this in 3 months and we’ve completely forgotten what all of those values are, or a new developer joins the team who just doesn’t know?  All of the sudden, this same code is completely unreadable because we have no idea what <code>3</code> refers to.</p>

<p>In this case <code>3</code> is the “magic number” - a value that is crucial to making the application work, but is completely meaningless without some kind of context.  Enums provide that context.</p>

<p>The syntax to define enums in TypeScript is very similar to defining them in other languages such as C# and Java.  It looks like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
	<code class="nx">New</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
	<code class="nx">Active</code> <code class="o">=</code> <code class="mi">2</code><code class="p">,</code>
	<code class="nx">Complete</code> <code class="o">=</code> <code class="mi">3</code><code class="p">,</code>
	<code class="nx">Deleted</code> <code class="o">=</code> <code class="mi">4</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Take a look at what JavaScript code TypeScript generates:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">TodoState</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"New"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">1</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"New"</code><code class="p">;</code>
    <code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"Active"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">2</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Active"</code><code class="p">;</code>
    <code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"Complete"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">3</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Complete"</code><code class="p">;</code>
    <code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"Deleted"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">4</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Deleted"</code><code class="p">;</code>
<code class="p">})(</code><code class="nx">TodoState</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoState</code> <code class="o">=</code> <code class="p">{}));</code>
</pre></div>

</figure>

<p>Ok, maybe it’s not obvious what this code does.</p>

<p>Instead, copy this generated code, open the developer console of your browser and just paste it in.</p>

<p>Then, inspect the <code>TodoState</code> object to see what it looks like:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">TodoState</code>  <code class="c1">// {1: "New", 2: "Active", 3: "Complete", 4: "Deleted", New: 1, Activ\</code>
<code class="nx">e</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code> <code class="nx">Complete</code><code class="o">:</code> <code class="mi">3</code><code class="p">,</code> <code class="nx">Deleted</code><code class="o">:</code> <code class="mi">4</code><code class="p">}</code>
</pre></div>

</figure>

<p>I can see here that the code that TypeScript generated creates two properties on the <code>TodoState</code> object for each enum value I defined:  a numeric value with a string key, and a string value with a numeric key.</p>

<p>In other words, <code>TodoState.New</code> translates to the number <code>1</code>.  And, if I have the number <code>1</code> and I want to get its name, I can request the name by requesting it from the enum object like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">TodoState</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code> <code class="c1">// "New"</code>
</pre></div>

</figure>

<p>Note that, even though this looks like the syntax I’d used to access a value in an array, it is really the syntax you use in order to dynamically access a property on an object.
In this case, I passed the value <code>1</code> directly, but most of the time when you use this syntax with an enum, you’re going to be passing in a variable.</p>

<p>For example, I might have a variable named <code>todoState</code> that I assign to an enum value somewhere:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">state</code> <code class="o">=</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">New</code>
</pre></div>

</figure>

<p>And then later on in my code I want to display the name of that enum value:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">TodoState</code><code class="p">[</code><code class="nx">state</code><code class="p">]</code>
</pre></div>

</figure>

<p>Remember, the actual value of the state variable is actually a number:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">state</code> <code class="c1">// 1</code>
</pre></div>

</figure>

<p>Now that I have my new <code>TodoState</code> enum defined, I’ll revisit and refactor that example from earlier, and instead of hard-coding the number <code>1</code> to mean the “New” todo state, I’ll use the enum:</p>

<figure class="code">
<div class="highlight"><pre>function deleteTodo(todo: Todo) {
    
<code class="udl">    if(todo.state != 1) {
</code><code class="uil">    if(todo.state != TodoState.New) {
</code>        throw "Can't delete incomplete task!"
    }
    
}
</pre></div>

</figure>

<p>At runtime, this code works pretty much exactly the same as before – in other words, when this expression evaluates it really says “if( todo.state is not equal to 1)”.</p>

<p>In fact, with this enum in place, I can actually update the <code>Todo</code> interface, updating the type of the <code>state</code> property to be <code>TodoState</code> to enforce the fact that consumers may only assign valid values that I’ve defined in the TodoState enum:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Also, in addition to all of those benefits, TypeScript is also able to help me out by giving me a great autocomplete list of <code>TodoState</code>s that I can choose from as I type:</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/CustomTypes----enum-autocomplete.png" alt="TypeScript enum autocomplete">
  <figcaption>TypeScript enum autocomplete</figcaption>
</figure>


<p>Even though all of this code is still functioning pretty much exactly the same as it did before I introduced enums, using TypeScript’s enum feature offers a simple - yet incredibly powerful - way to reduce those “magic strings” that we find ourselves relying on so often and give meaning to those important values in our code, which ultimately make the code much easier to understand.  I think that once you try using enums, you’ll wonder how you ever worked in JavaScript without them.</p>

<div class="page-break"></div>
<h3 id="leanpub-auto-anonymous-types">Anonymous Types</h3>

<p>Now that I’ve showed you how to define custom types in TypeScript using interfaces, let me add a little twist:  you can actually declare interfaces right in-line anywhere that accepts a type.  This approach is called an <strong>anonymous type</strong>.</p>

<p>For example, let’s say that I have a variable that I want to accept an object that has a <code>name</code> property.  Rather than define a whole interface with just one property, I could simply define the type right inline, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="p">{</code> <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code> <code class="p">};</code>
</pre></div>

</figure>

<p>With this anonymous type definition in place, TypeScript will begin enforcing it.  For instance, it’ll give me an error if I try to assign an object to this variable that doesn’t have the <code>name</code> property:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code> <code class="nx">age</code><code class="o">:</code> <code class="mi">42</code> <code class="p">};</code>
</pre></div>

</figure>

<p>This can actually be very useful in certain scenarios.  Remember in the last chapter when I introduced you to union types with this example to allow consumers to pass in either strings or array values?</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]),</code> <code class="nx">y</code><code class="o">:</code> <code class="p">(</code><code class="nx">string</code> <code class="o">|</code> <code class="nx">any</code><code class="p">[]))</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>If all I really care about is the <code>length</code> property of these two arguments, why should I restrict them to just string and array types?  Why not embrace JavaScript’s dynamic nature and just let in ANY object that has a <code>length</code> property (as long as it’s a number, of course)?</p>

<p>Well, if I replace those union type with anonymous types I can achieve exactly that:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="p">{</code> <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> <code class="p">},</code> <code class="nx">y</code><code class="o">:</code> <code class="p">{</code> <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> <code class="p">})</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With this simple change, I’ve now opened the door to any object with a length, making this code dramatically more reusable and, personally speaking, I think it’s also much cleaner and easier to understand.</p>

<p>Keep in mind, there is one issue that still remains and that is there is nothing forcing consumers of this method to pass in two values of the same exact type, therefor allowing them to continue to be able to add the length of an array to the length of a string for example.  But, we’ll take care of that issue in the generics chapters.  For now, let’s keeping moving on to the next section and check out the other ways that TypeScript allows us to define custom types.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="p">{</code> <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code> <code class="p">};</code>

<code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code> <code class="nx">age</code><code class="o">:</code> <code class="mi">41</code> <code class="p">}</code>

<code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="p">{</code> <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> <code class="p">},</code> <code class="nx">y</code><code class="o">:</code> <code class="p">{</code> <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> <code class="p">})</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<div class="page-break"></div>
<h3 id="leanpub-auto-using-interfaces-to-dynamically-access-object-properties">Using interfaces to dynamically access object properties</h3>

<p>When I first heard about TypeScript and that it was bringing static typing to my beloved dynamically-typed JavaScript language, I wrote it off immediately.
After all, for all of the issues JavaScript has, its dynamic nature can be incredibly powerful when you use it correctly!
As far as I was concerned, anything that took that dynamic power away was bad in my book.</p>

<p>Of course, as I’ve mentioned several times already, TypeScript doesn’t <em>take away</em> anything from JavaScript.
And, whenever you come across a scenario when you want to ditch static typing and really leverage JavaScript’s dynamic nature, you can always feel free to use the <code>any</code> type to tell TypeScript not to enforce strong typing rules on a given object.</p>

<p>For example, one pattern that I use all the time in my JavaScript code is to leverage a regular object as a collection, in which each of the object’s properties acting as the key for each of the items in the collection, like so:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">todoComments</code> <code class="o">=</code> <code class="p">{</code>
  <code class="mi">123</code><code class="o">:</code> <code class="p">[</code> <code class="s2">"Still need to clean the Bat computer"</code> <code class="p">],</code>
  <code class="mi">456</code><code class="o">:</code> <code class="p">[</code> <code class="s2">"Waiting to hear back from Alfred."</code> <code class="p">]</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>In this example, I’ve create an object named <code>todoComments</code> to store an array of comments for each of my <code>Todo</code> objects, using the Todo items’ Id value as the property name.
Using this approach, I can access Todo comments like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">comments</code> <code class="o">=</code> <code class="nx">todoComments</code><code class="p">[</code><code class="nx">todo</code><code class="p">.</code><code class="nx">id</code><code class="p">];</code>
</pre></div>

</figure>

<p>Or, I can add new comments on the fly, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">todoComments</code><code class="p">[</code><code class="nx">todo</code><code class="p">.</code><code class="nx">id</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"Wow, what a great example!"</code> <code class="p">];</code>
</pre></div>

</figure>

<p>Of course, TypeScript supports this approach just fine right out of the box.
The problem comes when we consider the fact that you and I can look at the code and see what it does - that whenever I pass in a Todo item’s Id, I get a collection of strings back - however, TypeScript has no idea about that… unless we tell it.</p>

<p>Luckily, there’s a simple syntax to do this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">ITodoCommentsLookup</code> <code class="p">{</code>
    <code class="p">[</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">]</code><code class="o">:</code> <code class="nx">string</code><code class="p">[];</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>What this interface says is that the object that implements it offers an indexer that accepts a <code>number</code> as the key and returns a collection of <code>string</code>s (<code>string[]</code>).</p>

<p>Of course, you apply this interface like any other interface:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">todoComments</code><code class="o">:</code> <code class="nx">ITodoCommentsLookup</code> <code class="o">=</code> <code class="p">{</code>
</pre></div>

</figure>

<p>Then, from there on out, whenever you use the accessor with a number, TypeScript will know that the object returned is an array of strings and will give you the proper static typing behavior:</p>


<figure class="image floatright">
  <img src="./Read Essential TypeScript _ Leanpub_files/CustomTypes----array-interface.png" alt="Full type support for indexed properties">
  <figcaption>Full type support for indexed properties</figcaption>
</figure>


<p>This technique may not be something that you use every day, but it is one that can be really powerful when it is applicable.
So, keep this syntax in mind the next time you want stong typing support on an object that you’ve retrieved using an object’s indexer.</p>

<h2 id="leanpub-auto-classes">
<span class="section-number">7. </span>Classes</h2>

<h3 id="leanpub-auto-understanding-prototypical-inheritance">Understanding Prototypical Inheritance</h3>

<p>In the previous chapter I mentioned that TypeScript offers 3 ways to define custom types:  interfaces, enums, and classes, then I showed you all about how to use interfaces and enums.  Now it’s time to show you how to implement custom types using classes and use those classes to implement all kinds of object-oriented functionality such as inheritance, abstraction, and encapsulation.  Before I get into the syntax of creating a class, however, I want to define what JavaScript a class is - and is not.</p>

<p>First off, I want to be clear that TypeScript doesn’t introduce the concept of a class - ECMAScript 2015 does!  However, it’s crucial to understand that - even though JavaScript does now have a <code>class</code> keyword and syntax, all of this is syntactic sugar and it doesn’t change the fact that JavaScript is still based on objects and prototypical inheritance, otherwise known as prototype-based programming.</p>

<p>Prototype-based programming all starts with a special object called the <strong>prototype</strong>.  </p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Classes----prototype.png" alt="The Prototype">
  <figcaption>The Prototype</figcaption>
</figure>


<p>If you want to share behavior between object instances, you define that behavior on the prototype object, and then link other object instances to that object.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Classes----prototypical-linking.png" alt="Prototypical Linking">
  <figcaption>Prototypical Linking</figcaption>
</figure>


<p>Keep in mind that in JavaScript, objects are just bags of dynamic properties, which means that accessing a member of an object is not as simple as testing whether or not that member exists.  Instead, whenever you attempt to access any member of an object - regardless of whether it’s a method or a value field - JavaScript tries as hard as it can to find the member that you’re looking for.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Classes----prototypical-inheritance.png" alt="Prototypical Linking: locating a member">
  <figcaption>Prototypical Linking: locating a member</figcaption>
</figure>


<p>First, JavaScript looks for the member on the object itself, just like you asked it to.  If it finds a member with that name on the object you referenced, then great!  It accesses that member and it’s done!  </p>

<p>If, however, JavaScript does not find a matching member on that object, it doesn’t give up there.  </p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Classes----prototypical-inheritance-1.png" alt="Prototypical Linking: locating a missing member">
  <figcaption>Prototypical Linking: locating a missing member</figcaption>
</figure>


<p>Instead, it looks at the object’s prototype object to see if the member exists on that object.  If a member of that name exists on the prototype, then JavaScript refers to that member and it’s done!  Otherwise, it accesses the prototype’s prototype, and the cycle continues… all the way up the chain until it reaches the root of everything:  the Object prototype.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Classes----prototypical-inheritance-2.png" alt="Prototypical Linking: locating a missing member (second try)">
  <figcaption>Prototypical Linking: locating a missing member (second try)</figcaption>
</figure>


<p>And I mean that quite literally:  <code>Object.prototype</code> is actually an object that you can see and interact with.  That means that if you type <code>Object.prototype</code> into the console…</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Classes----prototypical-inheritance-3.png" alt="Prototypical Linking: `Object.prototype`">
  <figcaption>Prototypical Linking: <code>Object.prototype</code></figcaption>
</figure>


<p>everything that you see on this object will be available to all other JavaScript objects.</p>

<p>The next question is: where does this special prototype object come from and how (and when) is it assigned to my objects?  The simple answer is that, most of the time, JavaScript does it for you.  The more complex answer is that there are actually quite a few ways that prototype objects get assigned.  </p>

<p>Let’s look at a couple of those ways, starting with a simple object literal:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code> <code class="p">};</code>
</pre></div>

</figure>

<p>When JavaScript creates any object - even one as simple as this - it automatically links its prototype object to the Object prototype.</p>

<p>The same is true of the other two “special” types of objects that I mentioned in the last chapter - functions and arrays - only, when JavaScript creates objects with these two types, it links them to the Function.prototype and Array.prototype objects respectively, allowing all functions and arrays to share common behavior such as the .slice method on an Array or the <code>.bind()</code> method on a function.</p>

<p>Perhaps the most common way that JavaScript assigns a prototype to an object is with a <strong>constructor</strong>, which is really just a function that is called with the <code>new</code> keyword.  When you initialize an object with the <code>new</code> keyword, JavaScript does three things:</p>

<ol class="numeric">
  <li>Creates a new object</li>
  <li>Sets the new object’s prototype to the constructor function’s prototype</li>
  <li>Executes the function that you called with the <code>new</code> keyword (referring to the new object as <code>this</code> within that method)</li>
</ol>

<p>To see this in action, I’ll create a new function that will act as the constructor function:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">TodoService</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="p">[];</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>This simple function just assigns the <code>todos</code> property on the <code>this</code> object to a new, empty array.  Remember, this <code>this</code> object refers to the object that JavaScript just created for us in the first step.</p>

<p>Then, I can define members that I want to be available to all instances of <code>TodoService</code> to its prototype, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="lineno">1 </code><code class="kd">function</code> <code class="nx">TodoService</code><code class="p">()</code> <code class="p">{</code>
<code class="lineno">2 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="p">[];</code>
<code class="lineno">3 </code><code class="p">}</code>
<code class="lineno">4 </code>
<code class="lineno">5 </code><code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getAll</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
<code class="lineno">6 </code>    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">;</code>
<code class="lineno">7 </code><code class="p">}</code>
</pre></div>

</figure>

<p>Notice how I’m referring to the array of todos through the <code>this</code> keyword in this method.  Just as you’d expect, the <code>this</code> keyword refers to the instance of the object, so <code>this.todos</code> on line 6 will refer to the same <code>this.todos</code> on line 2 at runtime.</p>

<p>With this in place, I can create a new instance of the <code>TodoService</code></p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">Var</code> <code class="nx">todoService</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">TodoService</code><code class="p">();</code>
</pre></div>

</figure>

<p>And then I can call the methods that are defined on the prototype like they were defined on the instance itself:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">todoService</code><code class="p">.</code><code class="nx">getAll</code><code class="p">();</code>
</pre></div>

</figure>

<p>And that is a very quick overview of prototypical inheritance in action.  I gave this recap because it’s crucial to understand prototypes and prototypical inheritance when dealing with any JavaScript code, but it’s especially important to keep this behavior in mind as you use the class syntax that I will show you in the next section to define the behavior in your application.  Just keep in mind that, even though you may be using a new syntax, you’re still using JavaScript’s prototype-based behavior.</p>

<h3 id="leanpub-auto-defining-a-class">Defining a class</h3>

<p>In the last section, I explained how JavaScript’s prototypical inheritance works and how you can share behavior across objects by defining behavior on a prototype object.  If all of that seemed a little overwhelming or unwieldy to have to type, I don’t really blame you.  That’s why ECMAScript 2015 introduced the class syntax that allows you to define this same behavior in a much simpler and more straight-forward way.  What’s more, you can use all of the TypeScript features I’ve shown so far to extend the ECMAScript 2015 class syntax with additional static type information.</p>

<p>At its core, the  ECMAScript 2015 class syntax is pretty simple.  To demonstrate, I’ll convert the prototype-based example from the previous section to use the class syntax instead:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">TodoService</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="p">[];</code>
<code class="p">}</code>

<code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getAll</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>I’ll start by defining the class itself, which is just the class keyword, followed by the class name - in this case, <code>TodoService</code> - followed by brackets that contain the class’s members:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, I can begin adding members to the class.  The syntax you use to define members of a class is almost exactly the same as the syntax you used to define members of an interface.</p>

<p>I’ll start with the class’s constructor function, which is the function that JavaScript calls to initialize the new object.  In the prototype-based syntax, the constructor function is simply the function that you attach all of the prototype behavior to - in our example, it’s the function named <code>TodoService</code>. </p>

<p>In order to define a constructor function using the class syntax, you simply define a method with the name <code>constructor</code>, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Likewise, I can add methods to the class as well, using the same syntax that I used to define them on an interface:  basically just the standard way of defining a JavaScript function, except without the <code>function</code> keyword.</p>

<p>For example, I can implement the <code>getAll</code> method, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
    <code class="p">}</code>
    
    <code class="nx">getAll</code><code class="p">()</code> <code class="p">{</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now that I’ve got a class with a constructor and a method in place, let’s add the array of todos that I referenced in the prototypical inheritance example.</p>

<p>In that example I defined the property by simply assigning a value to the <code>this</code> object - in other words: <code>this.todos = []</code>.  Let’s try to copy that call into the new constructor and see what happens.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="p">[];</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>When I try to assign a property on the <code>this</code> object in a class constructor, TypeScript will yell at me, saying “Hey! You’re trying to assign a value to a property that I don’t know about!”  That’s a good thing - TypeScript is trying to make me define a property before I access it… but, how do I do that?</p>

<p>Well, there are a couple of ways…</p>

<p>The first and simplest way is to define the property just like I did with on the interface:  by defining the member outside of the constructor like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
    
    <code class="nx">todos</code><code class="p">;</code>
</pre></div>

</figure>

<p>Up to this point, everything I’ve shown you is just ECMAScript 2015 class syntax, but here’s where TypeScript comes into play by allowing me to specify type information on this property:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
    
    <code class="nx">todos</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
</pre></div>

</figure>

<p>This syntax tells TypeScript that the <code>TodoService</code> has a property named <code>todos</code> that can contain an array of <code>Todo</code> objects, but it doesn’t actually create the property - that only happens in the constructor when I call <code>this.todos = [];</code></p>

<p>However, I can combine these two operations by defining a property and assigning and initializing it with a value all in one expression like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">todos</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[]</code> <code class="o">=</code> <code class="p">[];</code>
</pre></div>

</figure>

<p>This approach is a great way to define an initial variable that’s the same every time a new object is created.  But, you may often find that you would like to accept these initial values as parameters to the constructor function as opposed to the hard-coded values I’ve shown here.</p>

<p>In other words, you’ll end up doing this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">todos</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[]</code> <code class="o">=</code> <code class="p">[];</code>

<code class="nx">constructor</code><code class="p">(</code><code class="nx">todos</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[])</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="nx">todos</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Since this is a pretty standard practice, TypeScript actually gives you one more bit of syntactic sugar, and that is the ability to define a constructor parameter and a class property all in one expression, simply by putting an access modifier such as <code>private</code> in front of it.  </p>

<p>In this example, that means that all five of these lines can be condensed into one expression:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">constructor</code><code class="p">(</code><code class="kr">private</code> <code class="nx">todos</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[])</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Finally, now that I’ve defined and assigned the <code>todos</code> property, I can update the code in the <code>getAll</code> method to retrieve them by referencing them as <code>this.todos</code>, just like in the prototype-based approach:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">getAll</code><code class="p">()</code> <code class="p">{</code>
   <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With this in place, take a look at the code that TypeScript generates.  </p>

<figure class="code">
  <figcaption>TodoService.js (generated code)</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">TodoService</code> <code class="o">=</code> <code class="p">(</code><code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
    <code class="kd">function</code> <code class="nx">TodoService</code><code class="p">(</code><code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="nx">todos</code><code class="p">;</code>
    <code class="p">}</code>
    <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getAll</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">;</code>
    <code class="p">};</code>
    <code class="k">return</code> <code class="nx">TodoService</code><code class="p">;</code>
<code class="p">})();</code>
</pre></div>

</figure>

<p>Does that look familiar?  That’s right, after all of this syntactic sugar is stripped away and compiled down, TypeScript is just creating a prototype-based object underneath it all.  That’s why the bulk of the code that you’ll write inside of your methods will look pretty much exactly the same as it did when you user using the prototype-based syntax… because it is still prototype-based!</p>

<p>Regardless of that fact, I’ve found the class syntax to be an effective way to both think about and implement object behavior.  And this syntax becomes even more powerful as you implement the rest of the features in this chapter to build out nice, clean, and maintainable objects.  So, move on to the next sections where I’ll show you all of the ways that you can extend and leverage TypeScript classes.</p>

<h3 id="leanpub-auto-applying-static-properties">Applying static properties</h3>

<p>There are some situations in which you need to be able to maintain one single value that is used across many components - or many instances of one type of component.  </p>

<p>For example, let’s say that every time I create a new Todo item, I want to assign it a unique ID value so that I can retrieve and refer to it later on.  One of the ways I might do that is to keep a single counter in my application and increment it with each new Todo item that is added:  the first Todo is #1, the second is #2, etc.  But, in order to implement that approach, I’d need to ensure that my application has one single variable to keep track of that counter.</p>

<p>In other languages such as C#, Java, or even C/C++, you’d refer to these kinds of variables as <strong>static members</strong>.</p>

<p>For years, the easiest and most acceptable way to implement static members in JavaScript was to simply create a variable in the global namespace, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
</pre></div>

</figure>

<p>However, global variables are now generally considered bad practice and to be avoided at all costs.  So, instead of putting the variable in the global scope, I want to be able to nest it inside some other object.</p>

<p>These days, the more generally accepted practice of defining a static variable is to attach it to an object - especially the function that is going to use it the most.  In order example of incrementing a unique ID to apply to new Todo items, that function would be the <code>TodoService</code> I created in the previous section.</p>

<p>Prior to the ECMAScript 2015 class syntax, when I’d create a constructor function and then attach behavior to it via its prototype, I’d define that lastId variable directly onto the <code>TodoService</code> constructor function itself, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">TodoService</code><code class="p">()</code> <code class="p">{</code>
<code class="p">}</code>

<code class="nx">TodoService</code><code class="p">.</code><code class="nx">lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
</pre></div>

</figure>

<p>Since there is only ever one instance of the <code>TodoService</code> constructor function in our application, there will only ever be one instance of any variables I attach to that function.</p>

<p>In order to access this static variable - even in methods that are part of the <code>TodoService</code> - I’d have to do so by referring to the variable through the constructor function, exactly as I’d assigned it in the first place.  </p>

<p>In other words, I’d have to access it this way:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">add</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">newId</code> <code class="o">=</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">lastId</code> <code class="o">+=</code> <code class="mi">0</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Likewise, I can use the same approach to define a static method as well:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">TodoService</code><code class="p">.</code><code class="nx">getNextId</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">lastId</code> <code class="o">+=</code> <code class="mi">0</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>And, I’d access the static method in the same way, too:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">add</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">newId</code> <code class="o">=</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">getNextId</code><code class="p">();</code>
 <code class="p">}</code>
</pre></div>

</figure>

<p>Now, that’s the way I’d do it in the ES5 syntax, but with the ECMAScript 2015 class syntax, I simply add the property to my class just like I would add a regular property, and then put the keyword <code>static</code> in front of it:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
    
    <code class="kr">static</code> <code class="nx">lastId</code><code class="p">;</code>
    
    <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
    <code class="p">}</code>
</pre></div>

</figure>

<p>I can even apply type information and assign it an initial value, just like any other class property.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
    
    <code class="kr">static</code> <code class="nx">lastId</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
    
    <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
    <code class="p">}</code>
</pre></div>

</figure>

<p>And, staying true to it’s ES5-compatible nature, TypeScript diligently compiles this syntax down into the same exact approach that I demonstrated earlier: by attaching a variable directly to the <code>TodoService</code> constructor function.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">TodoService</code><code class="p">.</code><code class="nx">lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
</pre></div>

</figure>

<p>Likewise, I can also apply the <code>static</code> keyword to methods as well:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">static</code> <code class="nx">getNextId</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">lastId</code> <code class="o">+=</code> <code class="mi">0</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Because it is all just the same code underneath, it’s important to note that I consume the static property exactly as I did when I assigned it to the constructor function.</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code></code><code class="lineno"> 1 </code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
<code class="lineno"> 2 </code>    
<code class="lineno"> 3 </code>    <code class="kr">static</code> <code class="nx">lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
<code class="lineno"> 4 </code>    
<code class="lineno"> 5 </code>    <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
<code class="lineno"> 6 </code>    <code class="p">}</code>
<code class="lineno"> 7 </code>
<code class="lineno"> 8 </code>    <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno"> 9 </code>        <code class="kd">var</code> <code class="nx">newId</code> <code class="o">=</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">getNextId</code><code class="p">();</code>
<code class="lineno">10 </code>    <code class="p">}</code>
<code class="lineno">11 </code>
<code class="lineno">12 </code>    <code class="nx">getAll</code><code class="p">()</code> <code class="p">{</code>
<code class="lineno">13 </code>    <code class="p">}</code>
<code class="lineno">14 </code>    
<code class="lineno">15 </code>    <code class="kr">static</code> <code class="nx">getNextId</code><code class="p">()</code> <code class="p">{</code>
<code class="lineno">16 </code>        <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">lastId</code> <code class="o">+=</code> <code class="mi">0</code><code class="p">;</code>
<code class="lineno">17 </code>    <code class="p">}</code>
<code class="lineno">18 </code><code class="p">}</code>
</pre></div>

</figure>

<p>Notice how I’m accessing the static variable <code>lastId</code> on line 16 and the <code>getNextId</code> static method on line 9.</p>

<p>While static methods can be helpful to centralize small bits of common logic used by many components, static properties - even when they are attached to a class rather than defined in the global namespace - are still something that you should avoid at all costs since they tend to make your code a little more brittle, so they really should be your last resort. However, in scenarios such as this - when you need to guarantee a unique value, for instance - ECMAScript 2015 static members can be a very helpful feature.</p>

<h3 id="leanpub-auto-making-properties-smarter-with-accessors">Making properties smarter with accessors</h3>

<p>In the previous chapter, I showed you how to use interfaces and object literals to define and instantiate simple objects with properties and even behaviors.  Sometimes, however, you may need a property on an object to do a little bit more than just save a value and give that value back  to you when you ask for it later.</p>

<p>For example, in the last chapter I used an interface to define a Todo object that looked like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now, what if I wanted to enforce a specific workflow for Todo states.  Something like: you can’t change the state of a Todo to “Complete” unless its state is currently “Active” or “Deleted”.</p>

<p>In order to accomplish this, I’d need something a little smarter than the basic property:  I’d need to use a property with <strong>getter and setter methods</strong>. </p>

<p>Creating a property with getter and setter methods is pretty much exactly like it sounds.  Take this Todo object literal from the previous chapter:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>In order to convert the state property with getter and setter methods, I’ll start by just introducing the getter method, which I’ll implement by simply replacing the <code>state</code> property with a method called <code>state()</code> that accepts no parameters, and put the <code>get</code> keyword in front of that method, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">get</code> <code class="nx">state</code><code class="p">()</code> <code class="p">{}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>That’s the basic syntax, but in order for the getter to work it has to return something, so let’s start by just returning the hard-coded value <code>TodoState.Complete</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">get</code> <code class="nx">state</code><code class="p">()</code> <code class="p">{</code> 
        <code class="k">return</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code><code class="p">;</code> 
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>At this point I want to point out that, even though I’ve been calling them “getter and setter properties” like they have to go together, this code is actually perfectly legitimate – you don’t need to define a getter AND a setter for a property - you can implement either one or both of them, depending on what you’re trying to accomplish.</p>

<p>In this scenario, however, the magic I’m trying to accomplish is in the setter method, which I define in the same way that I defined the getter method, except that the setter method must take in a parameter, which is the variable to be assigned… and, of course, it must be preceeded by the “set” keyword rather than the “get” keyword that the getter uses.</p>

<p>For example:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">get</code> <code class="nx">state</code><code class="p">()</code> <code class="p">{</code> 
        <code class="k">return</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code><code class="p">;</code> 
    <code class="p">},</code>
    <code class="nx">set</code> <code class="nx">state</code><code class="p">(</code><code class="nx">newState</code><code class="p">)</code> <code class="p">{}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>That’s the basic syntax, and it’s actually perfectly legitimate to have a setter that doesn’t have any logic, effectively ignoring any values that are assigned to it… however, most of the time that you’re defining a getter and setter, the very least you’re going to do is assign a value to an internal variable with the setter, and retrieve that value from the getter.</p>

<p>For instance:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">get</code> <code class="nx">state</code><code class="p">()</code> <code class="p">{</code> 
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">_state</code><code class="p">;</code> 
    <code class="p">},</code>
    <code class="nx">set</code> <code class="nx">state</code><code class="p">(</code><code class="nx">newState</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">_state</code> <code class="o">=</code> <code class="nx">newState</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Here I’ve dynamically created the property <code>_state</code> in order to have a variable that both the getter and setter have access to.  Note that there’s nothing special about this variable name - neither the underscore, nor the fact that I called it <code>state</code> - I could have called it <code>foo</code> if I wanted to.  In fact, the same thing goes for the setter parameter, too:  I happened to call it <code>newState</code>, but its name can be anything at all.</p>

<p>Once I have this in place, I access the <code>state</code> variable exactly as I did before.  In other words, as a consumer I have no idea that it’s implemented as a getter/setter property - I only see a regular old property.  </p>

<p>That means I can set the value like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">=</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code><code class="p">;</code>
</pre></div>

</figure>

<p>And I can get the value like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code><code class="p">;</code>
</pre></div>

</figure>

<p>Ok, so, this is a fully-working example of the getter/setter syntax in action:  I’ve got a setter method that saves the value of a variable and a getter that gets that value back.  But so far this really doesn’t buy me anything - it’s no more useful than just a regular old property.</p>

<p>So, let’s revisit the <code>Todo</code> scenario I described earlier, in which I want to restrict the ability to set the state of the <code>Todo</code> to complete only when it is currently either <code>Active</code> or <code>Deleted</code>.  In order to implement that, I might expand the setter logic to include something like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>
    <code class="nx">get</code> <code class="nx">state</code><code class="p">()</code> <code class="p">{</code> 
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">_state</code><code class="p">;</code> 
    <code class="p">},</code>
    <code class="nx">set</code> <code class="nx">state</code><code class="p">(</code><code class="nx">newState</code><code class="p">)</code> <code class="p">{</code>

        <code class="k">if</code><code class="p">(</code> <code class="nx">newState</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code> <code class="p">)</code> <code class="p">{</code>
           
            <code class="kd">var</code> <code class="nx">canBeCompleted</code> <code class="o">=</code>
                   <code class="k">this</code><code class="p">.</code><code class="nx">_state</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Active</code> 
                <code class="o">||</code> <code class="k">this</code><code class="p">.</code><code class="nx">_state</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Deleted</code><code class="p">;</code>
            
            <code class="k">if</code><code class="p">(</code><code class="o">!</code><code class="nx">canBeCompleted</code><code class="p">)</code> <code class="p">{</code>
                <code class="k">throw</code> <code class="s1">'Todo must be Active or Deleted in order to be marked as C\</code>
<code class="s1">ompleted'</code>
            <code class="p">}</code>
        <code class="p">}</code>

        <code class="k">this</code><code class="p">.</code><code class="nx">_state</code> <code class="o">=</code> <code class="nx">newState</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With this logic in place, every time the state property is assigned a value, the logic in the setter will execute and validate whether or not the new state can bee assigned:  if the <code>Todo</code> is in the <code>Active</code> or <code>Deleted</code> state, everything is fine and the <code>_state</code> property is updated.  If not, an exception is thrown and the <code>_state</code> property remains in its current state.</p>

<p>Now that I’ve shown you how to take advantage of the getter and setter syntax, I have to admit something: you normally wouldn’t use this approach on an object literal like I’ve been showing.  It just doesn’t make much sense.  But, I’ve been defining these getter and setter properties on an object literal for two reasons:</p>

<ol class="numeric">
  <li>Well, because that’s what the Todo object has been in the previous examples and I didn’t want to change it, and</li>
  <li>To prove that the getter/setter syntax can be applied to object literals if you really want to.</li>
</ol>

<p>The reason you generally don’t want to apply getter/setter syntax to an object literal is because usually when you have this kind of logic you really want to put it in a class and create new instances of that class.  And, when you do that, the getter/setter syntax starts to look a whole lot more applicable.</p>

<p>To demonstrate, I’ll create a new class to house this behavior called <code>SmartTodo</code>, and I’ll give it the one “normal” property that the <code>Todo</code> needs: <code>name</code>…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">SmartTodo</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    
    <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, I’ll copy the same getter/setter logic that I defined in the object literal:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">SmartTodo</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>

    <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>

   <code class="nx">get</code> <code class="nx">state</code><code class="p">()</code> <code class="p">{</code>
        <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">_state</code><code class="p">;</code>
    <code class="p">}</code>
    <code class="nx">set</code> <code class="nx">state</code><code class="p">(</code><code class="nx">newState</code><code class="p">)</code> <code class="p">{</code>

        <code class="k">if</code><code class="p">(</code> <code class="nx">newState</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code> <code class="p">)</code> <code class="p">{</code>
           
            <code class="kd">var</code> <code class="nx">canBeCompleted</code> <code class="o">=</code>
                   <code class="k">this</code><code class="p">.</code><code class="nx">_state</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Active</code> 
                <code class="o">||</code> <code class="k">this</code><code class="p">.</code><code class="nx">_state</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Deleted</code><code class="p">;</code>
            
            <code class="k">if</code><code class="p">(</code><code class="o">!</code><code class="nx">canBeCompleted</code><code class="p">)</code> <code class="p">{</code>
                <code class="k">throw</code> <code class="s1">'Todo must be Active or Deleted in order to be marked as C\</code>
<code class="s1">ompleted'</code>
            <code class="p">}</code>
        <code class="p">}</code>

        <code class="k">this</code><code class="p">.</code><code class="nx">_state</code> <code class="o">=</code> <code class="nx">newState</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>As soon as I do that, TypeScript yells at me for reasons that should be expected at this point in the course:  I’m referring to a property named <code>this._state</code>, but that property doesn’t actually exist on this class!  Of course, that’s easy enough to fix – just define it:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">SmartTodo</code> <code class="p">{</code>
    <code class="nx">_state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
</pre></div>

</figure>

<p>With that, the errors go away, and I can now begin using this class:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">SmartTodo</code><code class="p">(</code><code class="s2">"Pick up drycleaning"</code><code class="p">);</code>

<code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">=</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">New</code><code class="p">;</code>

<code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">=</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code> <code class="c1">// BOOM!</code>
</pre></div>

</figure>

<p>I have to admit that I don’t use getters and setters much, since my personal preference is to stick with mostly simple objects and put this kind of logic into a service (such as the <code>TodoService</code> that I defined earlier).  However, there are plenty of folks who prefer to have this kind of logic embedded directly in their class, as well as plenty of scenarios where this is a perfectly understandable approach to take.  And, when you find yourself in need of properties that are more intelligent than just the basic “assign and retrieve” logic that regular properties gives you, the getter/setter method syntax is a great choice.</p>

<h3 id="leanpub-auto-inheriting-behavior-from-a-base-class">Inheriting behavior from a base class</h3>

<p>In the last section I mentioned that I don’t use getter/setter properties much because I prefer to have my logic in a separate class or service.  That’s because many times logic that may seem simple on the surface is not so simple when you start implementing it, and the scenario I gave in the previous section about only being able to change the Todo’s state when a certain condition is met is the perfect example.</p>

<p>It’s the perfect example because I only mentioned the logic that gets enforced when attempting to change the <code>Todo</code> to a <code>Complete</code> state… but, wouldn’t it make sense that if there were logic for the <code>Complete</code> state that there’d probably be logic for the other state changes as well?  In these cases, I might want to implement a design pattern called a “state machine” to represent the logic for each of these state changes as their own separate classes.  </p>

<p>Now, I’m not going to explain the details of the “state machine” design pattern here - that’s a different book entirely.  But, what I will say is that most of my state change classes are going to look a lot like this <code>TodoStateChanger</code> class:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoStateChanger</code> <code class="p">{</code>
    
    <code class="nx">constructor</code><code class="p">(</code><code class="kr">private</code> <code class="nx">newState</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">)</code> <code class="p">{</code>
    <code class="p">}</code>
    
    <code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="kr">boolean</code> <code class="p">{</code>
        <code class="k">return</code> <code class="o">!!</code><code class="nx">todo</code><code class="p">;</code>
    <code class="p">}</code>
    
    <code class="nx">changeState</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code> <code class="p">{</code>
        <code class="k">if</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="p">))</code> <code class="p">{</code>
            <code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">newState</code><code class="p">;</code>
        <code class="p">}</code>
        
        <code class="k">return</code> <code class="nx">todo</code><code class="p">;</code>
    <code class="p">}</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>The <code>TodoStateChanger</code> class accepts the desired end state as a constructor parameter on line 3, as well as two methods:  <code>canChangeState</code> and <code>changeState</code> that provide the basic workflow for changing a state.  The <code>canChangeState</code> contains basic logic to validate whether or not the <code>Todo</code> may be changed to the new desired state.  Likewise, the <code>changeState</code> method first calls the <code>canChangeState</code> method to make sure it can proceed, and if it is safe, it updates the state on the todo.</p>

<p>In a class-based language like C# or Java, I would use the <code>TodoStateChanger</code> class as my base class - creating new classes that derived from it so they could share most of its logic, but also have the ability to override behavior as they see fit.  </p>

<p>Lucky for us, not only does the ECMAScript 2015 syntax introduces the <code>class</code> keyword, it also introduces the ability for classes to inherit or “extend” from one another.  So, let’s use that syntax to create a version of the <code>TodoStateChanger</code> that implements the <code>Complete</code> state change that I previously implemented in the getter/setter example.</p>

<p>The first thing to do is to create the new class that is going to extend from the <code>TodoStateChanger</code> class.  Since I’m using it to execute the <code>Complete</code> state change, I’ll call it <code>CompleteTodoStateChanger</code> and start by defining it as a regular old class:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">CompleteTodoStateChanger</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, inheriting from the <code>TodoStateChanger</code> class is as simple as adding the keyword <code>extends</code> after the class name, followed by the name of the class that I’d like to extend.  In order case, this class is called <code>TodoStateChanger</code>.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">CompleteTodoStateChanger</code> <code class="kr">extends</code> <code class="nx">TodoStateChanger</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Technically speaking, that’s all you have to do to inherit from a class - now we have a brand new class named <code>CompleteTodoStateChanger</code> that contains all of the behavior defined on the <code>TodoStateChanger</code> base class.  But, usually the reason for inheriting from a base class is to extend and/or override its behavior, which is exactly what we want to do here.</p>

<p>I’ll start with the constructor function.  In some other statically-typed languages like C#, whenever you derive from a class that has a constructor with a parameter, you must explicitly define your own constructor in the derived class.  In other words, if we were trying to implement this same example in C#, I’d have to give <code>CompleteTodoStateChanger</code> a constructor.</p>

<p>Luckily, that’s actually not true in JavaScript.  If you choose to derive from a class that has a constructor and then choose to not create a constructor of your own, you simply inherit the constructor from the base class.</p>

<p>In other words, this would be perfectly valid given the code we’re looking at right now:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">changer</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">CompleteTodoStateChanger</code><code class="p">(</code><code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code><code class="p">);</code>
</pre></div>

</figure>

<p>That’s great for a lot of scenarios, but not for this scenario.  In this scenario it doesn’t make sense to set the new todo state with anything but <code>Complete</code>, so I’ll give the <code>CompleteTodoStateChanger</code> its own constructor that does not allow the ability to pass in a todo state:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>However, there are two problems with this implementation:</p>

<ol class="numeric">
  <li>You don’t have to declare a constructor on a derived class, but every time you do, you have to call the constructor on the base class, and </li>
  <li>In this particular case, we want to call the constructor on the base class anyway, to pass in the <code>Complete</code> <code>TodoState</code>
</li>
</ol>

<p>If I hover over the constructor function to see the error TypeScript is giving, I see that it’s actually telling us exactly what I just said, but also a tip:</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Classes----super-error.png" alt="super() error">
  <figcaption>super() error</figcaption>
</figure>


<p>It’s saying that the way to call the constructor on the base class is the <code>super</code> function.  So, I’ll go ahead and add a call to the <code>super</code> function like it says.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Classes----super-tooltip.png" alt="super() IntelliSense">
  <figcaption>super() IntelliSense</figcaption>
</figure>


<p>Notice how TypeScript gives me full IntelliSense on the <code>super()</code> function because it knows that I’m attempting to call the constructor on the <code>TodoStateChanger</code> base class.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
    <code class="kr">super</code><code class="p">(</code><code class="nx">TodoState</code><code class="p">.</code><code class="nx">Complete</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Ok, so now that I’ve called the constructor on the base class and told it that I always want to change the state to <code>Complete</code>, let’s override the behavior of the base class to enforce the fact that <code>Todo</code>’s must be in the <code>Active</code> or <code>Deleted</code> state in order to be eligible to change state to <code>Complete</code>.  In other words, I want to override the logic in the <code>canChangeState</code> method on the <code>TodoStateChanger</code> base class, and I do that by simply creating a method with the same signature.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="kr">boolean</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Notice how I don’t have to use any special keywords like <code>override</code> or <code>new</code> tell TypeScript that I’m overriding the method like I would have to do with C# or other languages - I just go ahead and write the new method.</p>

<p>Now that I have this method in place, let me start by just reproducing the base class behavior – in other words, I don’t want to override all of the logic in the base method, I just want to extend it a little bit.  I can accomplish this by using the <code>super</code> keyword again, only this time <code>super</code> is the base class object as opposed to the base class constructor, so I can use it like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="kr">boolean</code> <code class="p">{</code>
    <code class="k">return</code> <code class="kr">super</code><code class="p">.</code><code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>The <code>super</code> object is a reference that allows me to continue to access methods defined in the base class even though I’m overriding them.</p>

<p>With all this in place, I can go ahead and add the logic that’s specific to the <code>Complete</code> state transition, specifically making sure that the <code>Todo</code> is either <code>Active</code> or <code>Deleted</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="kr">boolean</code> <code class="p">{</code>
    <code class="k">return</code> <code class="kr">super</code><code class="p">.</code><code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="o">&amp;&amp;</code> <code class="p">(</code>
            <code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Active</code>
        <code class="o">||</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Deleted</code>
    <code class="p">);</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>And that is how you inherit from a base class in TypeScript!  Actually, once again, everything in this example other than the static type information is really just ECMAScript 2015 syntax - even the <code>extends</code> keyword.  However, one of the things that JavaScript and ECMAScript 2015 does not support is the ability to define and inherit from abstract base classes – or base classes that are only defined in order to act as base classes and never actually meant to be instantiated by themselves.  Luckily, TypeScript does support abstract classes, and if you check out the next section, I’ll show you how to implement them!</p>

<h3 id="abstract-class">Implementing an abstract class</h3>

<p>In the previous section, I showed you how to use the ECMAScript 2015 class syntax to create an inherit from a base class in order to share behavior between classes.  And, I left off in that section by pointing out that even though ECMAScript 2015 doesn’t support the idea of abstract base classes, TypeScript does!  In this section, I’ll show you how to use TypeScript to implement the power concept of abstract base classes in JavaScript.</p>

<p>Let’s do a quick recap:  in the last section, I defined two classes:  <code>TodoStateChanger</code>, and <code>CompleteTodoStateChanger</code>, which derived from <code>TodoStateChanger</code>.  Since both of these were defined as classes, that means that I could create an instance of <code>TodoStateChanger</code> directly if I wanted to – there’s nothing stopping me from doing that right now.  However, let’s say that my intent was that this class was only ever intended to serve as a base class and never instantiated directly.</p>

<p>Luckily, TypeScript offers the <code>abstract</code> keyword to help me express that intent.  By simply placing the <code>abstract</code> keyword in front of the class definition like this…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">abstract</code> <code class="kr">class</code> <code class="nx">TodoStateChanger</code> <code class="p">{</code>
</pre></div>

</figure>

<p>I can still derive from the class, but TypeScript will consider it an error any time I try to instantiate that class anywhere in my code.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">new</code> <code class="nx">TodoStateChanger</code><code class="p">();</code>
</pre></div>

</figure>

<p>What’s more, I can express my intent even more by describing any member of the class as abstract simply by applying the <code>abstract</code> keyword in front of it as well.</p>

<p>For example, let’s say that while I do want the <code>TodoStateChanger</code> to define the shared behavior in the <code>changeState</code> method, I want to force every derived class to implement their own <code>canChangeState</code> method from scratch, and not even implement the basic logic that I currently have.  In order to accomplish that, I simply add the <code>abstract</code> keyword to the beginning of the method:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">abstract</code> <code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="kr">boolean</code> <code class="p">{</code>
</pre></div>

</figure>

<p>When I do that, of course, the implementation is no longer needed, so I can simply remove it:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">abstract</code> <code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="kr">boolean</code><code class="p">;</code>
</pre></div>

</figure>

<p>Now TypeScript will enforce my intent that every derived class must implement its own <code>canChangeState</code> method.  Of course, the derived class I’ve already created - <code>CompleteTodoStateChanger</code> already does implement this method, so we’re good there… but, the current <code>canChangeState</code> implementation is referencing the base implementation… which doesn’t exist anymore!  </p>

<p>Accordingly, TypeScript is yelling at us for making a call to a method that doesn’t exist, and we can fix this by simply removing the reference:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">canChangeState</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="kr">boolean</code> <code class="p">{</code>
    <code class="k">return</code> <code class="o">!!</code><code class="nx">todo</code> <code class="o">&amp;&amp;</code> <code class="p">(</code>
            <code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Active</code>
        <code class="o">||</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Deleted</code>
    <code class="p">);</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Once I do so, everything is fine again and I have now enforced the fact that my abstract base class may only be used as a base class.  Well… throughout my TypeScript code at least.  Since this is all getting compiled down to JavaScript and sent to the browser, there’s nothing stopping some rouge JavaScript code from creating a new instance of the class, but like everything TypeScript is designed to guard me against, there’s ultimately nothing I can really do about that.  All I can do is focus on the protection that it gives at development time, and in that regard abstract base classes are an excellent tool.</p>

<h3 id="access-modifiers">Controlling visibility with access modifiers</h3>

<p>A few sections ago, I showed you how to apply the <code>private</code> keyword to a constructor parameter to automatically assign or “upgrade” that parameter to a property on the class, as I show here:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">constructor</code><code class="p">(</code><code class="kr">private</code> <code class="nx">todos</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[])</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>But, the <code>private</code> keyword isn’t just a way to create properties - if you have ever used a class-based language such as Java or C# then you might know that the <code>private</code> keyword is an access modifier, used to hide members of a class from being accessed outside of that class.</p>

<p>And, just like those other languages, you can apply access modifiers to any member of a TypeScript class.  </p>

<p>You can apply it to constructor parameters as a shortcut to automatically turn it in to a member, like I’ve already shown…</p>

<p>You can apply it to methods:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">private</code> <code class="nx">getAll</code><code class="p">()</code> <code class="p">{</code>
</pre></div>

</figure>

<p>And, you can apply it to properties (even static ones!):</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">private</code> <code class="kr">static</code> <code class="nx">lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
</pre></div>

</figure>

<p>You can also apply them to getters and setters:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">private</code> <code class="nx">get</code> <code class="nx">state</code><code class="p">()</code> <code class="p">{</code>
<code class="kr">private</code> <code class="nx">set</code> <code class="nx">state</code><code class="p">(</code><code class="nx">newState</code><code class="p">)</code>
</pre></div>

</figure>

<p>However, keep in mind that both the getter and setter must have the same access modifier applied.  In other words, TypeScript won’t let you make the setter private and the getter public (which, unfortunately, is exactly what I often want to do!).</p>

<p>Now, I’ve been applying the <code>private</code> modifier in all of my examples so far, but TypeScript actually offers three access modifiers for you to describe how much you want to protect the members of your classes:  <code>private</code>, <code>protected</code>, and <code>public</code>.</p>

<p>The <code>private</code> modifier is the most restrictive modifier of the three.  Placing the <code>private</code> modifier on a member means that only methods defined directly on the same class definition may access that member.  TypeScript will complain if any other type - including types that inherit or extend from this class - attempt to access the member.</p>

<p>Next, there’s the <code>protected</code> modifier, which is similar to the <code>private</code> modifier in that only methods defined on the same class may access the member, but expands this definition to any classes that inherit or extend from this class.   In other words, it only applies to the base class examples that I showed in the previous two sections.  And, actually, it would have been really useful for the scenario that I have been describing because right now the constructor on the <code>TodoStateChanger</code> base class sets the <code>newState</code> property, but since it’s private none of the derived classes are able to access it!</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">abstract</code> <code class="kr">class</code> <code class="nx">TodoStateChanger</code> <code class="p">{</code>
    
    <code class="nx">constructor</code><code class="p">(</code><code class="kr">private</code> <code class="nx">newState</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">)</code> <code class="p">{</code>
    <code class="p">}</code>
</pre></div>

</figure>

<p>However, if I update this to <code>protected</code>… </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">abstract</code> <code class="kr">class</code> <code class="nx">TodoStateChanger</code> <code class="p">{</code>
    
    <code class="nx">constructor</code><code class="p">(</code><code class="kr">protected</code> <code class="nx">newState</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">)</code> <code class="p">{</code>
    <code class="p">}</code>
</pre></div>

</figure>

<p>the auto-assigned <code>newState</code> property will be accessible to all derived classes, which is exactly what I’d expect to happen.</p>

<p>Finally, there’s the <code>public</code> modifier, which is the least restrictive of all.  A member with public access may be accessed from any other type.  In other words, the public modifier just describes the default JavaScript behavior, which also means that it’s the default access modifier so you probably won’t see it much.  </p>

<p>The one case you might see the public modifier more often is actually the same scenario that began this whole conversation: applying it to a constructor parameter to automatically create a property from that parameter.  </p>

<p>For example, in the getter/setter section I created a new class named <code>SmartTodo</code> that looked like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">SmartTodo</code> <code class="p">{</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>

    <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>You may have wondered at that time why I manually assigned the <code>name</code> parameter in the constructor to the <code>name</code> property on the <code>SmartTodo</code> class and didn’t use the private constructor parameter feature to define and assign the property all at once.  Well, I would have, except that at the time I’d only shown you how to use the <code>private</code> keyword to accomplish that, and if I’d have used the <code>private</code> keyword then the automatically-created <code>name</code> property would not have been accessible outside of the class!  But now that I’ve introduced the concept of access modifiers, I can revise this example to use any of the three modifiers - <code>private</code>, <code>protected</code>, or <code>public</code> - to automatically create a property with the same name and level of access.  </p>

<p>In other words, I can rewrite the <code>SmartTodo</code> constructor like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">SmartTodo</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code><code class="kr">public</code> <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
    <code class="p">}</code>
</pre></div>

</figure>

<p>Now that I’ve explained what the three modifiers mean and how to use them, I have to point out that there’s a problem with all of this, and that is that JavaScript doesn’t actually support private members.  Remember, JavaScript objects are just bags of dynamic properties, and once you add a property to the bag, that property is accessible to everyone who has access to that object, and that’s all there is to it.</p>

<p>TypeScript is a superset of JavaScript which means that it doesn’t change how JavaScript works, so how can TypeScript support private when JavaScript does not?  Well, the short answer is, it doesn’t.  Much like interfaces and specifying a type at the end of a variable or method doesn’t change how the JavaScript gets generated, the two access modifiers that TypeScript supports - private and protected - are strictly for your protection during development and have absolutely no effect at runtime in the browser.</p>

<p>But, that doesn’t mean they’re not worth using.  Keep in mind that one of the most important reasons for static typing is to express the intent of your code.  Since JavaScript has never supported the idea of private members, developers have come up with their own ways to express their intent for a property to only be used by the component itself and not by anyone else.  </p>

<p>Perhaps the most widely-used convention is to put an underscore in front of these variables, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">private</code> <code class="kr">static</code> <code class="nx">_lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
</pre></div>

</figure>

<p>Then, if you find yourself calling a member on another class whose name starts with an underscore, then you’re probably doing something wrong.  </p>

<p>And, hey, if you like that convention, feel free to keep on using it!  The only thing that TypeScript changes in this equation is that it won’t even list private members in its autocomplete options.  And, will consider it an error if you attempt to access another object’s private members.  Other than that, if you really, really want to access another object’s private members, go ahead and write the code to do so - TypeScript won’t stand in your way.  However, much like the rest of the static typing capabilities that TypeScript provides, it’s a great idea to use access modifiers to express your intent when you don’t want other components interacting directly with certain members of a type.  Even if TypeScript can’t enforce this behavior at runtime, I’ve found that enforcing it during development is good enough for all but the most exceptional scenarios.</p>

<h3 id="implementing-interfaces">Implementing interfaces</h3>

<p>In the last chapter I showed you how to define interfaces and use them to make sure that the objects you reference have the members that you expect them to. But, the primary reason that interfaces exist in a statically-typed language is to attach them to classes.  And, now that I’ve shown you how to create classes, it’s time to see just how to apply interfaces to them to make sure that they behave like we expect them to.</p>

<p>Before I show you how to apply an interface to a class, I just want to point out something that I think is pretty great:  because TypeScript understands and implements JavaScript’s native duck-typing behavior, you don’t actually have to do anything in order to make use of an interface.  By simply applying the interface to the variables and return values in which you expect that interface to be present, TypeScript will automatically inspect every object that you attempt to assign to that variable or attempt to return as the return value.  When the object’s structure matches the interface you’ve defined, then it really doesn’t matter what type the object is - everything is fine!  However, if the object’s structure does not match the interface - it is missing properties or methods that the interface expects, or the types of the properties don’t match - only then will TypeScript yell at you that you’ve attempted to use an object that doesn’t match.</p>

<p>All that said, keep in mind the overwhelming theme of this book:  even though you don’t have to apply static type information in order for TypeScript to work, the more explicit you are, the better!  In other words, even though TypeScript can figure out that that a class satisfies the needs of an interface, if you intend for that class to implement that interface then you should just go ahead and say it!</p>

<p>Throughout this book, I’ve created several interfaces and classes; in particular, the <code>ITodoService</code> interface and the <code>TodoService</code> class.  As you may have guessed by their names, I intend for the <code>TodoService</code> to implement the <code>ITodoService</code> interface, but at this point the two are not explicitly connected…  so let’s go ahead and do that now.  Luckily, that’s pretty easy to do - just use the <code>implements</code> keyword after the class name, and then the interface that the class must implement:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="kr">implements</code> <code class="nx">ITodoService</code> <code class="p">{</code>
</pre></div>

</figure>

<p>As soon as I do this, TypeScript starts to enforce the interface and gives me an error saying that the <code>TodoService</code> does not implement the <code>ITodoService</code> interface.  This is because the <code>ITodoService</code> interface defines 4 methods - <code>add</code>, <code>delete</code>, <code>getAll</code>, and <code>getById</code> - but the <code>TodoService</code> class that I showed earlier only implements the <code>add</code> and <code>getAll()</code> methods.  This is easy enough to fix by just implementing those other missing methods.  </p>

<p>First, I have to add an <code>id</code> property to the <code>Todo</code> interface so that I can reference <code>Todo</code> items by their ID.  That part’s easy.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    <code class="nx">state</code><code class="o">?:</code> <code class="nx">TodoState</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, I’ll update the <code>add</code> method to set that ID property using the <code>nextId</code> getter method that I introduced in the getter/setter section.  </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">todo</code><code class="p">.</code><code class="nx">id</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">nextId</code><code class="p">;</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>
    <code class="k">return</code> <code class="nx">todo</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>After it gives the <code>Todo</code> a unique ID, it adds it to the list of <code>Todo</code>s and then returns the <code>Todo</code> as the return value.</p>

<p>Next there’s the <code>getAll()</code> method.: </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[]</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">parse</code><code class="p">(</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">));</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>In previous examples I just let this method return the array of todos directly, but this is actually a bad practice since consumers of this method could choose to manipulate the Todo items themselves and I want to control any changes that happen to them in this class.  So, instead I’ll make a copy of the <code>Todo</code> items by serializing them to JSON and then parsing them back out again. I know that this seems like it might be expensive, but it’s actually a pretty performant way to clone objects!</p>

<p>Then there’s the <code>getById</code> method, which takes a number indicating the ID of the <code>Todo</code> item to find in the list of <code>Todo</code>s.  </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">filtered</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="nx">x</code> <code class="o">=&gt;</code> <code class="nx">x</code><code class="p">.</code><code class="nx">id</code> <code class="o">==</code> <code class="nx">todoId</code><code class="p">);</code>

    <code class="k">if</code><code class="p">(</code><code class="nx">filtered</code><code class="p">.</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="nx">filtered</code><code class="p">[</code><code class="mi">0</code><code class="p">];</code>
    <code class="p">}</code>
    
    <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>In this method l use JavaScript’s built-in Array method <code>filter</code> to filter the list down to only the <code>Todo</code> objects whose ID property matches the <code>todoId</code> value that was passed in.  Notice how I’m passing an arrow function to the <code>filter</code> method rather than typing out a full-fledged function the long way as I would have had to do in the past. If the filter method call finds at least one item, I return the first item.  Otherwise, I’ll return null.</p>

<p>Finally, there’s the <code>delete</code> method, which accepts a number indicating the ID of the <code>Todo</code> item to delete.   </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">toDelete</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
    
    <code class="kd">var</code> <code class="nx">toDeleteIndex</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">indexOf</code><code class="p">(</code><code class="nx">toDelete</code><code class="p">);</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">splice</code><code class="p">(</code><code class="nx">toDeleteIndex</code><code class="p">,</code> <code class="mi">1</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>In this method I start by calling the <code>getById</code> method to find the actual <code>Todo</code> object, then I use the JavaScript Array method <code>indexOf</code> to figure out where the object is in the array. Finally, I pass this index to the JavaScript Array method <code>splice</code> to remove the <code>Todo</code> item from the array.</p>

<p>And that’s it!  Now that I’ve implemented those methods, TypeScript is happy that I’ve satisfied all of the members of the <code>ITodoService</code> interface and stops giving me an error.  Now that I have this interface in place, if I ever change any of these methods so that it doesn’t accept the right parameters or returns the wrong type, TypeScript will be sure to let me know.</p>

<p>Also, if you’re wondering:  yes, it’s possible for a class to implement multiple interfaces at once.  When you want to specify multiple interfaces, you can add them all after the <code>implements</code> keyword, separating each one with a comma.</p>

<p>For example, if I have an interface named <code>IIdGenerator</code> that describes a type that has a <code>nextId</code> property, like this…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">IIdGenerator</code> <code class="p">{</code>
    <code class="nx">nextId</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>I can add this to my list of interfaces on the <code>TodoService</code> class like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="kr">implements</code> <code class="nx">ITodoService</code><code class="p">,</code> <code class="nx">IIdGenerator</code> <code class="p">{</code>
</pre></div>

</figure>

<p>Then, of course, I have to implement this interface, but since the <code>TodoService</code> already has a <code>nextId</code> property it already implements the interface so there is nothing to be done and TypeScript is happy.</p>

<p>And that wraps up the chapter on classes!  At this point in the book, I’ve shown you the majority of the features and syntax that you’re likely to consistently leverage while using TypeScript.  The remainder of this book is going to dive deeper into some of the more advanced features that TypeScript provides, but I think you’ll actually be quite surprised with how much just these few features can bring meaning and structure to your application code so it’s important that you understand everything that I’ve described up to this point if you’re going to start working with TypeScript on a daily basis.  That’s not to say that the advanced features I’m going to show you in the rest of the book are unnecessary or irrelevant – quite the contrary!  Consider these features to be the icing on the cake - they may not be required, but including them makes everything so much better!</p>

<h2 id="leanpub-auto-generics">
<span class="section-number">8. </span>Generics</h2>

<h3 id="leanpub-auto-creating-generic-functions">Creating generic functions</h3>

<p>So far in this book I’ve showed you how to use TypeScript to implement a number of object-oriented principles in JavaScript – principles that are generally reserved for statically-typed languages such as C# and Java.  But, not only does TypeScript allow you to implement concepts like encapsulation and inheritance of an abstract base class, there is one more powerful feature that both Java and C# offer that TypeScript offers as well, and that is generics.</p>

<p>Generics are a way to create functions and classes that define a behavior that can be reused across many different types while retaining the full information about that type.</p>

<p>For example, take this function, which clones an object using the JSON API to serialize the object to a JSON string and then deserialize it back into a new instance of the same object:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">clone</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
	<code class="kd">let</code> <code class="nx">serialized</code> <code class="o">=</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
	<code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">parse</code><code class="p">(</code><code class="nx">serialized</code><code class="p">);</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now, looking at this we can see that if it works as I just described then the return value of this function should return the exact same type of object that passed in.  In other words, the return value should be the same type as the “value” object.</p>

<p>However, since the JSON.parse API accepts a string that can represent any type of object, there is absolutely no way for it - or TypeScript - to even guess at what type of object is going to come out when that string is serialized.  It could literally be any type at all.</p>

<p>By applying generics to this function we can solve two problems at once:   not only can we give TYpeScript the type information that it needs in order to determine the return type, we can also reuse this same exact code for any and all types in our application!</p>

<p>The syntax for defining a generic function is pretty straight-forward:  you simply add “greater-than” and “less-than” signs right after the function name, but before the parentheses containing the parameter list, and give your generic type parameter a name, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">clone</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">value</code><code class="p">)</code> <code class="p">{</code>
</pre></div>

</figure>

<p>What this syntax does is tell TypeScript that you will be referring to a generic type in this function and you’ll be referring to the type by the name “T”.
Note that I’m using the name “T” here simply because that’s the name that many people use by convention, but you can feel free to give it any valid variable name that you like, for instance: “X”, or “Tinput”.</p>

<p>With this generic type defined, I can use it throughout this method any place I’d use a regular type name:  like on the “value” parameter, for instance:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">clone</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">value</code><code class="o">:</code> <code class="nx">T</code><code class="p">)</code> <code class="p">{</code>
</pre></div>

</figure>

<p>Now when I hover over the “value” parameter to see its type information, I can see that TypeScript thinks it’s type is “T”.
And, the whole point of using it in this example is to tell TypeScript that the return type will always be the same as the input type, so I’ll specify “T” as the return type as well:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">clone</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">value</code><code class="o">:</code> <code class="nx">T</code><code class="p">)</code><code class="o">:</code> <code class="nx">T</code> <code class="p">{</code>
</pre></div>

</figure>

<p>What is “T”?  Well, it’s the type of the parameter that you pass as the “value”, of course!  In other words, “T” is not any specific type at all, but is determined by TypeScript each and every time you call this function, and solely depends on how you use the function…</p>

<p>For example, when I pass in a string as the value…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">clone</code><code class="p">(</code><code class="s2">"Hello!"</code><code class="p">)</code>
</pre></div>

</figure>

<p>“T” is the string type.</p>

<p>Or, when I pass in a number…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">clone</code><code class="p">(</code><code class="mi">41</code><code class="p">)</code>
</pre></div>

</figure>

<p>“T” is the number type.</p>

<p>And, of course, it works with custom types as well:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="p">{</code> 
    <code class="nx">id</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code> 
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Pick up drycleaning'</code><code class="p">,</code> 
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">Active</code> 
<code class="p">};</code>

<code class="nx">clone</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code>
</pre></div>

</figure>

<p>Here’s where it gets interesting though…  What’s the return value when I pass in an object literal that has a “name” property?</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">clone</code><code class="p">({</code> <code class="nx">name</code><code class="o">:</code> <code class="s1">'Jess'</code> <code class="p">})</code>
</pre></div>

</figure>

<p>Well, TypeScript is smart enough to tell me that it’s an unnamed type that has a name property!  Pretty cool, huh?</p>

<p>Even though this example may seem simple, don’t let it fool you:  generics are an incredibly powerful and useful tool in the right situations.  So, whenever you see a place in your application that you seem to be copying the same code over and over again, and all you’re doing differently in each version is simply changing which type name you’re using, then that might be a great opportunity to reduce that duplicated code into a single generic function.</p>

<h3 id="leanpub-auto-creating-generic-classes">Creating generic classes</h3>

<p>In the previous section, I introduced you to the concept of generics and showed you how to use them to define the input and output types of a function.  But, functions aren’t the only place where generic types can come in handy - you can apply them to classes, too!</p>

<p>In fact, you’ve already seen a generic class in action, you just didn’t realize it at the time.  Among other classes, TypeScript treats the built-in JavaScript Array type as a generic class.  In other words, in previous chapters I used this syntax to indicate an array of number values:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">array</code><code class="o">:</code> <code class="nx">number</code><code class="p">[]</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">];</code>
</pre></div>

</figure>

<p>But you can also use this syntax as another way of writing the same thing:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">array</code><code class="o">:</code> <code class="nb">Array</code><code class="o">&lt;</code><code class="nb">Number</code><code class="o">&gt;</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">];</code>
</pre></div>

</figure>

<p>Note that in this example these two syntaxes are actually representing the exact same thing so they are completely functionally equivalent.  It just so happens I like to use the first syntax, but as this example proves, you can choose whichever syntax you prefer!</p>

<p>Similar to the generic Array type, one of the best scenarios I’ve seen generics come in handy is the typed Key/Value pair class which contains two properties - a key and a value property, and looks like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">TKey</code><code class="p">,</code> <code class="nx">TValue</code><code class="o">&gt;</code> <code class="p">{</code>
    <code class="nx">constructor</code><code class="p">(</code>
        <code class="kr">public</code> <code class="nx">key</code><code class="o">:</code> <code class="nx">TKey</code><code class="p">,</code> 
        <code class="kr">public</code> <code class="nx">value</code><code class="o">:</code> <code class="nx">TValue</code>
    <code class="p">)</code> <code class="p">{</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Notice how in this class accepts two generic type parameters - TKey, and Tvalue - each separated by a string.  In fact, technically speaking, you can define as many generic types as you need, however you generally don’t tend to go over two.</p>

<p>With this class in place, I can create instances of the key/value pair object using any two types of values I want:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">pair1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePair</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="s1">'First'</code><code class="p">);</code>
<code class="kd">let</code> <code class="nx">pair2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePair</code><code class="p">(</code><code class="s1">'Second'</code><code class="p">,</code> <code class="nb">Date</code><code class="p">.</code><code class="nx">now</code><code class="p">());</code>
<code class="kd">let</code> <code class="nx">pair3</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePair</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="s1">'Third'</code><code class="p">);</code>
</pre></div>

</figure>

<p>If I hover over each of these instances, I can see that TypeScript is inferring the generic type parameters based on the values that I passed in.
For instance, it knows pair1 and pair3 are instances of KeyValuePair&lt;number, string&gt; because I passed in a number and a string value as the first and second parameter for each.
Likewise, it knows that pair2 is an instance of KeyValue&lt;string, Date&gt; because I passed in a string value and a Date as the first and second parameters.</p>

<p>If I wanted to, I could explicitly tell TypeScript which types I wanted by applying the same generic type syntax as I did to the class, only instead of the generic type parameter names “Tkey” and “Tvalue” I’ll use the names of the actual types that I want, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">pair1</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">number</code><code class="p">,</code> <code class="nx">string</code><code class="o">&gt;</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="s1">'First'</code><code class="p">);</code>
<code class="kd">let</code> <code class="nx">pair2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">string</code><code class="p">,</code> <code class="nb">Date</code><code class="o">&gt;</code><code class="p">(</code><code class="s1">'Second'</code><code class="p">,</code> <code class="nb">Date</code><code class="p">.</code><code class="nx">now</code><code class="p">());</code>
<code class="kd">let</code> <code class="nx">pair3</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">number</code><code class="p">,</code> <code class="nx">string</code><code class="o">&gt;</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="s1">'Third'</code><code class="p">);</code>
</pre></div>

</figure>

<p>And, look at that - by explicitly defining the types that I intended I actually caught a bug in my code when I defined pair2.  Oddly enough, the JavaScript Date.now() function doesn’t actually return a Date object – it returns  the number of milliseconds elapsed since 1 January 1970!  So, I have to take that number and turn it into a Date and everything is fine again:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">pair2</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">string</code><code class="p">,</code> <code class="nb">Date</code><code class="o">&gt;</code><code class="p">(</code><code class="s1">'Second'</code><code class="p">,</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="nb">Date</code><code class="p">.</code><code class="nx">now</code><code class="p">()));</code>
</pre></div>

</figure>

<p>Now that I have my variables I can begin using them.  And, the cool thing is that since the types are determined on the fly and TypeScript will remember what those generic type parameters were through the rest of my code:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">pair2</code><code class="p">.</code><code class="nx">key</code><code class="p">.[</code><code class="nx">AUTOCOMPLETE</code><code class="p">]</code>
</pre></div>

</figure>

<p>So when I attempt to access them later I continue to get full type support, like I can see here that I am getting this list of string members on the key value that I had passed as a string.</p>

<p>This kind of approach is one way that you can use generic classes, but it gets even more interesting.  Now that I’ve defined a generic Key/Value pair type, I can also define a class that can interact with any instances of that type.</p>

<p>For example, I can create a generic class that iterates through a collection of any type of KeyValuePair objects and prints them out to the console:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">KeyValuePairPrinter</code><code class="o">&lt;</code><code class="nx">T</code><code class="p">,</code> <code class="nx">U</code><code class="o">&gt;</code> <code class="p">{</code>
    
    <code class="nx">constructor</code><code class="p">(</code><code class="kr">private</code> <code class="nx">pairs</code><code class="o">:</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">T</code><code class="p">,</code> <code class="nx">U</code><code class="o">&gt;</code><code class="p">[])</code> <code class="p">{</code>
    <code class="p">}</code>
    
    <code class="nx">print</code><code class="p">()</code> <code class="p">{</code>
        
        <code class="k">for</code><code class="p">(</code> <code class="kd">let</code> <code class="nx">p</code> <code class="k">of</code> <code class="k">this</code><code class="p">.</code><code class="nx">pairs</code> <code class="p">)</code> <code class="p">{</code>
            <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">p</code><code class="p">.</code><code class="nx">key</code><code class="si">}</code><code class="sb">: </code><code class="si">${</code><code class="nx">p</code><code class="p">.</code><code class="nx">value</code><code class="si">}</code><code class="sb">`</code><code class="p">);</code>
        <code class="p">}</code>
        
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>I start by passing in two generic type parameters to the class (just like I did with the KeyValuePair class itself) on line XX, which I call “T” and “U”.</p>

<p>Then, I define a constructor that accepts an array of KeyValuePairs that all share the same two types “T” and “U”.</p>

<p>And in that method I iterate through each KeyValuePair and print out their “key” and “value” properties on line XX. </p>

<p>Even though printing the values to the output may not be too compelling of a scenario, the interesting thing about this example is that I have statically-typed access to the objects “key” and “value” properties - regardless of what types “T” and “U” are - because I know that they are all “KeyValuePair” objects!</p>

<p>Now let’s see it in action:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">printer</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePairPrinter</code><code class="p">([</code> <code class="nx">pair1</code><code class="p">,</code> <code class="nx">pair3</code> <code class="p">]);</code>
<code class="nx">printer</code><code class="p">.</code><code class="nx">print</code><code class="p">();</code>
</pre></div>

</figure>

<p>In this example, I create a new instance of the printer and use it to print out two KeyValuePair objects.
Notice that I’m only passing in the pair1 and pair3 variables.  This is because they share the same key and value types - in other words, they both have a number for a key and a string for a value.  And, because they share those same values, those are the types that TypeScript uses as the types for the “T” and “U” generic type parameters.  </p>

<p>In other words, TypeScript now knows that this printer object is an instance of KeyValuePairPrinter&lt;number, string&gt;   [hover over printer variable] and therefore only accepts KeyValuePairs with the generic parameters of number and string.</p>

<p>On the other hand, if I tried to pass in “pair2”, TypeScript would give me an error, warning me that pair2 does not share the same type as pair1 and pair3:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">printer</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">KeyValuePairPrinter</code><code class="p">([</code> <code class="nx">pair1</code><code class="p">,</code> <code class="nx">pair2</code><code class="p">,</code> <code class="nx">pair3</code> <code class="p">]);</code>
</pre></div>

</figure>

<p>This is because pair2 doesn’t share the same generic type parameters - its key is a string and its value is a Date. And, since it has different generic type parameters it is, for all intents and purposes, a completely different type of object altogether.</p>

<p>If generic classes seem a little overwhelming at first, I don’t blame you - I was a little overwhelmed with them, too.  But, they are a great way to group generic methods that all operate on the same types of objects.</p>

<p>And, now that you’ve seen generic classes in action, check out the next section where I’ll show you how to place constraints on your generic types to limit the type parameters that consumers of your generic functions or classes can apply.</p>

<h3 id="leanpub-auto-creating-generic-constraints">Creating generic constraints</h3>

<p>In the previous few sections I introduced you to generics and showed you how to apply them to both functions and classes.  In this section, I’m going to show you some of the more advanced things that you can do with generic type parameters to control how consumers of your generic functions and classes can use them.</p>

<p>First, let me jump back to an example that I showed a few chapters ago:  the “totalLength” function that adds the “length” property of two objects together:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="p">{</code> <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> <code class="p">},</code> <code class="nx">y</code><code class="o">:</code> <code class="p">{</code> <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> <code class="p">})</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>As I mentioned when I last showed this example, the way this method is currently implemented there’s nothing stopping me from trying to add the length of a string value to the length of an array value… which makes absolutely no sense:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">length</code> <code class="o">=</code> <code class="nx">totalLength</code><code class="p">(</code><code class="s1">'Jess'</code><code class="p">,</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code>
</pre></div>

</figure>

<p>However, over the past few sections I showed you how to use generic type parameters to define a type in a generic way and then apply that type throughout your function or class.  In other words, I can force consumers of this method to pass in two values of the same type but replacing the anonymous types with generic types:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">T</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">T</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>By doing that, I’ve solved one problem, but I’ve created another:  I’ve removed the type information saying that the type T must have a length property on it!  Luckily, TypeScript offers the concept of generic constraints that I can apply to my generic type parameters to restrict the kinds of values that satisfy those parameters.</p>

<p>The generic constraint syntax is simple.  In fact, it involves a keyword you’ve already seen.  In order to constraint the types that satisfy a generic type parameter, I simply follow the parameter with the “extends” keyword, followed by the type describing the constraint that I want to put in place.</p>

<p>For example, before I just added the generic type parameter to the “totalLength” method, it only accepted objects that had a “length” field.  To apply that same constraint to the generic type parameter, I simply use the anonymous type again:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="o">&lt;</code><code class="nx">T</code> <code class="kr">extends</code> <code class="p">{</code> <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> <code class="p">}</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">T</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">T</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With this constraint in place, I finally have everything I want:  a method with code that supports a myriad scenarios, but also enforcing the fact that you can’t add the lengths of two completely unrelated types!</p>

<p>And, of course, I don’t have to use anonymous types as my generic type constraints - any type will do, including interfaces, classes, or even primitive types.  For instance, I can move this anonymous type into a formal interface if I wanted to:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">IHaveALength</code> <code class="p">{</code> 
    <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> 
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">totalLength</code><code class="o">&lt;</code><code class="nx">T</code> <code class="kr">extends</code> <code class="nx">IHaveALength</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">T</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">T</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">total</code><code class="o">:</code> <code class="nx">number</code> <code class="o">=</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
    <code class="k">return</code> <code class="nx">total</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Using an interface instead of the anonymous type may be a different syntax, but it works out to be the same exact constraint.</p>

<p>That’s the basic overview of generic type constraints, but there are a few caveats to keep in mind…</p>

<p>First, I have to clarify something:  for the past few minutes I’ve been saying that both parameters in this example must be of the same type - type “T”.  But that’s not strictly true - they can be any type that is compatible with type T, including those types that inherit from it.</p>

<p>For example, let’s say that I use the method to add two arrays together:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">length</code> <code class="o">=</code> <code class="nx">totalLength</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code>
</pre></div>

</figure>

<p>That’s fine - nothing new there.  But, how about if I create my own custom class that extends the base Array class, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">CustomArray</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code> <code class="kr">extends</code> <code class="nb">Array</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code> <code class="p">{</code>
    <code class="nx">toJson</code><code class="p">()</code><code class="o">:</code> <code class="nx">string</code> <code class="p">{</code>
        <code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Well, because it inherits from the Array class, it is an instance of the Array class, so it matches the same generic type parameter “T”:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">length</code> <code class="o">=</code> <code class="nx">totalLength</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code> <code class="k">new</code> <code class="nx">CustomArray</code><code class="o">&lt;</code><code class="nx">number</code><code class="o">&gt;</code><code class="p">())</code>
</pre></div>

</figure>

<p>There’s a second caveat with generic type constraints and unfortunately this one’s not as nice a surprise as the fact that I can use inherited types to satisfy the same generic type.  In fact, it’s a little bit of the opposite…</p>

<p>Remember in the last section when I created the “KeyValuePairPrinter”?</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">KeyValuePairPrinter</code><code class="o">&lt;</code><code class="nx">T</code><code class="p">,</code> <code class="nx">U</code><code class="o">&gt;</code>  <code class="p">{</code>
    
    <code class="nx">constructor</code><code class="p">(</code><code class="kr">private</code> <code class="nx">pairs</code><code class="o">:</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">T</code><code class="p">,</code> <code class="nx">U</code><code class="o">&gt;</code><code class="p">[])</code> <code class="p">{</code>
    <code class="p">}</code>
    
    <code class="nx">print</code><code class="p">()</code> <code class="p">{</code>
        
        <code class="k">for</code> <code class="p">(</code> <code class="kd">let</code> <code class="nx">p</code> <code class="k">of</code> <code class="k">this</code><code class="p">.</code><code class="nx">pairs</code> <code class="p">)</code> <code class="p">{</code>
            <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">p</code><code class="p">.</code><code class="nx">key</code><code class="si">}</code><code class="sb">: </code><code class="si">${</code><code class="nx">p</code><code class="p">.</code><code class="nx">value</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code>
        <code class="p">}</code>
    <code class="p">}</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>When I showed you that class, did you find it a little awkward that I defined the generic types T and U on the class, and then the only place I used them was to pass them along to define the generic types on the KeyValuePair object?  I found it awkward.  </p>

<p>Frankly, I would have rather included the <code>KeyValuePair</code> type in the class’s type constraint somehow…  Something like this, maybe:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">KeyValuePairPrinter</code><code class="o">&lt;</code><code class="nx">V</code> <code class="kr">extends</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">T</code><code class="p">,</code> <code class="nx">U</code><code class="o">&gt;&gt;</code>
</pre></div>

</figure>

<p>But, if I try to do that, TypeScript tells me that it doesn’t know about the types U and V because they weren’t declared.
Ok, that’s fair.  So how about this?</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">KeyValuePairPrinter</code><code class="o">&lt;</code><code class="nx">T</code><code class="p">,</code> <code class="nx">U</code><code class="p">,</code> <code class="nx">V</code> <code class="kr">extends</code> <code class="nx">KeyValuePair</code><code class="o">&lt;</code><code class="nx">T</code><code class="p">,</code> <code class="nx">U</code><code class="o">&gt;&gt;</code>
</pre></div>

</figure>

<p>Sadly, that doesn’t work, either, because - as TypeScript reminds me in its warning - you’re not allowed to refer to generic parameters that you define in the same type list…  Ah well, I guess the original way was really the best I could’ve done…</p>

<p>However, don’t let these kinds of limitations discourage you from using generics or even generic constraints.  Used in the right way on the right problems, generic functions and classes can elevate your code from good to elegant.</p>

<p>And, speaking of elegant code, why don’t you head on to the next chapter where I’ll introduce you to another powerful concept:  modules.</p>

<h2 id="leanpub-auto-modules">
<span class="section-number">9. </span>Modules</h2>

<p>JavaScript has been around a long time - over 20 years, as of the writing of this book!  And, only in recent years has the industry really started to take JavaScript seriously and started to apply patterns, practices, and development standards when working in the browser.  A few sections ago, I pointed out the problem that is still chief among the issues that lingers today - putting all of your code in the global namespace.</p>

<p>Putting all your code in the global namespace encourages you to create all sorts of dependencies between components simply because you can.  You need to share a value between to classes?  Put it into a global variable!  Why not - both components have access to it, right?</p>

<p>This kind of coding practice produces something that is affectionately nick-named “spaghetti code” because your entire application just becomes one giant ball of intertwined threads without any way of telling where one component ends and another begins.</p>

<p>To avoid spaghetti code, many first-class languages have some kind of mechanism to modularize code - to keep components separate from one another, and distinguish between two components that may share the same name but are otherwise completely different.</p>

<p>Given the absence of any JavaScript syntax prior to ECMAScript 2015 to support the modularization of code, the development community had to get creative and come up with a variety of design patterns to both encapsulate the internal workings of components and help organize growing codebases.</p>

<p>Among the many great resources that define these patterns is the book “Learning JavaScript Design Patterns” by Addy Osmani.  The physical version of this book is available for purchase, however you can find the entire manuscript for free online - just check the course notes for the link.</p>

<p>In this book, Addy discusses several concepts that are particularly relevant when it comes to modularizing and organizing JavaScript codebases.  The first is two different design patterns - the module pattern and the revealing module pattern.  The next is the relatively simple and straight-forward concept of namespaces.  And, the third is the slightly more complex concept of modules and module loaders.</p>

<p>In the rest of this chapter, I will explain all of these concepts to you, as well as show you how ECMAScript 2015 and TypeScript enable you to implement these best practices in your current codebases.</p>

<p>So, if you’re interested in learning about how to organize your code, check out the next chapter where I will introduce you to the simplest modularization concept: <strong>namespaces</strong>.</p>

<h3 id="leanpub-auto-organizing-your-code-with-namespaces">Organizing Your Code with Namespaces</h3>

<p>In the previous section, I mentioned that TypeScript offers a few ways to better encapsulate and organize your code.  In this section I’m going to show you the simplest of the techniques called “namespaces”.<br>
Many modern programming language have a concept of namespaces - C, C++, Java, and C#, to name just a few - and the reason that namespaces are so popular is because they are an excellent way to avoid naming collisions and refer to a group of types as one organizational unit.</p>

<p>And, if you’ve used C, C++, and C# the TypeScript namespace syntax should feel incredibly familiar to you.  It’s simply the keyword <code>namespace</code>, followed by the name of the namespace - any valid JavaScript variable name will do.  For example:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">Model</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Or, if you like you can add some periods to add a hierarchy of namespaces all at once:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now, let’s take a look at the code that is generated when you do this:</p>

<figure class="code">
  <figcaption>‘Model.ts’</figcaption>

<div class="highlight"><pre><code></code>
</pre></div>

</figure>

<p>Well, actually, it’s nothing…  Since there is no code in the namespace it has no functional effect so TypeScript simply ignores it when it comes to compiling the code to JavaScript.</p>

<p>So, I’ll add some code.  Let’s start by moving the Todo interface in there:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="p">{</code>
    <code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
        <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
        <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
        <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>If I look again, there’s still no code generated since interfaces also have no functional effect and get ignored.  </p>

<figure class="code">
  <figcaption>‘Model.ts’</figcaption>

<div class="highlight"><pre><code></code>
</pre></div>

</figure>

<p>So, now I’ll get serious and add an enum which does require code to interact with at runtime:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="p">{</code>

    <code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
        <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
        <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
        <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
        <code class="nx">New</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
        <code class="nx">Active</code><code class="p">,</code>
        <code class="nx">Complete</code><code class="p">,</code>
        <code class="nx">Deleted</code>
    <code class="p">}</code>
   
<code class="p">}</code>
</pre></div>

</figure>

<p>Which generates the following:  </p>

<figure class="code">
  <figcaption>‘Model.js’</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">TodoApp</code><code class="p">;</code>
<code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">TodoApp</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">Model</code><code class="p">;</code>
    <code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">Model</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">TodoState</code><code class="p">;</code>
        <code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">TodoState</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"New"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">1</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"New"</code><code class="p">;</code>
            <code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"Active"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">2</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Active"</code><code class="p">;</code>
            <code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"Complete"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">3</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Complete"</code><code class="p">;</code>
            <code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"Deleted"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">4</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"Deleted"</code><code class="p">;</code>
        <code class="p">})(</code><code class="nx">TodoState</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoState</code> <code class="o">=</code> <code class="p">{}));</code>
    <code class="p">})(</code><code class="nx">Model</code> <code class="o">=</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="o">=</code> <code class="p">{}));</code>
<code class="p">})(</code><code class="nx">TodoApp</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoApp</code> <code class="o">=</code> <code class="p">{}));</code>
</pre></div>

</figure>

<p>Note that you are free to declare the same namespace multiple times, either in the same file or throughout multiple files, allowing you to organize your code however you like.</p>

<p>For example, I can split the <code>TodoApp.Model</code> namespace definition up into two parts:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="p">{</code>

    <code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
        <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
        <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
        <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
    <code class="p">}</code>

<code class="p">}</code>

<code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="p">{</code>
    
    <code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
        <code class="nx">New</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
        <code class="nx">Active</code><code class="p">,</code>
        <code class="nx">Complete</code><code class="p">,</code>
        <code class="nx">Deleted</code>
    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>Or, I can even define a whole new namespace in the same file:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">DataAccess</code> <code class="p">{</code>
    
    <code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
        <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
        <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
        <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
        <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>Notice how - as soon as I put these types into their own namespace declarations - TypeScript begins to warn me that it doesn’t know about the <code>Todo</code> type in the ITodoService interface definition.  In the next section I’ll get into the technical explanation as to why that happens even when two types share the same namespace, but the short answer is because in order to use types outside of the scope that you define them in, you need to expose them using the <code>export</code> keyword, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>

<code class="kr">export</code> <code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>

<code class="kr">export</code> <code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
</pre></div>

</figure>

<p>Now, that helps clean up reference between Todo and TodoState because they are in the same namespace, but I still have an issue when I try to refer to types across namespaces even when I export them, as is the case where the <code>ITodoService</code> in the <code>TodoApp.DataAccess</code> namespace is trying to refer to the <code>Todo</code> type in the <code>TodoApp.Model</code> namespace.</p>

<p>This is because I’m still referring to the global type <code>Todo</code>, which no longer exists.<br>
It no longer exists because I took it out of the global scope when I moved it into its own namespace – which is the whole point of applying a namespace.  Going forward, I now have to refer to it by it’s fully-qualified name, including the namespace.</p>

<p>In our example that means changing all references of <code>Todo</code> to <code>TodoApp.Model.Todo</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
  <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
  <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
  <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">[];</code>
  <code class="nx">sgetById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Alternatively, I can create an alias for the namespace or the type by using the <code>import</code> statement in my namespace declaration to <code>import</code> a type from another namespace:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">DataAccess</code> <code class="p">{</code>
    
    <code class="kr">import</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>

    <code class="kr">export</code> <code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
      <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
      <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
      <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
      <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>Either approach works just fine, and it’s up to you which approach you want to you for any given scenario.  The general rule of thumb that I follow is to import a type or namespace if the namespace is very long or if you are going to refer to it more than a once or twice, as is the case in this example.  Likewise, whether or not you choose to import the whole namespace or just one type at a time is completely up to you.</p>

<p>In this section, I showed you how to apply TypeScript’s namespace syntax to better organize your types and get them out of the global namespace.  However, I started off the section by mentioning that organization is only one of the benefits of applying namespaces.  In the next section I’ll show you how to take advantage of the other benefit that TYpeScript namespaces provide and that is encapsulation and creating truly private variables and types.</p>

<h3 id="leanpub-auto-using-namespaces-to-encapsulate-private-members">Using namespaces to encapsulate private members</h3>

<p>In the previous section I showed you how to leverage TypeScript’s namespace syntax to better organize your application code and get it out of the global scope.  In this section, I’ll dive into how, exactly, namespaces work and how you can leverage them to define truly private variables and types.</p>

<p>I’ll start by checking out the code that gets generated when you define a TypeScript namespace.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="c1">// This...</code>
<code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="p">{</code>
	<code class="kr">export</code> <code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
		<code class="nx">New</code> <code class="o">=</code> <code class="mi">1</code>
	<code class="p">}</code>
<code class="p">}</code>

<code class="c1">// Gets generated as this:</code>
<code class="kd">var</code> <code class="nx">TodoApp</code><code class="p">;</code>
<code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">TodoApp</code><code class="p">)</code> <code class="p">{</code>
	<code class="kd">var</code> <code class="nx">Model</code><code class="p">;</code>
	<code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">Model</code><code class="p">)</code> <code class="p">{</code>
		<code class="kd">var</code> <code class="nx">TodoState</code><code class="p">;</code>
		<code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">TodoState</code><code class="p">)</code> <code class="p">{</code>
			<code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"New"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">1</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"New"</code><code class="p">;</code>
		<code class="p">})(</code><code class="nx">TodoState</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoState</code> <code class="o">=</code> <code class="p">{}));</code>
		<code class="nx">Model</code><code class="p">.</code><code class="nx">TodoState</code> <code class="o">=</code> <code class="nx">TodoState</code><code class="p">;</code>
	<code class="p">})(</code><code class="nx">Model</code> <code class="o">=</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="o">=</code> <code class="p">{}));</code>
<code class="p">})(</code><code class="nx">TodoApp</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoApp</code> <code class="o">=</code> <code class="p">{}));</code>
</pre></div>

</figure>

<p>Take a good look, and keep this code in mind as I introduce you to a new JavaScript design pattern called an “Immediately-Invoked Function Expression”, (or “IIFE” for short).  An IIFE is a popular pattern to encapsulate code while it executes and then choose which parts of the code will be exposed to the rest of the world by specifying them as the return value.  Its syntax is pretty straight-forward: </p>

<p>First, create a normal function:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">defineType</code><code class="p">()</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, immediately follow the function with a set of parentheses, which immediately executes the function:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">defineType</code><code class="p">()</code> <code class="p">{</code>
<code class="p">}()</code>
</pre></div>

</figure>

<p>And, most implementations wrap the function in a set of parentheses, too, just to be safe:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="p">(</code><code class="kd">function</code> <code class="nx">defineType</code><code class="p">()</code> <code class="p">{</code>
<code class="p">})()</code>
</pre></div>

</figure>

<p>You can take the IIFE approach one step further by passing an object into the function that the function may refer to.  The function then interact with that object either by referring to variables or functions on that object or building up the object by attaching additional members to it.</p>

<p>For example, I could rewrite my earlier jQuery plugin example like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">jQuery</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">version</code><code class="o">:</code> <code class="mf">1.19</code><code class="p">,</code>
    <code class="nx">fn</code><code class="o">:</code> <code class="p">{}</code>
<code class="p">};</code>

<code class="p">(</code><code class="kd">function</code> <code class="nx">createType</code><code class="p">(</code><code class="nx">$</code><code class="p">){</code>
    
    <code class="k">if</code><code class="p">(</code><code class="nx">$</code><code class="p">.</code><code class="nx">version</code> <code class="o">&lt;</code> <code class="mf">1.15</code><code class="p">)</code>
        <code class="k">throw</code> <code class="s1">'Plugin requires jQuery version 1.15+'</code>
    
    <code class="nx">$</code><code class="p">.</code><code class="nx">fn</code><code class="p">.</code><code class="nx">myPlugin</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
        <code class="c1">// plugin</code>
    <code class="p">}</code>
    
<code class="p">})(</code><code class="nx">jQuery</code><code class="p">)</code>
</pre></div>

</figure>

<p>This example starts off by defining a variable named <code>jQuery</code> and giving it two properties:  a version number and an <code>fn</code> object which I can attach custom functions to.</p>

<p>Notice how I did something a little tricky here and changed the name of the variable as it got passed in.  Outside of the IIFE, the variable is named <code>jQuery</code> and that’s the object I pass in to the function when it gets immediately invoked on line 14.  However, within my function I wanted to refer to the object using only the dollar sign, so I used the dollar sign as the name of the variable instead of calling it <code>jQuery</code>.  The name really doesn’t matter, though – even though it’s called <code>$</code> within the function and <code>jQuery</code> outside of the function, it still refers to the same exact object.</p>

<p>So, what do IIFEs have to do with TypeScript namespaces? Well, let’s go back to the code that TypeScript generated for the namespace declaration that I wrote:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">TodoApp</code><code class="p">;</code>
<code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">TodoApp</code><code class="p">)</code> <code class="p">{</code>
	<code class="kd">var</code> <code class="nx">Model</code><code class="p">;</code>
	<code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">Model</code><code class="p">)</code> <code class="p">{</code>
		<code class="kd">var</code> <code class="nx">TodoState</code><code class="p">;</code>
		<code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">TodoState</code><code class="p">)</code> <code class="p">{</code>
			<code class="nx">TodoState</code><code class="p">[</code><code class="nx">TodoState</code><code class="p">[</code><code class="s2">"New"</code><code class="p">]</code> <code class="o">=</code> <code class="mi">1</code><code class="p">]</code> <code class="o">=</code> <code class="s2">"New"</code><code class="p">;</code>
		<code class="p">})(</code><code class="nx">TodoState</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoState</code> <code class="o">=</code> <code class="p">{}));</code>
		<code class="nx">Model</code><code class="p">.</code><code class="nx">TodoState</code> <code class="o">=</code> <code class="nx">TodoState</code><code class="p">;</code>
	<code class="p">})(</code><code class="nx">Model</code> <code class="o">=</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="o">=</code> <code class="p">{}));</code>
<code class="p">})(</code><code class="nx">TodoApp</code> <code class="o">||</code> <code class="p">(</code><code class="nx">TodoApp</code> <code class="o">=</code> <code class="p">{}));</code>
</pre></div>

</figure>

<p>Even though it’s a whole lot more code, what you’re looking at here is actually just a bunch of IIFEs!  That’s right - a TypeScript namespace is really nothing more than syntactic sugar to create an IIFE!  That means that everything you write within the namespace declaration is automatically kept within the same scope and not allowed to leak out of that scope unless you explicitly expose it yourself.  </p>

<p>This is why, in the previous section, I had to apply the <code>export</code> keyword to allow the <code>Todo</code> interface to reference the TodoState enum:  even though they belonged to the same namespace, they were declared in two different namespace declarations and were private by default.
The way the <code>export</code> keyword works is that it tells TypeScript to attach the type to the namespace object so that it can be accessed anywhere in the application - even in other declarations of the same namespace.</p>

<p>To really understand what’s happening, let’s walk through the generated code, line by line:</p>

<ol class="numeric">
  <li>The first thing to notice is that TypeScript generates the global object to hold the top-level namespace.  In our example, this the <code>TodoApp</code> variable on line 1.  </li>
  <li>The declaration of the global variable on line 1 is then followed by the beginning of the IIFE on line.  I’ll get into the guts of the IFFE next, but for now I’ll jump all the way to line 13, where the IIFE ends and is immediately invoked.  Look at the expression used to define the parameter being passed into the IIFE on this line:  it basically says “if the global variable <code>TodoApp</code> already has a value, use that, otherwise, assign that global variable to an empty object and pass that in instead.”  Regardless of whether the object existed before the declaration or not, by the time it gets passed as a parameter to the IIFE function on line 2, it has been defined.</li>
  <li>Since the <code>TodoApp</code> namespace is empty, there is no logic in it other than the declaration of the nested namespace <code>Model</code> , which follows the same exact approach to create the <code>TodoApp.Model</code> object as I just described for the <code>TodoApp</code> object.</li>
  <li>Finally, we get to the good stuff inside of the <code>TodoApp.Model</code> declaration.  Here TypeScript generates the same code that we saw before to define the TodoState enum.  And now that we know about the IIFE design pattern, we can see that enums and classes are declared using this pattern as well!  The most interesting part of the <code>Model</code> namespace declaration is where the <code>TodoState</code> enum is exposed to the public by assigning it as a property of the <code>Model</code> namespace object.  This line is the direct result of the <code>export</code> keyword, which I can prove by removing the export keyword and watching this line disappear: <code>Model.TodoState = TodoState;</code>.  And, when I add the export keyword back, the line reappears.</li>
</ol>

<p>When it comes to encapsulation, there are two very important points about what I just told you:  </p>

<ol class="numeric">
  <li>Things declared within a namespace remain private unless you explicitly expose them, and </li>
  <li>When it comes down to it, namespaces are really just functions;  special, powerful functions, sure… but just functions…  and that means that you can define more than just types within them.  You can also use them to create private variables and functions.</li>
</ol>

<p>With that in mind, let’s see how I can take my <code>TodoService</code> and refactor it so that the private static variable and method that I’m currently using to generate unique IDs for my Todo items is truly inaccessible from other components in my application as opposed to simply telling TypeScript to yell at me whenever I try to access it.</p>

<p>I’ll start by moving the whole DataAccess namespace into its own file and copying the <code>TodoService</code> class into it:</p>

<figure class="code">
  <figcaption>DataAccess.ts</figcaption>

<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">DataAccess</code> <code class="p">{</code>
  
  <code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code><code class="p">;</code>
  <code class="kr">import</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>

  <code class="kr">export</code> <code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
    <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code>: <code class="kt">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
    <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code>: <code class="kt">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
    <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
    <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code>: <code class="kt">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
  <code class="p">}</code>
  
  <code class="kr">class</code> <code class="nx">TodoService</code> <code class="kr">implements</code> <code class="nx">ITodoService</code> <code class="p">{</code>

    <code class="kr">private</code> <code class="kr">static</code> <code class="nx">_lastId</code>: <code class="kt">number</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

    <code class="nx">get</code> <code class="nx">nextId() {</code>
      <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">_lastId</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="kr">constructor</code><code class="p">(</code><code class="kr">private</code> <code class="nx">todos</code>: <code class="kt">Todo</code><code class="p">[])</code> <code class="p">{</code>
    <code class="p">}</code>

    <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code>: <code class="kt">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code> <code class="p">{</code>
      <code class="nx">todo</code><code class="p">.</code><code class="nx">id</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">nextId</code><code class="p">;</code>
      
      <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>
      
      <code class="k">return</code> <code class="nx">todo</code><code class="p">;</code>
    <code class="p">}</code>
    
    <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code>: <code class="kt">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code> <code class="p">{</code>
      <code class="kd">var</code> <code class="nx">toDelete</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
      
      <code class="kd">var</code> <code class="nx">deletedIndex</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">indexOf</code><code class="p">(</code><code class="nx">toDelete</code><code class="p">);</code>
      
      <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">splice</code><code class="p">(</code><code class="nx">deletedIndex</code><code class="p">,</code> <code class="mi">1</code><code class="p">);</code>
    <code class="p">}</code>

    <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[]</code> <code class="p">{</code>
      <code class="kd">var</code> <code class="nx">clone</code> <code class="o">=</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">);</code>
      <code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">parse</code><code class="p">(</code><code class="nx">clone</code><code class="p">);</code>
    <code class="p">}</code>
    
    <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code>: <code class="kt">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code> <code class="p">{</code>
      <code class="kd">var</code> <code class="nx">filtered</code> <code class="o">=</code> 
        <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="nx">x</code> <code class="o">=&gt;</code> <code class="nx">x</code><code class="p">.</code><code class="nx">id</code> <code class="o">==</code> <code class="nx">todoId</code><code class="p">);</code>
        
      <code class="k">if</code><code class="p">(</code> <code class="nx">filtered</code><code class="p">.</code><code class="nx">length</code> <code class="p">)</code> <code class="p">{</code>
        <code class="k">return</code> <code class="nx">filtered</code><code class="p">[</code><code class="mi">0</code><code class="p">];</code>
      <code class="p">}</code>
      
      <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
    <code class="p">}</code>
  <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>Then, I simply cut the <code>lastId</code> variable from inside the class and move it outside…</p>

<figure class="code">
  <figcaption>DataAccess.ts</figcaption>

<div class="highlight"><pre><code class="uil">  private static _lastId: number = 0;
</code>
  class TodoService implements ITodoService {

<code class="udl">    private static _lastId: number = 0;
</code>
    get nextId() {
      return TodoService._lastId += 1;
    }
</pre></div>

</figure>

<p>Remove the <code>private</code> and <code>static</code> keywords, which are no longer relevant, and replace them with a simple <code>let</code> statement:</p>

<figure class="code">
  <figcaption>DataAccess.ts</figcaption>

<div class="highlight"><pre><code class="udl">  private static _lastId: number = 0;
</code><code class="uil">  let _lastId: number = 0;
</code>
  class TodoService implements ITodoService {

    get nextId() {
      return TodoService._lastId += 1;
    }
</pre></div>

</figure>

<p>Finally, I’ll clean up any references to the static variable that are now broken.<br>
Because the <code>lastId</code> variable is defined in the same scope that my class is defined in, my class can simply reference the variable by name:</p>

<figure class="code">
  <figcaption>DataAccess.ts</figcaption>

<div class="highlight"><pre>  let _lastId: number = 0;

  class TodoService implements ITodoService {

    get nextId() {
<code class="udl">      return TodoService._lastId += 1;
</code><code class="uil">      return _lastId += 1;
</code>    }
</pre></div>

</figure>

<p>I can even go one step further and replace the getter property method the same way:  cut it, paste it outside of the class, and convert it into a normal function.<br>
While I’m at it, I’ll rename it to <code>generateTodoId()</code>:</p>

<figure class="code">
  <figcaption>DataAccess.ts</figcaption>

<div class="highlight"><pre>  let _lastId: number = 0;

<code class="uil">  function generateTodoId() {
</code><code class="uil">    return _lastId += 1;
</code><code class="uil">  }
</code>
  class TodoService implements ITodoService {

<code class="udl">    get nextId() {
</code><code class="udl">      return _lastId += 1;
</code><code class="udl">    }
</code></pre></div>

</figure>

<p>Then I’ll update the reference to the getter method with a call to this private function instead…</p>

<figure class="code">
  <figcaption>DataAccess.ts</figcaption>

<div class="highlight"><pre>    add(todo: Todo): Todo {
<code class="udl">      todo.id = this.nextId;
</code><code class="uil">      todo.id = generateTodoId();
</code></pre></div>

</figure>

<p>The end result of all of this is that I’ve got two private members that live outside of my class, completely encapsulated from the rest of the world, but fully accessible to any classes or functions that are defined within the same namespace declaration.  Assuming that I really, really wanted to hide the implementation details of how I am generating new Todo IDs, this would be a great way to do it.</p>

<p>While incredibly effective, the namespace approach - also referred to as the <strong>internal module</strong> approach - is only one way that TypeScript enables you to encapsulate your components.  The other way, referred to as the “external module” approach is equally effective and actually far more common in browser-based lazy-loading solutions such as require.js and in the NodeJS development world.  To see what I’m talking about, check out the next section to see how implement the external module approach in TypeScript.</p>

<h3 id="leanpub-auto-understanding-the-difference-between-internal-and-external-modules">Understanding the difference between Internal and External Modules</h3>

<p>In the previous section, I showed you how to leverage TypeScript namespaces, otherwise known as “internal modules”.<br>
But, even though the internal module approach can be very effective, it’s actually fallen out of grace in recent years in favor of <strong>external modules</strong>, and in this section I’ll explain what external modules are and how you can start using them in your TypeScript applications.</p>

<p>Namespaces and the internal module approach allows you to group components together and get them out of the global scope by bringing them together under one umbrella object.  Using TypeScript, you can control which components belong to which object by wrapping them with namespaces using the syntax that I demonstrated in the last section:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="p">{</code>
  <code class="kr">export</code> <code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code>
  <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>And in that last section I also showed how you can use that same syntax to define multiple namespaces in the same file.</p>

<p>Put simply, the external module approach has most of the same goals of encapsulation and organization as the internal module approach, but its implementation is a bit different.  Rather than using a keyword and brackets to indicate the scope of the module, the external module approach uses the file itself as the module scope.</p>

<p>Even under this approach, many of the same restrictions apply and perhaps the most important one of all is that all components defined within the module are only accessible to that file by default and must be exported in some way in order to be used.  </p>

<p>The inverse is also true:  any components defined outside of the module must be imported in order for the module to access them.  This is in stark contrast to the traditional JavaScript development methodology of defining everything in the global scope, and even though I showed you in the last section how to use the <code>import</code> keyword to make an alias to another type or namespace, it’s really more of a shorthand than anything else – you don’t have to import another internal module in order to use it - you just… use it.</p>

<p>In the next few sections, I’m going to show you two different syntaxes that TypeScript provides for you to import modules:  the “require” syntax (similar to the syntax that NodeJS uses) and ES2015 (the syntax that’s now part of the ECMAScript standard).</p>

<p>You may be scratching your head wondering why TypeScript offers two different syntaxes to import modules, and there’s a pretty simple answer for that:  ECMAScript 6 (more commonly referred to as ECMAScript2015 when referring to the module syntax) defined its syntax after TypeScript had already implemented the require syntax.  Since it couldn’t just drop support for a syntax that it’s had for a long time, now TypeScript supports both syntaxes.</p>

<p>As I’m showing you these two syntaxes, the thing to remember as you learn each of them is that they are completely functionally equivalent, by which I mean that TypeScript ends up generating the same exact code for them at compile time.   </p>

<p>Ultimately, you can choose either syntax and be quite fine!  However, as with most of the features that are in the ECMAScript specification, I would recommend using the ECMAScript syntax as this is the syntax that will eventually have native browser support.</p>

<p>Regardless of which syntax you choose, TypeScript supports two ways to import external modules so I’m going to show you how to use both of them.  Either way, there is a little bit of configuration and preparation that you’ll need to do first, so head on to the next section where I’ll show you what you need to take care of in order to start using the external module approach.</p>

<h3 id="leanpub-auto-switching-from-internal-to-external-modules">Switching from internal to external modules</h3>

<p>In the previous section I explained the concept of external modules and how they compare to the internal modules that I already demonstrated.  </p>

<p>And, as I mentioned in that section, perhaps the biggest difference between the two module approaches is that external modules use the file that they’re defined in as their module border as opposed to an IIFE within a file.  This important difference means that it is kind of redundant to apply internal namespaces within external modules, because the file already is the module.</p>

<p>For example, in the namespace section I introduced a namespace called <code>DataAccess</code> inside a file named <code>DataAccess.ts</code>.  Once we switch to external modules in the next two sections, I’ll need to reference any types defined in this module by going through the external module first, then through the internal module, then finally get to the type I was looking for.  In other words, I’ll end up writing this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">DataAccess</code><code class="p">.</code><code class="nx">DataAccess</code><code class="p">.</code><code class="nx">TodoService</code>
</pre></div>

</figure>

<p>And that’s just silly.</p>

<p>So, before I get into the next sections, I’m going to prepare by removing the internal modules that I added previously, but leave the <code>export</code> keyword on their public members because that syntax is the same syntax that you continue to use when exposing members in the external module approach.
I’ll also remove those import statements that I was using as aliases because I’ll be replacing them in just a bit.</p>

<figure class="code">
  <figcaption>DataAccess.ts</figcaption>

<div class="highlight"><pre><code class="udl">namespace DataAccess {
</code><code class="udl">  
</code><code class="udl">  import Model = TodoApp.Model;
</code><code class="udl">  import Todo = Model.Todo;
</code>
  // ... Rest of file
  
<code class="udl">}
</code></pre></div>

</figure>

<p>As I make these changes, I see that TypeScript is getting upset with me about the fact that I’m still using the <code>export</code> keyword even though I’m not defining any modules.<br>
That is because in order to leverage the external module approach, I have to tell TypeScript that that’s what I’m doing.</p>

<p>I can tell TypeScript this and make these errors go away by adding another configuration parameter to my TypeScript configuration located in my tsconfig.json file:</p>

<p>The option I’m looking to add is the <code>module</code> compiler setting:</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
        <code class="s2">"target"</code><code class="o">:</code> <code class="s2">"es5"</code><code class="p">,</code>
        <code class="s2">"module"</code><code class="o">:</code> <code class="s2">"system"</code><code class="p">,</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>As I add this setting, Visual Studio Code offers several different autocomplete options for me to choose from:  CommonJS, AMD, System, UMD, etc. <br>
Keep in mind that this setting is really just telling TypeScript that I intend to use external modules by indicated what the compiled output should be.<br>
As I mentioned in the previous section, you are free to use either syntax you like when actually defining the import, so it really doesn’t matter which option you choose here.<br>
I’ve chosen the <code>system</code> setting because I’ll be implementing the System.js module loader in the next chapter, but you can feel free to choose whichever one you like.</p>

<p>Switching back to the <code>DataAccess</code> module I can see that the errors about the export keyword have gone away, but now it has no idea what the <code>Todo</code> type is.<br>
That’s because I need to import that type from the <code>Model</code> namespace, so head on to the next section where I’ll show you how to use the require syntax to do exactly that.</p>

<h3 id="leanpub-auto-importing-modules-using-require-syntax">Importing modules using Require syntax</h3>

<p>In the previous few sections, I’ve been introducing the concept of external modules and explained that TypeScript supports two syntaxes for importing these modules:  the require syntax and ECMAScript 2015 syntax and, in this section, I’ll be explaining the require syntax.
The require syntax is pretty simple, so I’ll just go ahead and use it to show you what it looks like. </p>

<p>When I left off in the last section, TypeScript was giving me errors in the DataAccess.ts file because it didn’t know about the <code>Todo</code> type and I needed to import that type in order to make it happy again.</p>

<p>In order to do that, I simply write the following statement at the beginning of my file in order to reference the <code>Model</code> module…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'./Model'</code><code class="p">);</code>
</pre></div>

</figure>

<p>This brings everything exported in the Model module into the scope of this file, all contained under the Model object, very similar to the internal module approach I showed earlier.  </p>

<p>Notice that, while I did specify the path to the file I was looking for, I did not specify the extension of the file – in other words, I didn’t say <code>Model.js</code> or <code>Model.ts</code>.  This is deliberate, and I’ll explain why in more detail in the next chapter when I discuss how modules are actually loaded, but for now this is an important part of the syntax to keep in mind.</p>

<p>And, like the internal module approach, I have two ways to reference components in this module:  through the module object itself or by establishing a shortcut to them by giving them an alias.</p>

<p>For instance, if I want to refer to the Todo type, I can change every individual reference, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'./Model'</code><code class="p">);</code>

<code class="kr">export</code> <code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
  <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
  <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
  <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">[];</code>
  <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Or… I can establish one alias to the type, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'./Model'</code><code class="p">);</code>
<code class="kr">import</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>

<code class="kr">export</code> <code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
  <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
  <code class="k">delete</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
  <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
  <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>You might think it’s a little annoying to have to do this in two lines – I sure do.  In other words, I’d love to be able to write this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'./Model'</code><code class="p">).</code><code class="nx">Todo</code><code class="p">;</code>
</pre></div>

</figure>

<p>Sadly, TypeScript doesn’t support this usage, so you’ll have to keep the two lines in place in order to create an alias like this.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'./Model'</code><code class="p">);</code>
<code class="kr">import</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
</pre></div>

</figure>

<p>However, the ECMAScript 2015 syntax <em>does</em> allow you to import individual types and create aliases for them all in one line.  In fact, it’s one of the reasons that I prefer that syntax over this one.<br>
To see what I’m talking about, check out the next section where I show you everything you need to know in order to use the ECMAScript 2015 module syntax.</p>

<h3 id="leanpub-auto-importing-modules-using-ecmascript-2015-syntax">Importing modules using ECMAScript 2015 syntax</h3>

<p>A few sections ago, I mentioned that TypeScript supports two different syntaxes for importing external modules - the require syntax and the ECMAScript 2015 syntax - and in the last section, I showed you how to use the <code>require</code> syntax.
In this section, I’ll show you how to use the ECMAScript syntax to import components from external modules.
And, in fact, the ECMAScript 2015 syntax is actually pretty close to the “require” syntax.</p>

<p>As I showed in the previous section, you import a module with the “require” syntax like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'./Model'</code><code class="p">);</code>
</pre></div>

</figure>

<p>But, with the ECMASCript 2015 syntax, you would write the same thing like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="o">*</code> <code class="nx">as</code> <code class="nx">Model</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>That’s really all the difference!  Once I’ve got the module referenced, the rest of the code works exactly the same way.<br>
In other words, in order to refer to the <code>Todo</code> type in the <code>Model</code> module, I need to refer to it with its full name, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">todo</code><code class="o">:</code>  <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
</pre></div>

</figure>

<p>But, remember how, in the previous section, I used the import statement to give the <code>Todo</code> type an alias, like this?</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
<code class="kd">let</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
</pre></div>

</figure>

<p>Well, that same syntax will continue to work and I could use it here, but it’s not actually part of the ECMAScript 2015 spec… and that’s for a good reason:  because the ECMAScript spec allows you to define aliases in the import statement itself!</p>

<p>To demonstrate, I’ll first remove the alias:</p>

<figure class="code">
<div class="highlight"><pre>	import * as Model from './Model';
<code class="udl">	import Todo = Model.Todo;
</code></pre></div>

</figure>

<p>Then, I’ll set my focus on the original import statement, in particular the <code>* as Model</code> part.<br>
What this part of the syntax is saying is, “import everything that is being exported from this module and attach it to a temporary object named <code>Model</code> so that I can refer to them in this file.  </p>

<p>However, importing <em>everything</em> in the module like this is rarely want you want to do.<br>
More often, you only need a few exports from a module, and in those cases you’ll want to import them individually, which you do by replacing this part of the statement with a set of brackets, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Then, inside of these brackets, you define every individual export that you want to import by name, separated by commas.  In my example I just want to import the Todo type, which I can do like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="nx">Todo</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>As soon as I do that I can see it’s working because the TypeScript warnings about not knowing what the <code>Todo</code> type is go away.</p>

<p>Likewise, if I wanted to import more exports that this module provides, I could add them to the list, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="nx">Todo</code><code class="p">,</code> <code class="nx">TodoState</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Or, if you prefer to give the type an alias for when you’re working with it in this file, you can use that <code>as</code> syntax that I showed in the original import statement.</p>

<p>For example, if I didn’t like the name of the type <code>Todo</code> and I wanted to call it <code>TodoTask</code> instead, I could do this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="nx">Todo</code> <code class="nx">as</code> <code class="nx">TodoTask</code><code class="p">,</code> <code class="nx">TodoState</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Notice that as soon as I do this, TypeScript begins warning me again that it doesn’t know about a type named <code>Todo</code> – that’s because I just renamed it… well, in this file at least.  In order to get rid of that error I have to use the new alias that I gave it, <code>TodoTask</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">let</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">TodoTask</code><code class="p">;</code>
</pre></div>

</figure>

<p>And, finally, it’s important to point out that you are not required to import anything at all, in which case you simply say “import module name”, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Really the only scenario you’d want to do this is when you have a script that modifies the environment in some way that you are dependent on.  In those cases, the import statement is still relevant because you do depend on that module getting loaded… you’re just not relying on any particular exports that the module provides.</p>

<p>And that’s how you use the ECMAScript module syntax!  As I’ve mentioned several times now, even though this is one of the two syntaxes that TypeScript supports, I strongly recommend using the ECMAScript syntax if no other reason than it is a standard that will eventually have native browser support.</p>

<p>Now that I’ve demonstrated both syntaxes, head on to the next section where we’ll revisit that <code>module</code> configuration setting and see how it affects the code that TypeScript generates.</p>

<h3 id="leanpub-auto-loading-external-modules">Loading External Modules</h3>

<p>In the previous few sections I introduced you to the concept of external modules and two different syntaxes that are available to you to import one module from another.  I also mentioned that - regardless of which of the two syntaxes you used to import modules - the code that gets generated is not only exactly the same, but also driven by a setting in the TypeScript configuration file tsconfig.json.  In this section, I’ll not only talk about what each of those configuration options means, but I’ll also explain how you can actually use the external module approach in your application.</p>

<p>I’ll start by explaining what I meant by that last part about “actually using the external module approach”.  You see, as of this writing, even though ECMAScript 2015 defines the syntax for importing one module into another, there are two problems:  </p>

<ol class="numeric">
  <li>The syntax is not widely supported in browsers just yet, and</li>
  <li>There is no standard implementation for actually loading the modules when they’re referenced.  As of this writing there is an ECMAScript loader specification that is in the process of gaining approval, but that means that native support for module loading is still very far off.</li>
</ol>

<p>The net result of those two problems is that, until both of them are fixed, you’re probably going to want to introduce a new tool into your toolbelt and that is a module loader.</p>

<p>Choosing a module loader is easier said than done because there are plenty of options available and all of them have different ways of doing things.  This is why TypeScript provides so many options for the <code>module</code> configuration setting: because there is one for every major module loader that’s available!  So, the short answer to the question of which <code>module</code> configuration setting you should choose is:  which module loader do you want to use?</p>

<p>Obviously, teaching you how to use every module loader out there is clearly outside the scope of this book (not to mention a whole lot of work). So, through the rest of the book I’ll be using the System.js module loader in order to load module files and manage module imports at runtime.  The reason I’m choosing System.js over the others should come as no surprise – I’m choosing it because it is the loader that attempts to implement the proposed ECMAScript specification.  In other words, my hope is that I can use it as a temporary solution until the browsers actually implement the ECMAScript proposal, at which time I should be able to simply drop the loader and use the native implementation.  At least, I hope… in reality, I’ll probably end up needing to use System.js for longer than I expect, but that’s ok because at least it’s letting me write ECMAScript 2015 code now.</p>

<p>Now that I’ve chosen my module loader, I’ve got to update my index.html to change the way I’m loading my application.<br>
Before using a module loader, I had to include every single JavaScript file explicitly, creating a &lt;script&gt; tag for each one.  But, with a module loader, the only script you need to specify in your HTML is the module loader itself, then use the module loader’s API to call into your application module.</p>

<p>In other words, I can remove all of these script tags and replace them with a single reference to system.js.</p>

<figure class="code">
  <figcaption>index.html</figcaption>

<div class="highlight"><pre><code></code>  <code class="c1">// All other script tags removed...</code>
  <code class="o">&lt;</code><code class="nx">script</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text/javascript"</code> <code class="nx">src</code><code class="o">=</code><code class="s2">"//cdnjs.cloudflare.com/ajax/libs/systemjs/\</code>
<code class="s2">0.19.22/system.js"</code><code class="o">&gt;&lt;</code><code class="err">/script&gt;</code>
</pre></div>

</figure>

<p>Notice that I’ve taken a shortcut here and linked directly to the system.js file hosted on the Cloudflare CDN.  This should work for you, but if it doesn’t you’ll need to download it and put it into your project locally, or use the npm command line tool to install the “systemjs” package:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">npm</code> <code class="nx">install</code> <code class="nx">systemjs</code>
</pre></div>

</figure>

<p>Regardless of how you get System.js loaded, the next thing you’ll do is use it to load your module with this simple line (placed in a &lt;script&gt; block, of course):</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="o">&lt;</code><code class="nx">script</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text/javascript"</code><code class="o">&gt;</code>
    <code class="nx">System</code><code class="p">.</code><code class="kr">import</code><code class="p">(</code><code class="s1">'app'</code><code class="p">)</code>
<code class="o">&lt;</code><code class="err">/script&gt;</code>
</pre></div>

</figure>

<p>Note that at the time of this writing, I also had to add this configuration statement before the import call in order for it to work properly:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="o">&lt;</code><code class="nx">script</code><code class="o">&gt;</code>
	<code class="nx">System</code><code class="p">.</code><code class="nx">defaultJSExtensions</code> <code class="o">=</code> <code class="kc">true</code><code class="p">;</code>
	<code class="nx">System</code><code class="p">.</code><code class="kr">import</code><code class="p">(</code><code class="s1">'app'</code><code class="p">)</code>
<code class="o">&lt;</code><code class="err">/script&gt;</code>
</pre></div>

</figure>

<p>Hopefully by the time you’re reading this the TypeScript compiler or System.js will have been updated to remove the need for this line.</p>

<p>Once I have all this in place, I should be able to run the site and see it in action.  Unfortunately, right now it doesn’t do anything, so let me write a little bit of code that loads the TodoService from the DataAccess module, initializes it with a Todo, and then prints out all the Todos onto the command line:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="nx">Todo</code><code class="p">,</code> <code class="nx">TodoState</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">TodoService</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./DataAccess'</code><code class="p">;</code>

<code class="kd">let</code> <code class="nx">service</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">TodoService</code><code class="p">([]);</code>

<code class="nx">service</code><code class="p">.</code><code class="nx">add</code><code class="p">({</code> 
    <code class="nx">id</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code> 
    <code class="nx">name</code><code class="o">:</code> <code class="s1">'Pick up drycleaning'</code><code class="p">,</code> 
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">.</code><code class="nx">New</code> 
<code class="p">})</code>

<code class="kd">let</code> <code class="nx">todos</code> <code class="o">=</code> <code class="nx">service</code><code class="p">.</code><code class="nx">getAll</code><code class="p">();</code>

<code class="nx">todos</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">todo</code> <code class="o">=&gt;</code> 
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">todo</code><code class="p">.</code><code class="nx">name</code><code class="si">}</code><code class="sb"> [</code><code class="si">${</code><code class="nx">TodoState</code><code class="p">[</code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code><code class="p">]</code><code class="si">}</code><code class="sb">]`</code><code class="p">)</code>
<code class="p">)</code>
</pre></div>

</figure>

<p>Now when I run the site and open up the console I should be able to see my Todo printed out indicating that everything has worked!</p>

<p>And with that, we’ve got a working external module implementation!  Now, if you found this chapter perhaps a little overwhelming or even complicated, well… I don’t blame you.  It actually took me a while to get comfortable with modules, too.  It’s not really a concept that we JavaScript developers have really had to know until now!  But, that’s ok for two reasons: </p>

<ol class="numeric">
  <li>If you take the time to learn how to use external modules properly, your code will become far more organized and easy to manage, and </li>
  <li>If you really don’t like the external module approach then you don’t have to use it!  You can still use namespaces to implement an internal module approach that doesn’t require adding any more complexity or tools to your existing environment and yet still get the benefits of getting your code out of the global namespace!</li>
</ol>

<p>It’s up to you what you decide to do, but I know for me, spending the time learning how to embrace external modules has really made my codebases far more enjoyable to work with, and I think it will be worth your time to learn, too.</p>

<h2 id="leanpub-auto-real-world-application-development">
<span class="section-number">10. </span>Real-World Application Development</h2>

<p>So far in this book I’ve shown you a variety of features that TypeScript offers which allow you to introduce powerful static typing capabilities to JavaScript as well as write ECMAScript 2015 code that compiles into code that runs in pretty much any modern browser.<br>
Even though I haven’t shown you every nuance that TypeScript has to offer, I’ve shown you the 95% of it that you’ll use in your day-to-day development.  </p>

<p>But, at this point I’d like to shift the focus from the syntax that TypeScript provides and move toward the mindset that you will need when using TypeScript to create a full-blown JavaScript application - regardless of whether it’s converting an existing application or starting a new one from scratch.</p>

<p>Throughout several chapters in the book, I’ve referred to the fact that I am going to build a sample Todo application to demonstrate how to bring all of TypeScript’s features together into a real, working application, and up to this point I’ve only been showing bits and pieces.<br>
Well, in this chapter, I’m finally going to show you that complete, working application… except I’m going to start with the application written in ECMAScript 5 syntax and then apply each of the TypeScript features I’ve shown you in this book in order to convert it into the TypeScript version of the same application.</p>


<figure class="image floatleft">
  <img src="./Read Essential TypeScript _ Leanpub_files/RealWorld----project.png" alt="ECMAScript 2015 Todo Application">
  <figcaption>ECMAScript 2015 Todo Application</figcaption>
</figure>


<p>So, let’s walk through this sample application.  We’ll start with the <code>index.html</code> page of the Todo application.  </p>

<figure class="code">
  <figcaption>TodoService.js</figcaption>

<div class="highlight"><pre><code></code><code class="cp">&lt;!doctype html&gt;</code>
<code class="p">&lt;</code><code class="nt">html</code> <code class="na">lang</code><code class="o">=</code><code class="s">"en"</code><code class="p">&gt;</code>
<code class="p">&lt;</code><code class="nt">head</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">meta</code> <code class="na">http-equiv</code><code class="o">=</code><code class="s">"X-UA-Compatible"</code> <code class="na">content</code><code class="o">=</code><code class="s">"IE=edge"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">meta</code> <code class="na">name</code><code class="o">=</code><code class="s">"viewport"</code> <code class="na">content</code><code class="o">=</code><code class="s">"width=device-width, initial-scale=1"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">title</code><code class="p">&gt;</code>TypeScript Todo List<code class="p">&lt;/</code><code class="nt">title</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code> <code class="na">href</code><code class="o">=</code><code class="s">"//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/b\</code>
<code class="s">ootstrap.min.css"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code> <code class="na">href</code><code class="o">=</code><code class="s">"styles.css"</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">head</code><code class="p">&gt;</code>

<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code><code class="p">&gt;</code>
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"header clearfix"</code><code class="p">&gt;</code>
            <code class="p">&lt;</code><code class="nt">h1</code><code class="p">&gt;</code>TypeScript Todo List<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>
        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"row"</code><code class="p">&gt;</code>
            <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"panel panel-default clearfix"</code><code class="p">&gt;</code>

                <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"panel-body"</code><code class="p">&gt;</code>

                    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"row"</code><code class="p">&gt;</code>
                        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"todo-list col-md-12"</code><code class="p">&gt;</code>
                            <code class="c">&lt;!-- Todo Items rendered here --&gt;</code>
                        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
                    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

                    <code class="p">&lt;</code><code class="nt">br</code><code class="p">&gt;</code>

                    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"row"</code><code class="p">&gt;</code>
                        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"col-md-10"</code><code class="p">&gt;</code>

                            <code class="c">&lt;!-- Add Todo --&gt;</code>
                            <code class="p">&lt;</code><code class="nt">form</code> <code class="na">class</code><code class="o">=</code><code class="s">"add-todo"</code><code class="p">&gt;</code>
                                <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"form-group"</code><code class="p">&gt;</code>
                                    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"input-group"</code><code class="p">&gt;</code>
                                        <code class="p">&lt;</code><code class="nt">span</code> <code class="na">class</code><code class="o">=</code><code class="s">"input-group-btn"</code><code class="p">&gt;</code>
                                            <code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"submit"</code> <code class="na">class</code><code class="o">=</code><code class="s">"btn btn\</code>
<code class="s">-primary input-lg"</code><code class="p">&gt;</code>Add<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>
                                        <code class="p">&lt;/</code><code class="nt">span</code><code class="p">&gt;</code>
                                        <code class="p">&lt;</code><code class="nt">input</code> <code class="na">type</code><code class="o">=</code><code class="s">"text"</code> <code class="na">class</code><code class="o">=</code><code class="s">"form-control i\</code>
<code class="s">nput-lg"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"What do you need to get done?"</code> <code class="p">/&gt;</code>
                                    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
                                <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
                            <code class="p">&lt;/</code><code class="nt">form</code><code class="p">&gt;</code>
                            <code class="c">&lt;!-- /Add Todo --&gt;</code>

                        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

                        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"col-md-2"</code><code class="p">&gt;</code>
                            <code class="c">&lt;!-- Clear completed button --&gt;</code>
                            <code class="p">&lt;</code><code class="nt">button</code> <code class="na">class</code><code class="o">=</code><code class="s">"clear-completed btn btn-sm btn-warnin\</code>
<code class="s">g pull-right"</code><code class="p">&gt;</code>Clear Completed<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>
                            <code class="c">&lt;!-- /Clear completed button --&gt;</code>
                        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

                    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
                <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
            <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

    <code class="p">&lt;</code><code class="nt">script</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/javascript"</code> <code class="na">src</code><code class="o">=</code><code class="s">"//code.jquery.com/jquery-1.12.1.min.js"</code><code class="p">&gt;</code><code class="o">\</code>
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">script</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/javascript"</code> <code class="na">src</code><code class="o">=</code><code class="s">"TodoListComponent.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">script</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/javascript"</code> <code class="na">src</code><code class="o">=</code><code class="s">"TodoService.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">script</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/javascript"</code> <code class="na">src</code><code class="o">=</code><code class="s">"TodoApp.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">script</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/javascript"</code><code class="p">&gt;</code>
        <code class="k">new</code> <code class="nx">TodoApp</code><code class="p">(</code><code class="nb">document</code><code class="p">,</code> <code class="p">[</code>
            <code class="s1">'Pick up drycleaning'</code><code class="p">,</code>
            <code class="s1">'Clean Batcave'</code><code class="p">,</code>
            <code class="s1">'Save Gotham'</code>
        <code class="p">]);</code>
    <code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code>

<code class="p">&lt;/</code><code class="nt">html</code><code class="p">&gt;</code>
</pre></div>

</figure>

<p>It’s really nothing fancy - just some standard HTML and CSS (using the Bootstrap CSS library that I introduced in the beginning of the book), and a couple of script tags with references to ECMAScript 5 JavaScript files.  </p>

<p>For example, here’s the ECMAScript 5 version of the <code>TodoService</code> that we’ve been looking at during this whole book - a great example of building a “class” using the prototype object before ECMASCript 2015 introduced the concept of classes.</p>

<figure class="code">
  <figcaption>TodoService.js</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">TodoService</code> <code class="o">=</code> <code class="p">(</code><code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>

  <code class="c1">// Private, static variable</code>
  <code class="kd">var</code> <code class="nx">_lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

  <code class="c1">// Private, static method</code>
  <code class="kd">function</code> <code class="nx">generateTodoId</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">_lastId</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
  <code class="p">}</code>
  
  <code class="c1">// Private, static method</code>
  <code class="kd">function</code> <code class="nx">clone</code><code class="p">(</code><code class="nx">src</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">clone</code> <code class="o">=</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">src</code><code class="p">);</code>
    <code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">parse</code><code class="p">(</code><code class="nx">clone</code><code class="p">);</code>
  <code class="p">};</code>

  <code class="c1">// Constructor method</code>
  <code class="kd">function</code> <code class="nx">TodoService</code><code class="p">(</code><code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">_this</code> <code class="o">=</code> <code class="k">this</code><code class="p">;</code>
    
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="p">[];</code>
    
    <code class="k">if</code><code class="p">(</code><code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
      <code class="nx">todos</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">_this</code><code class="p">.</code><code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>  
      <code class="p">})</code>
    <code class="p">}</code>
  <code class="p">}</code>

  <code class="c1">// input parameter can be either string or object ({ name })</code>
  <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">add</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">input</code><code class="p">)</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
      <code class="nx">id</code><code class="o">:</code> <code class="nx">generateTodoId</code><code class="p">(),</code>
      <code class="nx">name</code><code class="o">:</code> <code class="kc">null</code><code class="p">,</code>
      <code class="nx">state</code><code class="o">:</code> <code class="mi">1</code>
    <code class="p">};</code>

    <code class="k">if</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">input</code> <code class="o">===</code> <code class="s1">'string'</code><code class="p">)</code> <code class="p">{</code>
      <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">input</code><code class="p">;</code>
    <code class="p">}</code> 
    <code class="k">else</code> <code class="k">if</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">input</code><code class="p">.</code><code class="nx">name</code> <code class="o">===</code> <code class="s1">'string'</code><code class="p">)</code> <code class="p">{</code>
      <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">input</code><code class="p">.</code><code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
      <code class="k">throw</code> <code class="s1">'Invalid Todo name!'</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>

    <code class="k">return</code> <code class="nx">todo</code><code class="p">;</code>
  <code class="p">};</code>

  <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">clearCompleted</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
     
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">x</code><code class="p">)</code> <code class="p">{</code> 
      <code class="k">return</code> <code class="nx">x</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="mi">1</code><code class="p">;</code> 
    <code class="p">});</code>
  <code class="p">}</code>

  <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getAll</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
    <code class="c1">// Don't return the actual array - clone it instead</code>
    <code class="k">return</code> <code class="nx">clone</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">);</code>
  <code class="p">};</code>

  <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">getById</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">_find</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
    <code class="c1">// Don't return the actual object - clone it instead</code>
    <code class="k">return</code> <code class="nx">clone</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>
  <code class="p">};</code>
  
  <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toggle</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">_find</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
    
    <code class="k">if</code><code class="p">(</code><code class="o">!</code><code class="nx">todo</code><code class="p">)</code> <code class="k">return</code><code class="p">;</code>
    
    <code class="k">switch</code><code class="p">(</code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code><code class="p">)</code> <code class="p">{</code>
      <code class="k">case</code> <code class="mi">1</code><code class="o">:</code>
        <code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">=</code> <code class="mi">2</code><code class="p">;</code>
        <code class="k">break</code><code class="p">;</code>
      <code class="k">case</code> <code class="mi">2</code><code class="o">:</code>
        <code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
        <code class="k">break</code><code class="p">;</code>
    <code class="p">}</code>
  <code class="p">}</code>

  <code class="c1">// "Private" method (just because it starts with an _)</code>
  <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">_find</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">filtered</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="kd">function</code> <code class="p">(</code><code class="nx">x</code><code class="p">)</code> <code class="p">{</code> 
      <code class="k">return</code> <code class="nx">x</code><code class="p">.</code><code class="nx">id</code> <code class="o">==</code> <code class="nx">todoId</code><code class="p">;</code> 
    <code class="p">});</code>
    
    <code class="k">if</code> <code class="p">(</code><code class="nx">filtered</code><code class="p">.</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
      <code class="k">return</code> <code class="nx">filtered</code><code class="p">[</code><code class="mi">0</code><code class="p">];</code>
    <code class="p">}</code>
    
    <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
  <code class="p">}</code>

  <code class="c1">// Return the class from the IIFE  </code>
  <code class="k">return</code> <code class="nx">TodoService</code><code class="p">;</code>
<code class="p">})();</code>
</pre></div>

</figure>

<p>Next, I’ve got the <code>TodoListComponent</code> class - a class that takes an HTML element and a list of <code>Todo</code> objects and uses the jQuery library to render them as HTML.  </p>

<figure class="code">
  <figcaption>TodoListComponent.js</figcaption>

<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">TodoListComponent</code> <code class="o">=</code> <code class="p">(</code><code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
  
  <code class="kd">function</code> <code class="nx">TodoListComponent</code><code class="p">(</code><code class="nx">el</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">$el</code> <code class="o">=</code> <code class="nx">$</code><code class="p">(</code><code class="nx">el</code><code class="p">);</code>
  <code class="p">}</code>

  <code class="nx">TodoListComponent</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">render</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>

    <code class="k">this</code><code class="p">.</code><code class="nx">$el</code><code class="p">.</code><code class="nx">html</code><code class="p">(</code><code class="s1">''</code><code class="p">);</code>
    
    <code class="k">if</code> <code class="p">(</code><code class="o">!</code><code class="nx">todos</code><code class="p">.</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
      <code class="k">this</code><code class="p">.</code><code class="nx">$el</code><code class="p">.</code><code class="nx">html</code><code class="p">(</code>
        <code class="s2">"&lt;div class='list-group-item text-center text-giant'&gt;"</code> <code class="o">+</code>
        <code class="s2">"  &lt;strong&gt;You've completed everything you needed to do!&lt;/strong&gt;"</code> <code class="o">+</code>
        <code class="s2">"&lt;/div&gt;"</code>
      <code class="p">);</code>
      
      <code class="k">return</code><code class="p">;</code>
    <code class="p">}</code>
    
    <code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">index</code> <code class="k">in</code> <code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
      <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="nx">todos</code><code class="p">[</code><code class="nx">index</code><code class="p">];</code>
      <code class="nx">renderTodo</code><code class="p">(</code><code class="nx">todo</code><code class="p">).</code><code class="nx">appendTo</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">$el</code><code class="p">);</code>
    <code class="p">}</code>
  <code class="p">};</code>

  <code class="kd">function</code> <code class="nx">renderTodo</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">$</code><code class="p">(</code>
      <code class="s2">"&lt;div class='todo-item list-group-item "</code><code class="o">+</code> <code class="p">(</code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="mi">2</code> <code class="o">?</code> <code class="s1">'completed'</code> <code class="o">:\</code>
 <code class="s1">''</code><code class="p">)</code> <code class="o">+</code><code class="s2">"'&gt;"</code> <code class="o">+</code>
      <code class="s2">"   &lt;div class='row'&gt;"</code> <code class="o">+</code>
      <code class="s2">"     &lt;div class='col-md-2 text-center'&gt;"</code> <code class="o">+</code>
      <code class="s2">"       &lt;i class='incomplete glyphicon glyphicon-unchecked text-muted text\</code>
<code class="s2">-giant'&gt;&lt;/i&gt;"</code> <code class="o">+</code>
      <code class="s2">"       &lt;i class='completed-indicator completed glyphicon glyphicon-ok tex\</code>
<code class="s2">t-giant'&gt;&lt;/i&gt;"</code> <code class="o">+</code>
      <code class="s2">"     &lt;/div&gt;"</code> <code class="o">+</code>
      <code class="s2">"     &lt;div class='col-md-10'&gt;"</code> <code class="o">+</code>
      <code class="s2">"      &lt;span class='incomplete text-giant'&gt;"</code> <code class="o">+</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">+</code> <code class="s2">"&lt;/span&gt;"</code> <code class="o">+</code>
      <code class="s2">"      &lt;span class='completed text-strikethrough text-muted text-giant'&gt;"</code> <code class="o">\</code>
<code class="o">+</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">+</code> <code class="s2">"&lt;/span&gt;"</code> <code class="o">+</code>
      <code class="s2">"    &lt;/div&gt;"</code> <code class="o">+</code>
      <code class="s2">"  &lt;/div&gt;"</code> <code class="o">+</code>
      <code class="s2">"  &lt;div class='clearfix'&gt;&lt;/div&gt;"</code> <code class="o">+</code>
      <code class="s2">"&lt;/div&gt;"</code>
    <code class="p">).</code><code class="nx">on</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
      <code class="kd">var</code> <code class="nx">event</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createEvent</code><code class="p">(</code><code class="s1">'CustomEvent'</code><code class="p">);</code>
      <code class="nx">event</code><code class="p">.</code><code class="nx">initCustomEvent</code><code class="p">(</code><code class="s1">'todo-toggle'</code><code class="p">,</code> <code class="kc">true</code><code class="p">,</code> <code class="kc">true</code><code class="p">,</code> <code class="p">{</code> <code class="nx">todoId</code><code class="o">:</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">id</code> <code class="p">});</code>
      <code class="k">this</code><code class="p">.</code><code class="nx">dispatchEvent</code><code class="p">(</code><code class="nx">event</code><code class="p">);</code>
    <code class="p">});</code>
  <code class="p">}</code>

  <code class="k">return</code> <code class="nx">TodoListComponent</code><code class="p">;</code>
<code class="p">})();</code>
</pre></div>

</figure>

<p>This class also triggers a custom DOM event called <code>todo-toggle</code> on line 44 whenever the user clicks on the <code>Todo</code> item.<br>
In other words, this class is simply a UI component that handles the rendering of <code>Todo</code> items and lets other components know about the user’s actions by raising a DOM event.</p>

<p>If you’ve used jQuery before, you probably would have implemented this differently and created a jQuery plugin.  And, quite honestly, I probably would have, too.  But, I wrote it this way so that this class is the only class in the application that uses jQuery, which will be important when I convert everything to the external module approach.</p>

<p>And, finally, the <code>TodoApp</code> class, which orchestrates the DOM, the <code>TodoService</code> and the <code>TodoListComponent</code> together to create a working application.</p>

<figure class="code">
  <figcaption>TodoApp.js</figcaption>

<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">TodoApp</code><code class="p">(</code><code class="nx">el</code><code class="p">,</code> <code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">TodoService</code><code class="p">(</code><code class="nx">todos</code><code class="p">);</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">initialize</code><code class="p">(</code><code class="nx">el</code><code class="p">);</code>
<code class="p">}</code>

<code class="nx">TodoApp</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">addTodo</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">todoName</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">add</code><code class="p">(</code><code class="nx">todoName</code><code class="p">);</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="p">}</code>

<code class="nx">TodoApp</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">clearCompleted</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">clearCompleted</code><code class="p">();</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="p">}</code>

<code class="nx">TodoApp</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">toggleTodoState</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">toggle</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="p">}</code>

<code class="nx">TodoApp</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">renderTodos</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
  <code class="kd">var</code> <code class="nx">todos</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">getAll</code><code class="p">();</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">todoList</code><code class="p">.</code><code class="nx">render</code><code class="p">(</code><code class="nx">todos</code><code class="p">);</code>
<code class="p">}</code>

<code class="nx">TodoApp</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">initialize</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">el</code><code class="p">)</code> <code class="p">{</code>
  <code class="kd">var</code> <code class="nx">_this</code> <code class="o">=</code> <code class="k">this</code><code class="p">;</code>
    
  <code class="kd">var</code> <code class="nx">addTodoFormEl</code> <code class="o">=</code> <code class="nx">el</code><code class="p">.</code><code class="nx">getElementsByClassName</code><code class="p">(</code><code class="s1">'add-todo'</code><code class="p">)[</code><code class="mi">0</code><code class="p">],</code>
    <code class="nx">addTodoNameEl</code> <code class="o">=</code> <code class="nx">addTodoFormEl</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'input'</code><code class="p">)[</code><code class="mi">0</code><code class="p">],</code>
    <code class="nx">todoListEl</code> <code class="o">=</code> <code class="nx">el</code><code class="p">.</code><code class="nx">getElementsByClassName</code><code class="p">(</code><code class="s1">'todo-list'</code><code class="p">)[</code><code class="mi">0</code><code class="p">],</code>
    <code class="nx">clearCompletedEl</code> <code class="o">=</code> <code class="nx">el</code><code class="p">.</code><code class="nx">getElementsByClassName</code><code class="p">(</code><code class="s1">'clear-completed'</code><code class="p">)[</code><code class="mi">0</code><code class="p">];</code>

  <code class="nx">addTodoFormEl</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'submit'</code><code class="p">,</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">evnt</code><code class="p">)</code> <code class="p">{</code>
    <code class="nx">_this</code><code class="p">.</code><code class="nx">addTodo</code><code class="p">(</code><code class="nx">addTodoNameEl</code><code class="p">.</code><code class="nx">value</code><code class="p">)</code>
    <code class="nx">addTodoNameEl</code><code class="p">.</code><code class="nx">value</code> <code class="o">=</code> <code class="s1">''</code><code class="p">;</code>
    <code class="nx">evnt</code><code class="p">.</code><code class="nx">preventDefault</code><code class="p">();</code>
  <code class="p">});</code>

  <code class="nx">todoListEl</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'todo-toggle'</code><code class="p">,</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">evnt</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">todoId</code> <code class="o">=</code> <code class="nx">evnt</code><code class="p">.</code><code class="nx">detail</code><code class="p">.</code><code class="nx">todoId</code><code class="p">;</code>
    <code class="nx">_this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">toggle</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
    <code class="nx">_this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
  <code class="p">});</code>
    
  <code class="nx">clearCompletedEl</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="kd">function</code> <code class="p">()</code> <code class="p">{</code>
    <code class="nx">_this</code><code class="p">.</code><code class="nx">clearCompleted</code><code class="p">();</code>
  <code class="p">});</code>
  
  <code class="k">this</code><code class="p">.</code><code class="nx">todoList</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">TodoListComponent</code><code class="p">(</code><code class="nx">todoListEl</code><code class="p">);</code>
  
  <code class="k">this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now that you’ve got the lay of the land, follow me through the next few sections as I apply all of the TypeScript features I’ve shown in this book to bring this application from ECMAScript 5 to TypeScript.  Because I’ve already shown you all of these features, I’ll be moving through the changes pretty quickly, but I think that watching a “classic” JavaScript application evolve into a TypeScript application is a very helpful way to understand the true power of TypeScript…  and I’ve still got a couple of cool things that I haven’t shown you yet.  So, head on to the next section where I show you how to convert an existing JavaScript file into a TypeScript file.</p>

<h3 id="leanpub-auto-converting-existing-javascript-code-to-typescript">Converting existing JavaScript code to TypeScript</h3>

<p>Perhaps my favorite aspect of TypeScript is that it is a superset of JavaScript which means that “migrating” existing JavaScript applications to TypeScript is pretty much as simple as adding a tsconfig.json file, renaming files from .js to .ts, then updating them to use the new ECMAScript 2015 syntax.  And, in this section, that’s exactly what I’m going to do to the sample Todo application I just walked you through.</p>

<p>The first step in creating or converting any TypeScript application is to define the <code>tsconfig.json</code> file, and luckily this really is as simple as I showed in the earlier sections:</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code> 
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>  
        <code class="s2">"target"</code> <code class="o">:</code> <code class="s2">"es5"</code> 
    <code class="p">}</code> 
<code class="p">}</code>
</pre></div>

</figure>

<p>Next, I’ll jump to the command line and start up the TypeScript compiler in watch mode and leave it running while I make the rest of my changes:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsc</code> <code class="o">-</code><code class="nx">w</code>
</pre></div>

</figure>

<p>Then I can start renaming and upgrading my JavaScript files.</p>

<p>Let’s start the <code>TodoService.js</code> file.<br>
I’ve chosen this file because it is at the heart of my application – it’s the thing keeping track of all of the Todo items.  That means, that if I convert the <code>TodoService</code> class first then when other classes interact with it, TypeScript will be able to use type inference to help push static typing throughout my application, even if I forget to add the type information in the consuming components.</p>

<p>To convert it to TypeScript, start by renaming the file from <code>TodoService.js</code> to <code>TodoService.ts</code>.  </p>

<p>Once I’ve done that, I’ll convert the prototype-based approach into a class:</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
  
  <code class="kr">private</code> <code class="kr">static</code> <code class="nx">_lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

  <code class="kr">private</code> <code class="kr">static</code> <code class="nx">generateTodoId</code><code class="p">()</code><code class="o">:</code> <code class="kt">number</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">_lastId</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
  <code class="p">}</code>
  
  <code class="kr">private</code> <code class="kr">static</code> <code class="nx">clone</code><code class="p">(</code><code class="nx">src</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">clone</code> <code class="o">=</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">src</code><code class="p">);</code>
    <code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">parse</code><code class="p">(</code><code class="nx">clone</code><code class="p">);</code>
  <code class="p">};</code>

  <code class="kr">private</code> <code class="nx">todos</code> <code class="o">=</code> <code class="p">[];</code>

  <code class="kr">constructor</code><code class="p">(</code><code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">_this</code> <code class="o">=</code> <code class="k">this</code><code class="p">;</code>
    
    <code class="k">if</code><code class="p">(</code><code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
      <code class="nx">todos</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">{</code> <code class="nx">_this</code><code class="p">.</code><code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">});</code>
    <code class="p">}</code>
  <code class="p">}</code>

  <code class="nx">add</code><code class="p">(</code><code class="nx">input</code><code class="p">)</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
      <code class="nx">id</code>: <code class="kt">TodoService.generateTodoId</code><code class="p">(),</code>
      <code class="nx">name</code>: <code class="kt">null</code><code class="p">,</code>
      <code class="nx">state</code>: <code class="kt">1</code>
    <code class="p">};</code>

    <code class="k">if</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">input</code> <code class="o">===</code> <code class="s1">'string'</code><code class="p">)</code> <code class="p">{</code>
      <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">input</code><code class="p">;</code>
    <code class="p">}</code> 
    <code class="k">else</code> <code class="k">if</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">input</code><code class="p">.</code><code class="nx">name</code> <code class="o">===</code> <code class="s1">'string'</code><code class="p">)</code> <code class="p">{</code>
      <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">input</code><code class="p">.</code><code class="nx">name</code><code class="p">;</code>
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
      <code class="k">throw</code> <code class="s1">'Invalid Todo name!'</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>

    <code class="k">return</code> <code class="nx">todo</code><code class="p">;</code>
  <code class="p">};</code>


  <code class="nx">clearCompleted() {</code>
     
    <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code>
      <code class="kd">function</code><code class="p">(</code><code class="nx">x</code><code class="p">)</code> <code class="p">{</code> <code class="nx">x</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="mi">1</code><code class="p">;</code> <code class="p">}</code>
    <code class="p">);</code>
  <code class="p">}</code>
  

  <code class="nx">getAll() {</code>
    <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">clone</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">);</code>
  <code class="p">};</code>


  <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">_find</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
    <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">clone</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>
  <code class="p">};</code>
  
  <code class="nx">toggle</code><code class="p">(</code><code class="nx">todoId</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code> <code class="p">{</code>

    <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">_find</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
    
    <code class="k">if</code><code class="p">(</code><code class="o">!</code><code class="nx">todo</code><code class="p">)</code> <code class="k">return</code><code class="p">;</code>
    
    <code class="k">switch</code><code class="p">(</code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code><code class="p">)</code> <code class="p">{</code>
      <code class="k">case</code> <code class="nx">1</code>:
        <code class="kt">todo.state</code> <code class="o">=</code> <code class="mi">2</code><code class="p">;</code>
        <code class="k">break</code><code class="p">;</code>
        
      <code class="k">case</code> <code class="nx">2</code>:
        <code class="kt">todo.state</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
        <code class="k">break</code><code class="p">;</code>
    <code class="p">}</code>
  <code class="p">}</code>

  <code class="kr">private</code> <code class="nx">_find</code><code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">filtered</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code>
      <code class="kd">function</code><code class="p">(</code><code class="nx">x</code><code class="p">)</code> <code class="p">{</code> <code class="nx">x</code><code class="p">.</code><code class="nx">id</code> <code class="o">==</code> <code class="nx">todoId</code><code class="p">;</code> <code class="p">}</code>
    <code class="p">);</code>
    
    <code class="k">if</code> <code class="p">(</code><code class="nx">filtered</code><code class="p">.</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
      <code class="k">return</code> <code class="nx">filtered</code><code class="p">[</code><code class="mi">0</code><code class="p">];</code>
    <code class="p">}</code>
    
    <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
  <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Notice that I’m implementing the <code>lastId</code> counter as a static variable because I want to keep it out of the global scope for now.  When I switch to the external module approach in a little while, I’ll come back and move these into the module scope, exactly like I described in the external module chapter.</p>

<p>Next, I’ll introduce some interfaces to define a few custom types. 
For now, I’ll just define them right here in the file, and then I’ll move them when I’m done.</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code></code><code class="lineno"> 1 </code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
<code class="lineno"> 2 </code>    <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
<code class="lineno"> 3 </code>    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
<code class="lineno"> 4 </code>    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
<code class="lineno"> 5 </code><code class="p">}</code>
<code class="lineno"> 6 </code>
<code class="lineno"> 7 </code><code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
<code class="lineno"> 8 </code>    <code class="nx">Active</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
<code class="lineno"> 9 </code>    <code class="nx">Complete</code> <code class="o">=</code> <code class="mi">2</code>
<code class="lineno">10 </code><code class="p">}</code>
</pre></div>

</figure>

<p>Hey, those types look familiar, don’t they?</p>

<p>And, now that I have those custom types, I’ll apply them to the variables, parameters, and return values throughout my class.</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">id</code>: <code class="kt">number</code><code class="p">;</code>
    <code class="nx">name</code>: <code class="kt">string</code><code class="p">;</code>
    <code class="nx">state</code>: <code class="kt">TodoState</code><code class="p">;</code>
<code class="p">}</code>

<code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
    <code class="nx">Active</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
    <code class="nx">Complete</code> <code class="o">=</code> <code class="mi">2</code>
<code class="p">}</code>

<code class="kr">class</code> <code class="nx">TodoService</code> <code class="p">{</code>
    
    <code class="kr">private</code> <code class="kr">static</code> <code class="nx">_lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

    <code class="kr">private</code> <code class="kr">static</code> <code class="nx">generateTodoId</code><code class="p">()</code><code class="o">:</code> <code class="kt">number</code> <code class="p">{</code>
        <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">_lastId</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
    <code class="p">}</code>
    
    <code class="kr">private</code> <code class="kr">static</code> <code class="nx">clone</code><code class="p">(</code><code class="nx">src</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">clone</code> <code class="o">=</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">src</code><code class="p">);</code>
        <code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">parse</code><code class="p">(</code><code class="nx">clone</code><code class="p">);</code>
    <code class="p">};</code>

    <code class="kr">private</code> <code class="nx">todos</code> <code class="o">=</code> <code class="p">[];</code>

    <code class="kr">constructor</code><code class="p">(</code><code class="nx">todos</code>: <code class="kt">string</code><code class="p">[])</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">_this</code> <code class="o">=</code> <code class="k">this</code><code class="p">;</code>
        
        <code class="k">if</code><code class="p">(</code><code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">todos</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">{</code> <code class="nx">_this</code><code class="p">.</code><code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">});</code>
        <code class="p">}</code>
    <code class="p">}</code>

    <code class="nx">add</code><code class="p">(</code><code class="nx">input</code><code class="p">)</code> <code class="p">{</code>

        <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code>
            <code class="nx">id</code>: <code class="kt">TodoService.generateTodoId</code><code class="p">(),</code>
            <code class="nx">name</code>: <code class="kt">null</code><code class="p">,</code>
            <code class="nx">state</code>: <code class="kt">1</code>
        <code class="p">};</code>

        <code class="k">if</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">input</code> <code class="o">===</code> <code class="s1">'string'</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">input</code><code class="p">;</code>
        <code class="p">}</code> 
        <code class="k">else</code> <code class="k">if</code><code class="p">(</code><code class="k">typeof</code> <code class="nx">input</code><code class="p">.</code><code class="nx">name</code> <code class="o">===</code> <code class="s1">'string'</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">input</code><code class="p">.</code><code class="nx">name</code><code class="p">;</code>
        <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>
            <code class="k">throw</code> <code class="s1">'Invalid Todo name!'</code><code class="p">;</code>
        <code class="p">}</code>

        <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>

        <code class="k">return</code> <code class="nx">todo</code><code class="p">;</code>
    <code class="p">};</code>


    <code class="nx">clearCompleted() {</code>
       
        <code class="k">this</code><code class="p">.</code><code class="nx">todos</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code>
            <code class="kd">function</code><code class="p">(</code><code class="nx">x</code><code class="p">)</code> <code class="p">{</code> <code class="nx">x</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="mi">1</code><code class="p">;</code> <code class="p">}</code>
        <code class="p">);</code>
    <code class="p">}</code>
    

    <code class="nx">getAll() {</code>
        <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">clone</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">);</code>
    <code class="p">};</code>


    <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">_find</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
        <code class="k">return</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">clone</code><code class="p">(</code><code class="nx">todo</code><code class="p">);</code>
    <code class="p">};</code>
    
    <code class="nx">toggle</code><code class="p">(</code><code class="nx">todoId</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code> <code class="p">{</code>

        <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">_find</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
        
        <code class="k">if</code><code class="p">(</code><code class="o">!</code><code class="nx">todo</code><code class="p">)</code> <code class="k">return</code><code class="p">;</code>
        
        <code class="k">switch</code><code class="p">(</code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">case</code> <code class="nx">1</code>:
                <code class="kt">todo.state</code> <code class="o">=</code> <code class="mi">2</code><code class="p">;</code>
                <code class="k">break</code><code class="p">;</code>
                
            <code class="k">case</code> <code class="nx">2</code>:
                <code class="kt">todo.state</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
                <code class="k">break</code><code class="p">;</code>
        <code class="p">}</code>
    <code class="p">}</code>

    <code class="kr">private</code> <code class="nx">_find</code><code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">var</code> <code class="nx">filtered</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code>
            <code class="kd">function</code><code class="p">(</code><code class="nx">x</code><code class="p">)</code> <code class="p">{</code> <code class="nx">x</code><code class="p">.</code><code class="nx">id</code> <code class="o">==</code> <code class="nx">todoId</code><code class="p">;</code> <code class="p">}</code>
        <code class="p">);</code>
        
        <code class="k">if</code> <code class="p">(</code><code class="nx">filtered</code><code class="p">.</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
            <code class="k">return</code> <code class="nx">filtered</code><code class="p">[</code><code class="mi">0</code><code class="p">];</code>
        <code class="p">}</code>
        
        <code class="k">return</code> <code class="kc">null</code><code class="p">;</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>I’ll even replace the magic number that I’m using to indicate the <code>TodoState</code> with the custom <code>TodoState</code> enum that I just defined.</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code class="lineno">82</code> switch(todo.state) {
<code class="lineno">83</code> <code class="udl">  case 1:
</code><code class="lineno">84</code> <code class="udl">    todo.state = 2;
</code><code class="lineno">85</code> <code class="uil">  case TodoState.Active:
</code><code class="lineno">86</code> <code class="uil">    todo.state = TodoState.Complete;
</code><code class="lineno">87</code>     break;
<code class="lineno">88</code>         
<code class="lineno">89</code> <code class="udl">  case 2:
</code><code class="lineno">90</code> <code class="udl">    todo.state = 1;
</code><code class="lineno">91</code> <code class="uil">  case TodoState.Complete:
</code><code class="lineno">92</code> <code class="uil">    todo.state = TodoState.Active;
</code><code class="lineno">93</code>     break;
<code class="lineno">94</code> }
</pre></div>

</figure>

<p>Maybe I’ll add a few overloads to the add method…</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code class="lineno">35</code> <code class="uil">add(todo: Todo): Todo
</code><code class="lineno">36</code> <code class="uil">add(todo: string): Todo
</code><code class="lineno">37</code> add(input): Todo {
</pre></div>

</figure>

<p>Then, I’ll go back and clean up those anonymous functions by turning them into arrow functions… which also lets me get rid of those annoying temporary “_this” variables.</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code class="lineno">27</code>   constructor(todos: string[]) {
<code class="lineno">28</code> <code class="udl">    var _this = this;
</code><code class="lineno">29</code>         
<code class="lineno">30</code>     if(todos) {
<code class="lineno">31</code> <code class="udl">        todos.forEach(function(todo) { _this.add(todo) });
</code><code class="lineno">32</code> <code class="uil">        todos.forEach( todo =&gt; this.add(todo) );
</code><code class="lineno">33</code>       }
<code class="lineno">34</code>   }
</pre></div>

</figure>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code class="lineno">60</code>     this.todos = this.todos.filter(
<code class="lineno">61</code> <code class="udl">        function(x) { x.state == 1; }
</code><code class="lineno">62</code> <code class="uil">        x =&gt; x.state == 1
</code><code class="lineno">63</code>     );
</pre></div>

</figure>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code class="lineno">93</code> private _find(todoId) {
<code class="lineno">94</code>     var filtered = this.todos.filter(
<code class="lineno">95</code> <code class="udl">        function(x) { x.id == todoId; }
</code><code class="lineno">96</code> <code class="uil">        x =&gt; x.id == todoId
</code><code class="lineno">97</code>     );
</pre></div>

</figure>

<p>And, while I’m at it, I’ll turn the clone method into a generic function:</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code class="lineno">20</code> <code class="udl">private static clone(src) {
</code><code class="lineno">21</code> <code class="uil">private static clone&lt;T&gt;(src: T): T {
</code><code class="lineno">22</code>     var clone = JSON.stringify(src);
<code class="lineno">23</code>     return JSON.parse(clone);
<code class="lineno">24</code> };
</pre></div>

</figure>

<p>And with those changes in place, all of the TypeScript errors have gone away which means I’ve successfully converted this JavaScript file into a TypeScript file.</p>

<p>Now let’s head on to the <code>TodoApp</code> and do the same thing, taking advantage of the fact that I’ve already converted the <code>TodoService</code> class.</p>

<p>I’ll start by renaming the file from <code>TodoApp.js</code> to <code>TodoApp.ts</code>.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">mv</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">js</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">ts</code>
</pre></div>

</figure>

<p>Then, convert it to a class…</p>

<figure class="code">
  <figcaption>TodoApp.ts</figcaption>

<div class="highlight"><pre><code></code><code class="lineno"> 1 </code><code class="kr">class</code> <code class="nx">TodoApp</code> <code class="p">{</code>
<code class="lineno"> 2 </code>  
<code class="lineno"> 3 </code>  <code class="kr">private</code> <code class="nx">todoService</code>: <code class="kt">TodoService</code><code class="p">;</code>
<code class="lineno"> 4 </code>  <code class="kr">private</code> <code class="nx">todoList</code>: <code class="kt">TodoListComponent</code><code class="p">;</code>
<code class="lineno"> 5 </code>
<code class="lineno"> 6 </code>  <code class="kr">constructor</code><code class="p">(</code><code class="nx">el</code><code class="p">,</code> <code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno"> 7 </code>
<code class="lineno"> 8 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">TodoService</code><code class="p">(</code><code class="nx">todos</code><code class="p">);</code>
<code class="lineno"> 9 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">initialize</code><code class="p">(</code><code class="nx">el</code><code class="p">);</code>
<code class="lineno">10 </code>  <code class="p">}</code>
<code class="lineno">11 </code>
<code class="lineno">12 </code>  <code class="nx">addTodo</code><code class="p">(</code><code class="nx">todoName</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">13 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">add</code><code class="p">(</code><code class="nx">todoName</code><code class="p">);</code>
<code class="lineno">14 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="lineno">15 </code>  <code class="p">}</code>
<code class="lineno">16 </code>
<code class="lineno">17 </code>  <code class="nx">clearCompleted() {</code>
<code class="lineno">18 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">clearCompleted</code><code class="p">();</code>
<code class="lineno">19 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="lineno">20 </code>  <code class="p">}</code>
<code class="lineno">21 </code>
<code class="lineno">22 </code>  <code class="nx">toggleTodoState</code><code class="p">(</code><code class="nx">todoId</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">23 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">toggle</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
<code class="lineno">24 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="lineno">25 </code>  <code class="p">}</code>
<code class="lineno">26 </code>
<code class="lineno">27 </code>  <code class="nx">renderTodos() {</code>
<code class="lineno">28 </code>    <code class="kd">var</code> <code class="nx">todos</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">getAll</code><code class="p">();</code>
<code class="lineno">29 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">todoList</code><code class="p">.</code><code class="nx">render</code><code class="p">(</code><code class="nx">todos</code><code class="p">);</code>
<code class="lineno">30 </code>  <code class="p">}</code>
<code class="lineno">31 </code>
<code class="lineno">32 </code>  <code class="nx">initialize</code><code class="p">(</code><code class="nx">el</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">33 </code>
<code class="lineno">34 </code>    <code class="kd">var</code> <code class="nx">_this</code> <code class="o">=</code> <code class="k">this</code><code class="p">;</code>
<code class="lineno">35 </code>
<code class="lineno">36 </code>    <code class="kd">var</code> <code class="nx">addTodoFormEl</code> <code class="o">=</code> <code class="nx">el</code><code class="p">.</code><code class="nx">getElementsByClassName</code><code class="p">(</code><code class="s1">'add-todo'</code><code class="p">)[</code><code class="mi">0</code><code class="p">],</code>
<code class="lineno">37 </code>      <code class="nx">addTodoNameEl</code> <code class="o">=</code> <code class="nx">addTodoFormEl</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'input'</code><code class="p">)[</code><code class="mi">0</code><code class="p">],</code>
<code class="lineno">38 </code>      <code class="nx">todoListEl</code> <code class="o">=</code> <code class="nx">el</code><code class="p">.</code><code class="nx">getElementsByClassName</code><code class="p">(</code><code class="s1">'todo-list'</code><code class="p">)[</code><code class="mi">0</code><code class="p">],</code>
<code class="lineno">39 </code>      <code class="nx">clearCompletedEl</code> <code class="o">=</code> <code class="nx">el</code><code class="p">.</code><code class="nx">getElementsByClassName</code><code class="p">(</code><code class="s1">'clear-completed'</code><code class="p">)[</code><code class="mi">0</code><code class="p">];</code>
<code class="lineno">40 </code>
<code class="lineno">41 </code>    <code class="nx">addTodoFormEl</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'submit'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">evnt</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">42 </code>      <code class="nx">_this</code><code class="p">.</code><code class="nx">addTodo</code><code class="p">(</code><code class="nx">addTodoNameEl</code><code class="p">.</code><code class="nx">value</code><code class="p">)</code>
<code class="lineno">43 </code>      <code class="nx">addTodoNameEl</code><code class="p">.</code><code class="nx">value</code> <code class="o">=</code> <code class="s1">''</code><code class="p">;</code>
<code class="lineno">44 </code>      <code class="nx">evnt</code><code class="p">.</code><code class="nx">preventDefault</code><code class="p">();</code>
<code class="lineno">45 </code>    <code class="p">});</code>
<code class="lineno">46 </code>
<code class="lineno">47 </code>    <code class="nx">todoListEl</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'todo-toggle'</code><code class="p">,</code> <code class="kd">function</code><code class="p">(</code><code class="nx">evnt</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">48 </code>      <code class="kd">var</code> <code class="nx">todoId</code> <code class="o">=</code> <code class="nx">evnt</code><code class="p">.</code><code class="nx">detail</code><code class="p">.</code><code class="nx">todoId</code><code class="p">;</code>
<code class="lineno">49 </code>      <code class="nx">_this</code><code class="p">.</code><code class="nx">todoService</code><code class="p">.</code><code class="nx">toggle</code><code class="p">(</code><code class="nx">todoId</code><code class="p">);</code>
<code class="lineno">50 </code>      <code class="nx">_this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="lineno">51 </code>    <code class="p">});</code>
<code class="lineno">52 </code>
<code class="lineno">53 </code>    <code class="nx">clearCompletedEl</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
<code class="lineno">54 </code>      <code class="nx">_this</code><code class="p">.</code><code class="nx">clearCompleted</code><code class="p">();</code>
<code class="lineno">55 </code>    <code class="p">});</code>
<code class="lineno">56 </code>
<code class="lineno">57 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">todoList</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">TodoListComponent</code><code class="p">(</code><code class="nx">todoListEl</code><code class="p">);</code>
<code class="lineno">58 </code>
<code class="lineno">59 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">renderTodos</code><code class="p">();</code>
<code class="lineno">60 </code>  <code class="p">}</code>
<code class="lineno">61 </code>
<code class="lineno">62 </code><code class="p">}</code>
</pre></div>

</figure>

<p>Nothing special here…  Except that, when I define properties on my classes, I like to specify their types with interfaces, rather than depend on implementations directly.  So, let’s hop back to the <code>TodoService</code>, create and implement the <code>ITodoService</code> interface for it…</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code class="lineno">12</code> interface ITodoService {
<code class="lineno">13</code>     add(todo: Todo): Todo;
<code class="lineno">14</code>     add(todo: string): Todo;
<code class="lineno">15</code>     clearCompleted(): void;
<code class="lineno">16</code>     getAll(): Todo[];
<code class="lineno">17</code>     getById(todoId: number): Todo;
<code class="lineno">18</code>     toggle(todoId: number): void;
<code class="lineno">19</code> }
<code class="lineno">20</code> 
<code class="lineno">21</code> <code class="udl">class TodoService {
</code><code class="lineno">22</code> <code class="uil">class TodoService implements ITodoService {
</code></pre></div>

</figure>

<p>Then jump back and use the <code>ITodoService</code> interface for the property type as opposed to the <code>TodoService</code> class itself.</p>

<figure class="code">
  <figcaption>TodoApp.ts</figcaption>

<div class="highlight"><pre><code></code><code class="lineno">4 </code>    <code class="kr">private</code> <code class="nx">todoService</code><code class="o">:</code> <code class="nx">ITodoService</code><code class="p">;</code>
</pre></div>

</figure>

<p>After that the only error I have left is that TypeScript doesn’t know what the <code>TodoListComponent</code> class is, so let’s fix that by converting <code>TodoListComponent.js</code> into TypeScript, too.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">mv</code> <code class="nx">TodoListComponent</code><code class="p">.</code><code class="nx">js</code> <code class="nx">TodoListComponent</code><code class="p">.</code><code class="nx">ts</code>
</pre></div>

</figure>

<figure class="code">
  <figcaption>TodoListComponent.ts</figcaption>

<div class="highlight"><pre><code></code><code class="lineno"> 1 </code><code class="kr">class</code> <code class="nx">TodoListComponent</code> <code class="p">{</code>
<code class="lineno"> 2 </code>  
<code class="lineno"> 3 </code>  <code class="kr">private</code> <code class="nx">$el</code>: <code class="kt">JQueryStatic</code><code class="p">;</code>
<code class="lineno"> 4 </code>  
<code class="lineno"> 5 </code>  <code class="kr">constructor</code><code class="p">(</code><code class="nx">el</code>: <code class="kt">HTMLElement</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno"> 6 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">$el</code> <code class="o">=</code> <code class="nx">$</code><code class="p">(</code><code class="nx">el</code><code class="p">);</code>
<code class="lineno"> 7 </code>  <code class="p">}</code>
<code class="lineno"> 8 </code>  
<code class="lineno"> 9 </code>  <code class="nx">render</code><code class="p">(</code><code class="nx">todos</code>: <code class="kt">Todo</code><code class="p">[])</code> <code class="p">{</code>
<code class="lineno">10 </code>
<code class="lineno">11 </code>    <code class="k">this</code><code class="p">.</code><code class="nx">$el</code><code class="p">.</code><code class="nx">html</code><code class="p">(</code><code class="s1">''</code><code class="p">);</code>
<code class="lineno">12 </code>    
<code class="lineno">13 </code>    <code class="k">if</code> <code class="p">(</code><code class="o">!</code><code class="nx">todos</code><code class="p">.</code><code class="nx">length</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">14 </code>      <code class="k">this</code><code class="p">.</code><code class="nx">$el</code><code class="p">.</code><code class="nx">html</code><code class="p">(</code>
<code class="lineno">15 </code>        <code class="s2">"&lt;div class='list-group-item text-center text-giant'&gt;"</code> <code class="o">+</code>
<code class="lineno">16 </code>        <code class="s2">"  &lt;strong&gt;You've completed everything you needed to do!&lt;/strong&gt;"</code> <code class="o">+</code>
<code class="lineno">17 </code>        <code class="s2">"&lt;/div&gt;"</code>
<code class="lineno">18 </code>      <code class="p">);</code>
<code class="lineno">19 </code>      
<code class="lineno">20 </code>      <code class="k">return</code><code class="p">;</code>
<code class="lineno">21 </code>    <code class="p">}</code>
<code class="lineno">22 </code>    
<code class="lineno">23 </code>    <code class="k">for</code><code class="p">(</code><code class="kd">let</code> <code class="nx">todo</code> <code class="nx">of</code> <code class="nx">todos</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">24 </code>      <code class="k">this</code><code class="p">.</code><code class="nx">renderTodo</code><code class="p">(</code><code class="nx">todo</code><code class="p">).</code><code class="nx">appendTo</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">$el</code><code class="p">);</code>
<code class="lineno">25 </code>    <code class="p">}</code>
<code class="lineno">26 </code>  <code class="p">};</code>
<code class="lineno">27 </code>
<code class="lineno">28 </code>  <code class="nx">renderTodo</code><code class="p">(</code><code class="nx">todo</code>: <code class="kt">Todo</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">29 </code>    <code class="k">return</code> <code class="nx">$</code><code class="p">(</code>
<code class="lineno">30 </code>      <code class="s2">"&lt;div class='todo-item list-group-item "</code><code class="o">+</code> <code class="p">(</code><code class="nx">todo</code><code class="p">.</code><code class="nx">state</code> <code class="o">==</code> <code class="mi">2</code> <code class="o">?</code> <code class="s1">'completed'</code> <code class="o">:\</code>
<code class="lineno">31 </code> <code class="s1">''</code><code class="p">)</code> <code class="o">+</code><code class="s2">"'&gt;"</code> <code class="o">+</code>
<code class="lineno">32 </code>      <code class="s2">"   &lt;div class='row'&gt;"</code> <code class="o">+</code>
<code class="lineno">33 </code>      <code class="s2">"     &lt;div class='col-md-2 text-center'&gt;"</code> <code class="o">+</code>
<code class="lineno">34 </code>      <code class="s2">"       &lt;i class='incomplete glyphicon glyphicon-unchecked text-muted text\</code>
<code class="lineno">35 </code><code class="s2">-giant'&gt;&lt;/i&gt;"</code> <code class="o">+</code>
<code class="lineno">36 </code>      <code class="s2">"       &lt;i class='completed-indicator completed glyphicon glyphicon-ok tex\</code>
<code class="lineno">37 </code><code class="s2">t-giant'&gt;&lt;/i&gt;"</code> <code class="o">+</code>
<code class="lineno">38 </code>      <code class="s2">"     &lt;/div&gt;"</code> <code class="o">+</code>
<code class="lineno">39 </code>      <code class="s2">"     &lt;div class='col-md-10'&gt;"</code> <code class="o">+</code>
<code class="lineno">40 </code>      <code class="s2">"      &lt;span class='incomplete text-giant'&gt;"</code> <code class="o">+</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">+</code> <code class="s2">"&lt;/span&gt;"</code> <code class="o">+</code>
<code class="lineno">41 </code>      <code class="s2">"      &lt;span class='completed text-strikethrough text-muted text-giant'&gt;"</code> <code class="o">\</code>
<code class="lineno">42 </code><code class="o">+</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">name</code> <code class="o">+</code> <code class="s2">"&lt;/span&gt;"</code> <code class="o">+</code>
<code class="lineno">43 </code>      <code class="s2">"    &lt;/div&gt;"</code> <code class="o">+</code>
<code class="lineno">44 </code>      <code class="s2">"  &lt;/div&gt;"</code> <code class="o">+</code>
<code class="lineno">45 </code>      <code class="s2">"  &lt;div class='clearfix'&gt;&lt;/div&gt;"</code> <code class="o">+</code>
<code class="lineno">46 </code>      <code class="s2">"&lt;/div&gt;"</code>
<code class="lineno">47 </code>    <code class="p">).</code><code class="nx">on</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
<code class="lineno">48 </code>      <code class="kd">let</code> <code class="nx">event</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createEvent</code><code class="p">(</code><code class="s1">'CustomEvent'</code><code class="p">);</code>
<code class="lineno">49 </code>      <code class="nx">event</code><code class="p">.</code><code class="nx">initCustomEvent</code><code class="p">(</code><code class="s1">'todo-toggle'</code><code class="p">,</code> <code class="kc">true</code><code class="p">,</code> <code class="kc">true</code><code class="p">,</code> <code class="p">{</code> <code class="nx">todoId</code>: <code class="kt">todo.id</code> <code class="p">});</code>
<code class="lineno">50 </code>      <code class="k">this</code><code class="p">.</code><code class="nx">dispatchEvent</code><code class="p">(</code><code class="nx">event</code><code class="p">);</code>
<code class="lineno">51 </code>    <code class="p">});</code>
<code class="lineno">52 </code>  <code class="p">}</code>
<code class="lineno">53 </code>
<code class="lineno">54 </code><code class="p">}</code>
</pre></div>

</figure>

<p>Now that I’ve converted the <code>TodoListComponent</code>, everything works great and there are only two TypeScript errors left, and they are both about the JQuery APIs that I’m referencing:  </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">TodoListComponent</code><code class="p">.</code><code class="nx">ts</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code><code class="mi">16</code><code class="p">)</code><code class="o">:</code> <code class="nx">error</code> <code class="nx">TS2304</code><code class="o">:</code> <code class="nx">Cannot</code> <code class="nx">find</code> <code class="nx">name</code> <code class="s1">'JQueryStatic'</code><code class="p">.</code>
<code class="nx">TodoListComponent</code><code class="p">.</code><code class="nx">ts</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code><code class="mi">16</code><code class="p">)</code><code class="o">:</code> <code class="nx">error</code> <code class="nx">TS2304</code><code class="o">:</code> <code class="nx">Cannot</code> <code class="nx">find</code> <code class="nx">name</code> <code class="s1">'$'</code><code class="p">.</code>
<code class="nx">TodoListComponent</code><code class="p">.</code><code class="nx">ts</code><code class="p">(</code><code class="mi">29</code><code class="p">,</code><code class="mi">12</code><code class="p">)</code><code class="o">:</code> <code class="nx">error</code> <code class="nx">TS2304</code><code class="o">:</code> <code class="nx">Cannot</code> <code class="nx">find</code> <code class="nx">name</code> <code class="s1">'$'</code><code class="p">.</code>
</pre></div>

</figure>

<p>Regardless, TypeScript generates the JavaScript code for me anyway, which means that I can now run my fully converted TypeScript application.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">lite</code><code class="o">-</code><code class="nx">server</code>
</pre></div>

</figure>

<p>That’s nice that TypeScript compiles my application for me even though I have these two errors, but wouldn’t it be nicer if we could actually get rid of those errors, too, by telling TypeScript about the jQuery library?</p>

<h3 id="leanpub-auto-generating-declaration-files">Generating Declaration Files</h3>

<p>As I demonstrated in the previous section, one of the first major issues that you’re going to face when using TypeScript in a real-world application is that not all libraries are written in TypeScript.  Think about it: people have been creating JavaScript libraries for over 15 years now and TypeScript is only a few years old, so of course that’s case!  So, in this section, I’m going to show you what you can do when you want to consume a JavaScript library that doesn’t have TypeScript type information.</p>

<p>When I left off in the previous section, I had converted all of the JavaScript files in my sample application to TypeScript and ended up with only a couple of errors:  the places that I was referring to jQuery and the jQuery <code>$</code> function to perform DOM manipulation.</p>

<p>The easiest way for me to make these errors go away is to simply tell TypeScript that the <code>$</code> function is a third-party library and not to worry - I know what I’m doing when I use it, so just consider it the “any” type.</p>

<p>Your first instinct might be to do something like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">$</code><code class="o">:</code> <code class="nx">any</code><code class="p">;</code>
</pre></div>

</figure>

<p>And, I guess that might work, but it will also be generated out as JavaScript code and could possibly overwrite the real jQuery <code>$</code> variable.  No, what we need is a way to tell TypeScript about a variable without actually creating a reference to that variable, and in order to do that, we can use the <code>declare</code> keyword, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">declare</code> <code class="kd">var</code> <code class="nx">$</code><code class="o">:</code> <code class="nx">any</code><code class="p">;</code>
</pre></div>

</figure>

<p>If you open up the generated code you can see that this line of code is not included - it only exists for TypeScript’s benefit at design time.</p>

<p>But that approach only makes the errors go away - it doesn’t actually give us strong typing for the jQuery library.  Fortunately, there’s another solution, and that is the combination of TypeScript declaration files and TypeScript Typings library.</p>

<p>A TypeScript declaration file is simply a file that describes a library that’s not written in TypeScript, or perhaps a library that was originally written in TypeScript but then got compiled into JavaScript for distribution.  In these cases, the declaration file describes the type information about the JavaScript code that it goes along with.  If you’ve ever used the C or C++ languages, declaration files are a lot like those – they don’t actually define an implementation themselves, they just describe an implementation that lives in another file.</p>

<p>TypeScript declaration files are made up of their own interesting syntax that you could learn, however you don’t have to.  If you ask it to, TypeScript will generate declaration files for you!</p>

<p>To tell TypeScript that you want declaration files, simply go to the <code>tsconfig.json</code> file and set the <code>declaration</code> compiler option to <code>true</code>:</p>

<figure class="code">
  <figcaption>tsdconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
  <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
    <code class="s2">"target"</code><code class="o">:</code> <code class="s2">"es5"</code><code class="p">,</code>
    <code class="s2">"declaration"</code><code class="o">:</code> <code class="kc">true</code>
  <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, save and run the TypeScript compiler.<br>
When it’s all done compiling you’ll see that not only has TypeScript produced the compiled JavaScript file, but also the corresponding declaration file – a file with the same name as the TypeScript file, only with the <code>.d.ts</code> file extension.</p>


<figure class="image floatleft">
  <img src="./Read Essential TypeScript _ Leanpub_files/RealWorld----project-with-definitions.png" alt="Generated type definitions">
  <figcaption>Generated type definitions</figcaption>
</figure>


<p>When I open one of these files I see that TypeScript includes the same interfaces that I defined, pretty much untouched:</p>

<figure class="code">
  <figcaption>‘TodoService.d.ts’</figcaption>

<div class="highlight"><pre><code></code><code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
  <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
  <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
  <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
<code class="p">}</code>
<code class="kr">interface</code> <code class="nx">ITodoService</code> <code class="p">{</code>
  <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
  <code class="nx">add</code><code class="p">(</code><code class="nx">todo</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
  <code class="nx">clearCompleted</code><code class="p">()</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
  <code class="nx">getAll</code><code class="p">()</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">[];</code>
  <code class="nx">getById</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code><code class="p">;</code>
  <code class="nx">toggle</code><code class="p">(</code><code class="nx">todoId</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>The only difference is that, for any type that represents actual code – things like enums, variables and class definitions - TypeScript attaches the <code>declare</code> keyword to the front to indicate that the type definition just describes an implementation that lives elsewhere.  </p>

<figure class="code">
  <figcaption>‘TodoService.d.ts’</figcaption>

<div class="highlight"><pre><code></code><code class="nx">declare</code> <code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
  <code class="nx">Active</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
  <code class="nx">Complete</code> <code class="o">=</code> <code class="mi">2</code><code class="p">,</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>These kinds of declarations that don’t define an implementation are called <strong>ambient declarations</strong>.</p>

<p>Why would you generate a declaration file for your own TypeScript files?  Well, in cases like this where you’re just using TypeScript to generate JavaScript for a single application, you probably wouldn’t.  But, if you were creating a utility library or some other bit of code that you wanted to share with another team or application, you could generate the JavaScript - probably bundling and minifying it in the process - and then deliver that minified JavaScript along with the TypeScript definition to the other team or application so they have the JavaScript to run and the TypeScript to give them the type information.  In other words, you’ve got the best of both worlds.</p>

<p>You may also be wondering how the ability to generate a TypeScript declaration files would help with our jQuery <code>$</code> function errors…  well, it doesn’t.  But, if we can get ahold of a declaration file that describes the jQuery library for us that somebody else wrote, well that would really help!  Check out the next section where I’ll introduce you to a tool that allows you to download TypeScript declarations for pretty much any popular open source library you might need.</p>

<h3 id="leanpub-auto-referencing-third-party-libraries">Referencing third-party libraries</h3>

<p>As I demonstrated in the previous few sections, one of the first major issues that you’re going to face when using TypeScript in a real-world application is that not all libraries are written in TypeScript.  In the last section, I showed you how TypeScript provides the ability to use declaration files to describe any JavaScript code and, in fact, many JavaScript libraries are beginning to include these declaration files in their distribution packages.  However you’re bound to come across a library that doesn’t include its type information, so in this section I’m going to show you a tool named “TSD” that helps you download TypeScript declarations for pretty much any popular open source library you might want.</p>

<p>Unfortunately, TSD is not installed along with the TypeScript compiler, so you’ll need to install it separately.  You’ll use NPM again, just like for the TypeScript compiler, only this time you’re installing the “tsd” package using this command:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">npm</code> <code class="nx">install</code> <code class="o">-</code><code class="nx">g</code> <code class="nx">tsd</code>
</pre></div>

</figure>

<p>Notice the message during the installation mentioning that the TSD tool is deprecated in favor of a new tool named Typings.  As of the time of this writing - March, 2016 - this tool is very new and personally I don’t think it’s mature enough yet so I’m going to stick with TSD for the time being.  But, keep an eye on it as it promises that it will allow you to install all of the type definitions that the TSD tool does, plus more!</p>

<p>Once you’ve got TSD installed, you can use its “query” command to search for packages.  For instance, if I want to find type information for jquery, I can say:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsd</code> <code class="nx">query</code> <code class="nx">jquery</code>
</pre></div>

</figure>

<p>I can see here that TSD found a result for jquery.  Since it found something, I know I can safely install that package using the install command and passing it the package name, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsd</code> <code class="nx">install</code> <code class="nx">jquery</code>
</pre></div>

</figure>

<p>This will download all of the type information and add it to my project in a new folder named “typings”.</p>


<figure class="image floatright">
  <img src="./Read Essential TypeScript _ Leanpub_files/RealWorld----typings.png" alt="Typings folder">
  <figcaption>Typings folder</figcaption>
</figure>


<p>If you open the <code>jquery.d.ts</code> file, you can see the ambient declaration of the full jQuery library, complete with comments!
Now, if you go back to <code>TodoListComponent.ts</code> - and remove that silly <code>declare</code> statement that I made before - I can get full autocomplete and IntelliSense information for the jQuery library - all provided by that new type declaration!</p>

<p>And, of course, since Visual Studio Code is not showing me any errors, that means the tsc compiler is now happy, too!</p>

<p>Note that using tsd in this way just downloads the typings once.<br>
Generally speaking, once you’ve found the type definition that your project depends on, you’re going to want to save a reference to that definition in your source control as opposed to the definition itself.  Luckily, tsd supports that:  just run the tsd install command but this time add the <code>--save</code> flag to the end.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsd</code> <code class="nx">install</code> <code class="nx">jquery</code> <code class="o">--</code><code class="nx">save</code>
</pre></div>

</figure>

<p>Just like last time, tsd says that it installed 1 <code>.d.ts</code> file, however this time it also created a special file named <code>tsd.json</code> that contains a reference to the type definition file that it installed so it’s easier to get later.</p>

<figure class="code">
  <figcaption>tsd.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
  <code class="s2">"version"</code><code class="o">:</code> <code class="s2">"v4"</code><code class="p">,</code>
  <code class="s2">"repo"</code><code class="o">:</code> <code class="s2">"borisyankov/DefinitelyTyped"</code><code class="p">,</code>
  <code class="s2">"ref"</code><code class="o">:</code> <code class="s2">"master"</code><code class="p">,</code>
  <code class="s2">"path"</code><code class="o">:</code> <code class="s2">"typings"</code><code class="p">,</code>
  <code class="s2">"bundle"</code><code class="o">:</code> <code class="s2">"typings/tsd.d.ts"</code><code class="p">,</code>
  <code class="s2">"installed"</code><code class="o">:</code> <code class="p">{</code>
    <code class="s2">"jquery/jquery.d.ts"</code><code class="o">:</code> <code class="p">{</code>
      <code class="s2">"commit"</code><code class="o">:</code> <code class="s2">"dade4414712ce84e3c63393f1aae407e9e7e6af7"</code>
    <code class="p">}</code>
  <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With this file in place, I can exclude the typings folder from source control and every time I get the project I can run the tsd install command with no parameters to restore all of the type definitions that I’ve saved into the tsd.config file:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">rm</code> <code class="o">-</code><code class="nx">rf</code> <code class="nx">typings</code>
<code class="nx">tsd</code> <code class="nx">install</code>
</pre></div>

</figure>

<p>Where are all of these typings coming from you might be wondering?
There is a community-supported hosted on GitHub named DefinitelyTyped (<a href="https://github.com/DefinitelyTyped/DefinitelyTyped">github.com/DefinitelyTyped</a>.<br>
If you navigate into the repository, you can see that it has hundreds of type defintions – so many in fact that GitHub has to truncate the list after 1,000 entries!  Pretty impressive.</p>

<p>So, the next time you use your favorite open source library and it doesn’t include TypeScript type information, use TSD or check out the GitHub repository to see if the library is listed and download it from there.  I have yet to find a library that isn’t in here…  and, hey, if it doesn’t exist, maybe you could contribute your own definition!</p>

<h3 id="leanpub-auto-converting-to-external-modules">Converting to External Modules</h3>

<p>In this chapter, I’ve walked you step-by-step through converting an existing JavaScript application to TypeScript, and at this point I’m pretty much done – I could stop here.  I could stop, but instead let’s go the extra step to get all of our code out of the global namespace and into external modules.  I’m going to move quickly through this section because I already covered most of what I’m about to show you in the modules chapter.  However, there are a few little tips and tricks that I still wanted to share, so let’s get on with it.</p>

<p>Before I get started, I just want to point out that I moved the <code>Todo</code> and <code>TodoState</code> enum types into their own <code>Model.ts</code> file in between the last section and this one, just like I said I would.  This shouldn’t make any difference, I just didn’t want to catch you by surprise.</p>

<p>First, I’ll start by setting the <code>module</code> compiler option in <code>tsconfig.json</code> to “system” because I’m going to use the system.js module loader again.</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
        <code class="s2">"module"</code><code class="o">:</code> <code class="s2">"system"</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, I’ll go through each file, exporting its types and importing types from the other modules it depends on.</p>

<p>I’ll start with the TodoService, importing the Todo and TodoState from the Model module:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="nx">Todo</code><code class="p">,</code> <code class="nx">TodoState</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Then, I’ll export the <code>ITodoService</code> interface and <code>TodoService</code> class…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="nx">ITodoService</code> <code class="p">{</code>

<code class="c1">// ...</code>

<code class="kr">export</code> <code class="nx">TodoService</code> <code class="kr">implements</code> <code class="nx">ITodoService</code> <code class="p">{</code>
</pre></div>

</figure>

<p>And, since I’m in here, I’ll move those static variables out of the class and into the module scope so that they can be truly private.</p>

<figure class="code">
<div class="highlight"><pre>import { Todo, TodoState } from './Model';

export interface ITodoService {
    add(todo: Todo): Todo;
    add(todo: string): Todo;
    clearCompleted(): void;
    getAll(): Todo[];
    getById(todoId: number): Todo;
    toggle(todoId: number): void;
}

<code class="uil">let _lastId = 0;
</code><code class="uil">
</code><code class="uil">function generateTodoId(): number {
</code><code class="uil">    return _lastId += 1;
</code><code class="uil">}
</code><code class="uil">
</code><code class="uil">function clone&lt;T&gt;(src: T): T {
</code><code class="uil">    var clone = JSON.stringify(src);
</code><code class="uil">    return JSON.parse(clone);
</code><code class="uil">};
</code>
export default class TodoService implements ITodoService {

<code class="udl">    private static _lastId = 0;
</code><code class="udl">
</code><code class="udl">    private static generateTodoId(): number {
</code><code class="udl">        return TodoService._lastId += 1;
</code><code class="udl">    }
</code><code class="udl">    
</code><code class="udl">    private static clone&lt;T&gt;(src: T): T {
</code><code class="udl">        var clone = JSON.stringify(src);
</code><code class="udl">        return JSON.parse(clone);
</code><code class="udl">    };
</code>
    private todos = [];
</pre></div>

</figure>

<p>Of course, when I do this, I need to fix all the references…</p>

<figure class="code">
<div class="highlight"><pre>    var todo = {
<code class="udl">        id: TodoService.generateTodoId(),
</code><code class="uil">        id: generateTodoId(),
</code>        name: null,
        state: 1
    };
    
    // ...

    getAll() {
<code class="udl">        return TodoService.clone(this.todos);
</code><code class="uil">        return clone(this.todos);
</code>    };

    // ...

    getById(todoId) {
        var todo = this._find(todoId);
<code class="udl">        return TodoService.clone(todo);
</code><code class="uil">        return clone(todo);
</code>    };
</pre></div>

</figure>

<p>Next, I’ll move on to the <code>TodoListComponent</code>.  </p>

<p>First, I’ll import the <code>Todo</code> interface from the Model…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="nx">Todo</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Then I’ll export the class…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="kr">class</code> <code class="nx">TodoListComponent</code>
</pre></div>

</figure>

<p>Now, this module is interesting because it depends on the jQuery library which right now I’m loading from a CDN!  </p>

<p>But, the module loader doesn’t care if I put a full URL in there, so I’ll just copy this URL and directly reference it as an import.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="s1">'//code.jquery.com/jquery-1.12.1.min.js'</code><code class="p">;</code>
</pre></div>

</figure>

<p>And, since I’m just loading it just so that it is available to this module, I’m not actually importing any types from it.  I’m just adding this import statement to let the module loader know that this module expects the library to be loaded and available before the module itself gets loaded.</p>

<p>Also, It’s important to keep in mind that TypeScript knows about the jQuery types from the type declaration I installed earlier, not because I’m importing it as a module import!</p>

<p>And then there’s the <code>TodoApp</code> component…  Just like the others, I’ll import my dependencies and export the TodoApp class.  </p>

<figure class="code">
  <figcaption>TodoApp.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="nx">Todo</code><code class="p">,</code> <code class="nx">TodoState</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">TodoService</code><code class="p">,</code> <code class="nx">ITodoService</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./TodoService'</code><code class="p">;</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">TodoListComponent</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./TodoListComponent'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Notice that I’m not importing the jQuery library – that is not my dependency!  jQuery will get loaded at runtime because the TodoApp module is loaded and the TodoApp module depends on the TodoListComponent, which depends on the jQuery library.  Right after encapsulation and keeping things out of the global scope, it’s this separation of concerns is the true power of the external module approach.</p>

<p>Also, here’s another option that you have when exporting members from a module - you can choose one member to be the “default” member of the module, which changes both the export and the import syntax ever so slightly…</p>

<p>I’ll start by exporting the <code>TodoService</code> class as the default export of this module by simply adding the keyword “default” after the export keyword:</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="k">default</code> <code class="kr">class</code> <code class="nx">TodoService</code> <code class="kr">implements</code> <code class="nx">ITodoService</code> <code class="p">{</code>
</pre></div>

</figure>

<p>Note, even though I can only have one default export, I can still export other members normally like I’m doing with the <code>ITodoService</code> interface.</p>

<p>Then, I can switch back to the TodoApp and import the new default export by simply removing the brackets around it, like this:</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">TodoService</code> <code class="nx">from</code> <code class="s1">'./TodoService'</code><code class="p">;</code>
</pre></div>

</figure>

<p>When I do this, TypeScript now warns me that it doesn’t know about <code>ITodoService</code> anymore, so I have to add it back.<br>
Luckily, you can import both default exports and regular exports all in one line by adding a comma between the default import and the import brackets like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">TodoService</code><code class="p">,</code> <code class="p">{</code> <code class="nx">ITodoService</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./TodoService'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Once that’s done, I’ll head back to the <code>index.html</code> file and clean that up by removing all of the script tags that refer to my individual JavaScript files and replace them with a single script reference to System.js.</p>

<figure class="code">
  <figcaption>index.html</figcaption>

<div class="highlight"><pre><code></code><code class="o">&lt;</code><code class="nx">script</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text/javascript"</code> <code class="nx">src</code><code class="o">=</code><code class="s2">"//cdnjs.cloudflare.com/ajax/libs/systemjs/0.\</code>
<code class="s2">19.22/system.js"</code><code class="o">&gt;&lt;</code><code class="err">/script&gt;</code>
</pre></div>

</figure>

<p>And, like last time, I’ll add that <code>defaultJSExtensions = true</code> setting:</p>

<figure class="code">
  <figcaption>index.html</figcaption>

<div class="highlight"><pre><code></code><code class="o">&lt;</code><code class="nx">script</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text/javascript"</code><code class="o">&gt;</code>
    <code class="nx">System</code><code class="p">.</code><code class="nx">defaultJSExtensions</code> <code class="o">=</code> <code class="kc">true</code><code class="p">;</code>
<code class="o">&lt;</code><code class="err">/script&gt;</code>
</pre></div>

</figure>

<p>Notice that this demo is a little bit different than the one from the modules chapter in that I’m not actually initializing the application in the TodoApp module - that module just provides the application class and I need to wire it up.  Luckily, the System.import() function returns the module to me in a promise, so I can dig into that promise to pull out my class and create a new instance of it, like this:</p>

<figure class="code">
  <figcaption>index.html</figcaption>

<div class="highlight"><pre><code></code><code class="nx">System</code><code class="p">.</code><code class="kr">import</code><code class="p">(</code><code class="s1">'TodoApp'</code><code class="p">).</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">module</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">new</code> <code class="nx">module</code><code class="p">.</code><code class="nx">TodoApp</code><code class="p">(</code><code class="nb">document</code><code class="p">,</code> <code class="p">[</code>
        <code class="s1">'Pick up drycleaning'</code><code class="p">,</code>
        <code class="s1">'Clean Batcave'</code><code class="p">,</code>
        <code class="s1">'Save Gotham'</code>
    <code class="p">]);</code>
<code class="p">})</code>
</pre></div>

</figure>

<p>And that’s it!  Now I can switch back to the command line, run the TypeScript compiler…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsc</code>
</pre></div>

</figure>

<p>And then launch the site to prove that it all works!</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">lite</code><code class="o">-</code><code class="nx">server</code>
</pre></div>

</figure>

<p>And there you go - a fully-working TypeScript application, starting with an existing JavaScript application and converting to TypeScript.  Even though most of this section was rehashing features that I’ve already demonstrated in previous sections, hopefully seeing it in action with slightly more real-world examples helps bring it home a little bit more.</p>

<p>Now that I’ve shown you how to convert an existing JavaScript application, head on to the next section where I’ll show you how to debug it!</p>

<h3 id="leanpub-auto-debugging-typescript-with-source-maps">Debugging TypeScript with source maps</h3>

<p>In this chapter I took all of the TypeScript features that I’ve shown throughout this book and used them to convert an existing JavaScript application into a TypeScript application.  But, what I didn’t show it’s the realest of the real-world scenarios and that is using a debugger to find bugs!  In this section, I’ll introduce you to the concept of source maps and show you how they enable you to debug your TypeScript code right inside the browser!</p>

<p>I’ll start by strategically introducing a bug into my code… because of course the only way bugs can get into your code is when you deliberately put them in there…  right?</p>

<figure class="code">
  <figcaption>TodoApp.ts</figcaption>

<div class="highlight"><pre><code class="lineno">51</code> <code class="udl">	var todoId = evnt.detail.todoId;
</code><code class="lineno">52</code> <code class="uil">	var todoId = evnt.details.todoId;
</code></pre></div>

</figure>

<p>Then, I’ll run the site and enable “break on exceptions”, then watch it crash when I click a Todo to toggle its state…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">tsc</code>
<code class="nx">lite</code><code class="o">-</code><code class="nx">server</code>
</pre></div>

</figure>

<p>Notice how Chrome brings me to the line of JavaScript code that my error is on, which is line 31 in the generated JavaScript file:  </p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/RealWorld----debugging-without-sourcemaps.png" alt="Poor debugging experience">
  <figcaption>Poor debugging experience</figcaption>
</figure>


<p>But, the bug is actually on line 51 of my TypeScript code! Luckily in this case it’s pretty easy to figure out where this was in my TypeScript file, but other times it’s not so straight-forward.  Plus, I’m not working in JavaScript - I’m working in TypeScript, so why do I care about which JavaScript line has an error?</p>

<p>The answer to all of this is an emerging browser feature called a “Source map”.  The source map feature allows language compilers to tell browsers where, exactly, a particular variable or expression lives in the original source code, regardless of what that source code is.  Then, when I open up the page in the debugger, the browser will load that source file, read in that metadata, and if any errors occur, the browser can take me to the line in the SOURCE code where the error occurred, not the JavaScript code.  In other words, I could create my own brand new language named “JessScript” and as long as I provide the correct source map information for the JavaScript that “JessScript” emits, I can have full, native debugging support for my new language right there in the browser.</p>

<p>What’s this got to do with TypeScript?  </p>

<p>Well, try setting the <code>sourceMap</code> compiler option to <code>true</code> and run the TypeScript compiler again.</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
  <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
    <code class="c1">//...</code>
    <code class="s2">"sourceMap"</code><code class="o">:</code> <code class="kc">true</code>
  <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With that compiler option in place, TypeScript is now generating a new type of file for each TypeScript file - a <code>.js.map</code> file.  If I open up one of these files, I can see all of the metadata that TypeScript has generated – this is the source mapping information that tells the browser which JavaScript expressions map to which lines of TypeScript code!</p>

<p>So now when I reload the browser and run into that exception again, the browser takes me to the offending line of code in my TypeScript file as opposed to the generated JavaScript output!  </p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/RealWorld----debugging-sourcemaps.png" alt="Debugging source maps">
  <figcaption>Debugging source maps</figcaption>
</figure>


<p>And, I’ve still got full debugging support - I can hover over variables, use the console to execute expressions, etc.  Everything works just like I’d expect it to.</p>

<p>But, how’d the browser know which source map to load? Well, if I jump back to the generated JavaScript and scroll alllll the way to the end, I see this comment at the bottom:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="c1">//# sourceMappingURL=TodoService.js.map</code>
</pre></div>

</figure>

<p>But, this isn’t an ordinary comment - it’s actually metadata telling the browser where it can find the source map file.  As soon as the browser sees this, it downloads the file - and any of the source files that the source map refers to - and loads them up in the debugger, ready for me to step through them.</p>

<p>Perhaps the most interesting thing about this feature is that it’s not a TYpeScript feature at all.  I mean, TypeScript knows how to generate the source mapping metadata, but it’s the browsers that do all of the hard work of downloading and parsing the source maps, then mapping all of the JavaScript code to my custom code.  I don’t know about you, but I find this feature pretty amazing, and it’s proven very helpful to me several times.  I’m sure it will help save you at some point, too!</p>

<h2 id="decorators">
<span class="section-number">11. </span>Decorators</h2>

<p>At this point in the book, I’ve shown you all the features that you’ll need in order to leverage TypeScript in your day-to-day JavaScript development.  I also walked you through how to convert an existing JavaScript application into TypeScript as well as how to debug TypeScript applications in the browser.  Even though I’ve explained enough for you to be very productive with TypeScript, I’ve still got one last feature to show you in this chapter and that is <strong>decorators</strong>.  </p>

<p>Decorators are a <em>proposed</em> ECMAScript syntax that allow you to implement the Decorator design pattern to modify the behavior of a class, method, property, or parameter in a declarative fashion.  This powerful approach allows you to define common behavior in a central place and easily apply it across your application to reduce duplicate code and make your code more readable and maintainable all at the same time.</p>

<p>For instance, let’s say I want to log every single time a method is called and after it’s done executing.  If I were to do this with normal, imperative, inline code it’d look something like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">add</code><code class="p">(</code><code class="nx">input</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`add(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">input</code><code class="p">)</code><code class="si">}</code><code class="sb">)`</code><code class="p">);</code>
    <code class="c1">// Add Todo        </code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`add(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">input</code><code class="p">)</code><code class="si">}</code><code class="sb">) =&gt; </code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code><code class="si">}</code><code class="sb">`</code><code class="p">);</code>

    <code class="k">return</code> <code class="nx">todo</code><code class="p">;</code>
<code class="p">};</code>
</pre></div>

</figure>

<p>You don’t need TypeScript to apply the Decorator design pattern to this problem.  If you really wanted to add the logging logic without changing the code inside of the <code>add</code> method, you could wrap the original method in another method.</p>

<p>For example, you can start like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">originalMethod</code> <code class="o">=</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">add</code><code class="p">;</code>

<code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">add</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(...</code><code class="nx">args</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">returnValue</code> <code class="o">=</code> <code class="nx">originalMethod</code><code class="p">.</code><code class="nx">apply</code><code class="p">(</code><code class="k">this</code><code class="p">,</code> <code class="nx">args</code><code class="p">);</code>
    <code class="k">return</code> <code class="nx">returnValue</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>This is your basic method decorator pattern - it replaces the original method with another method that duplicates the original method’s behavior by actually calling that method and returning its result.</p>

<p>Once I have this basic structure in place, I can now start adding logic before and after the original method is called, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="lineno"> 1 </code><code class="kd">var</code> <code class="nx">originalMethod</code> <code class="o">=</code> <code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">add</code><code class="p">;</code>
<code class="lineno"> 2 </code>
<code class="lineno"> 3 </code><code class="nx">TodoService</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">add</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(...</code><code class="nx">args</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno"> 4 </code>    
<code class="lineno"> 5 </code>    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`add(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">args</code><code class="p">)</code><code class="si">}</code><code class="sb">)`</code><code class="p">)</code>
<code class="lineno"> 6 </code>    
<code class="lineno"> 7 </code>    <code class="kd">let</code> <code class="nx">returnValue</code> <code class="o">=</code> <code class="nx">originalMethod</code><code class="p">.</code><code class="nx">apply</code><code class="p">(</code><code class="k">this</code><code class="p">,</code> <code class="nx">args</code><code class="p">);</code>
<code class="lineno"> 8 </code>
<code class="lineno"> 9 </code>    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`add(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">args</code><code class="p">)</code><code class="si">}</code><code class="sb">) =&gt; </code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">returnValue</code><code class="p">)</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code>
<code class="lineno">10 </code>    
<code class="lineno">11 </code>    <code class="k">return</code> <code class="nx">returnValue</code><code class="p">;</code>
<code class="lineno">12 </code><code class="p">}</code>
</pre></div>

</figure>

<p>Here I’ve added two logging statements, one on line 5 right at the entry into the call and the other on line 9, after the original method has been called but before I return the value that the original method returned.  This approach even allows me to include the return value in my log statements.</p>

<p>The net result of all of this is a method that wraps another method, allowing me to attach behavior to the method while keeping the logic defined in the original method completely unchanged.  Used appropriately, this approach can be incredibly powerful.</p>

<p>Ok, so that’s an example of the decorator pattern.  Now let’s see ECMAScript Decorators in action.  </p>

<p>In order to apply a decorator to a method, you simply apply an <code>@</code> followed by the decorator name in front of the member that you want to decorate, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="err">@</code><code class="nx">log</code>
<code class="nx">add</code><code class="p">(</code><code class="nx">input</code><code class="p">)</code><code class="o">:</code> <code class="nx">Todo</code> <code class="p">{</code>
</pre></div>

</figure>

<p>Here I’ve told ECMAScript to attach the behavior defined in a method decorator named <code>log</code> to the <code>add</code> method – a method decorator that is going to have the same exact logic that I just showed a minute ago.</p>

<p>What’s a decorator?  Well, it’s just a function with a special signature.  As I mentioned earlier, ECMAScript Decorators support four different targets - classes, methods, properties, and parameters - and their signatures look like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">declare</code> <code class="nx">type</code> <code class="nx">ClassDecorator</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">TFunction</code> <code class="kr">extends</code> <code class="nb">Function</code><code class="o">&gt;</code><code class="p">(</code>
        <code class="nx">target</code><code class="o">:</code> <code class="nx">TFunction</code>
    <code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">TFunction</code> <code class="o">|</code> <code class="k">void</code><code class="p">;</code>

<code class="nx">declare</code> <code class="nx">type</code> <code class="nx">PropertyDecorator</code> <code class="o">=</code> <code class="p">(</code>
        <code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> 
        <code class="nx">propertyKey</code><code class="o">:</code> <code class="nx">string</code> <code class="o">|</code> <code class="nx">symbol</code>
    <code class="p">)</code> <code class="o">=&gt;</code> <code class="k">void</code><code class="p">;</code>
    
<code class="nx">declare</code> <code class="nx">type</code> <code class="nx">MethodDecorator</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code><code class="p">(</code>
        <code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> 
        <code class="nx">propertyKey</code><code class="o">:</code> <code class="nx">string</code> <code class="o">|</code> <code class="nx">symbol</code><code class="p">,</code> 
        <code class="nx">descriptor</code><code class="o">:</code> <code class="nx">TypedPropertyDescriptor</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code>
    <code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">TypedPropertyDescriptor</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code> <code class="o">|</code> <code class="k">void</code><code class="p">;</code>
    
<code class="nx">declare</code> <code class="nx">type</code> <code class="nx">ParameterDecorator</code> <code class="o">=</code> <code class="p">(</code>
        <code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> 
        <code class="nx">propertyKey</code><code class="o">:</code> <code class="nx">string</code> <code class="o">|</code> <code class="nx">symbol</code><code class="p">,</code> 
        <code class="nx">parameterIndex</code><code class="o">:</code> <code class="nx">number</code>
    <code class="p">)</code> <code class="o">=&gt;</code> <code class="k">void</code><code class="p">;</code>
</pre></div>

</figure>

<p>By the way, if you’re wondering how I got to this definition, it’s one of the core definitions that ships with TypeScript so I just created a variable with one of these names</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">x</code><code class="o">:</code> <code class="nx">ClassDecorator</code>
</pre></div>

</figure>

<p>Then, selected the type and said “Go to Definition”, which brought me here.</p>

<p>I’ll show you how to create and use each of these decorators in this chapter, but in this section, I’ll start by showing you how to implement a method decorator and which looks like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">log</code><code class="p">(</code>
    <code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">methodName</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> 
    <code class="nx">descriptor</code><code class="o">:</code> <code class="nx">TypedPropertyDescriptor</code><code class="o">&lt;</code><code class="nb">Function</code><code class="o">&gt;</code>
<code class="p">)</code>
</pre></div>

</figure>

<ul>
  <li>The <code>target</code> parameter is the object that the member lives on – in this example, it’ll be an instance of a TodoService.</li>
  <li>The <code>methodName</code> parameter is the name of the method to be decorated</li>
  <li>And, finally, the <code>descriptor</code> is an object that contains all of the metadata for the method that you’re looking to modify. </li>
</ul>

<p>The descriptor object has a handful of properties that describe the member being decorated, but in this case the one I’m really looking for is the <code>value</code> property which is the method itself.</p>

<p>Remember that Decorator pattern example I just showed you?  Well, <code>descriptor.value</code> is really just the value of the <code>originalMethod</code> method in my previous example!</p>

<p>That means that I can just copy that code into this log decorator function and modify it a bit, changing the references from <code>TodoService.add</code> to <code>descriptor.value</code> instead…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">log</code><code class="p">(</code>
    <code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">methodName</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> 
    <code class="nx">descriptor</code><code class="o">:</code> <code class="nx">TypedPropertyDescriptor</code><code class="o">&lt;</code><code class="nb">Function</code><code class="o">&gt;</code>
<code class="p">)</code> <code class="p">{</code>
    
    <code class="kd">var</code> <code class="nx">originalMethod</code> <code class="o">=</code> <code class="nx">descriptor</code><code class="p">.</code><code class="nx">value</code><code class="p">;</code>
    
    <code class="nx">descriptor</code><code class="p">.</code><code class="nx">value</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(...</code><code class="nx">args</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`TodoService.add(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">args</code><code class="p">)</code><code class="si">}</code><code class="sb">)`</code><code class="p">)</code>
        
        <code class="kd">let</code> <code class="nx">returnValue</code> <code class="o">=</code> <code class="nx">originalMethod</code><code class="p">.</code><code class="nx">apply</code><code class="p">(</code><code class="k">this</code><code class="p">,</code> <code class="nx">args</code><code class="p">);</code>
    
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`TodoService.add(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">args</code><code class="p">)</code><code class="si">}</code><code class="sb">) =&gt; </code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringif</code><code class="o">\</code>
<code class="nx">y</code><code class="p">(</code><code class="nx">returnValue</code><code class="p">)</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code>
        
        <code class="k">return</code> <code class="nx">returnValue</code><code class="p">;</code>
    <code class="p">}</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>Of course, I’ll need to change the hard-coded method name to make this decorator say the name of the method that’s being wrapped, but that’s pretty easy:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="sb">`</code><code class="si">${</code><code class="nx">methodName</code><code class="si">}</code><code class="sb">(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">args</code><code class="p">)</code><code class="si">}</code><code class="sb">)`</code>
</pre></div>

</figure>

<p>And that’s how you write and your own method decorator!</p>

<p>However, there is one thing stopping me from running this code right now…  If I hover over the decorator, I can see that TypeScript is giving me an error.  This is because, while TypeScript does allow you to create and consume decorators, they are still just an ECMAScript proposal at the time of this writing, so the compiler takes a very conservative approach and will refuse to allow the use of decorators unless you to opt-in to the functionality by setting a compiler flag.  </p>

<p>That means that in order to get this to compile property, I’ll need to open up the <code>tsconfig.json</code> file and set the <code>"experimentalDecorators"</code> flag to <code>true</code>.</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
        <code class="s2">"experimentalDecorators"</code><code class="o">:</code> <code class="kc">true</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>With that setting in place, the TypeScript error goes away, I can compile my code, and run my application to see my new decorator in action.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Decorators----log-decorator-console.png" alt="Log decorator in action">
  <figcaption>Log decorator in action</figcaption>
</figure>


<p>Pretty cool, huh?  Well, if you think that’s cool, what if I told you that in addition to being able to decorate methods, you can also define decorators for properties, accessors, classes, and even method parameters!  What’s more, they’re all just variations of the method decorator function that I implemented in this section.  So, if you’re interested in seeing how to create these other types of decorators and use them to easily  and effectively add dynamic behavior throughout your application, please check out the rest of this chapter!</p>

<h3 id="class-decorators">Implementing Class Decorators</h3>

<p>In the previous section, I introduced you to the concept of decorators and even showed you how to use them in order to quickly and easily add logic that executed before and after a method – without modifying the code in the method itself!  In the rest of this chapter, I’m going to show you how to create and apply class and property decorators to implement a mini validation framework to enable runtime-checking of property and parameter values.  And in this section I’ll start with the easiest one:  the class decorator.</p>

<p>I’ll start by creating a new TypeScript file to hold everything and import my model types.</p>

<figure class="code">
  <figcaption>Validators.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code><code class="nx">Todo</code><code class="p">,</code> <code class="nx">TodoState</code><code class="p">}</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>Then, I’ll create a class that implements the <code>Todo</code> interface so that I have something to decorate.</p>

<figure class="code">
  <figcaption>Validators.ts</figcaption>

<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="kr">class</code> <code class="nx">ValidatableTodo</code> <code class="kr">implements</code> <code class="nx">Todo</code> <code class="p">{</code>
    
    <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>Just as method decorators are used to decorate a method, class decorators decorate a class – in other words, the can be used to modify the class’s constructor function and its prototype members after the class has been defined.</p>

<p>One good example of using class decorators is to dynamically attach methods to a class definition.  For example, let’s say that I want to define one single <code>validate</code> method and be able to attach it to any class in my application.</p>

<p>Let’s see what it’d look like if I did this manually, without decorators.</p>

<p>First, I’d create the validate function itself:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="lineno"> 1 </code><code class="kr">export</code> <code class="kd">function</code> <code class="nx">validate</code><code class="p">()</code> <code class="p">{</code>
<code class="lineno"> 2 </code>    
<code class="lineno"> 3 </code>    <code class="kd">let</code> <code class="nx">validators</code> <code class="o">=</code> <code class="p">[].</code><code class="nx">concat</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">_validators</code><code class="p">),</code>
<code class="lineno"> 4 </code>        <code class="nx">errors</code> <code class="o">=</code> <code class="p">[];</code>
<code class="lineno"> 5 </code>    
<code class="lineno"> 6 </code>    <code class="k">for</code><code class="p">(</code><code class="kd">let</code> <code class="nx">validator</code> <code class="k">of</code> <code class="nx">validators</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno"> 7 </code>        <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="nx">validator</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>
<code class="lineno"> 8 </code>        
<code class="lineno"> 9 </code>        <code class="k">if</code><code class="p">(</code><code class="o">!</code><code class="nx">result</code><code class="p">.</code><code class="nx">isValid</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">10 </code>            <code class="nx">errors</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="nx">result</code><code class="p">);</code>
<code class="lineno">11 </code>        <code class="p">}</code>
<code class="lineno">12 </code>    <code class="p">}</code>
<code class="lineno">13 </code>    
<code class="lineno">14 </code>    <code class="k">return</code> <code class="nx">errors</code><code class="p">;</code>
<code class="lineno">15 </code><code class="p">}</code>
</pre></div>

</figure>

<p>This function just tries to find an array of validators on the current instance and then iterates through them, calling each one and looking at its result.  If the result is not valid, I add it to the list of errors and then return all the errors at the end.  Notice how I used the <code>array.concat</code> method on line 3 to get the array of validators.  The <code>array.concat</code> method accepts null or undefined values which means that if no validators have been registered, this array will simply be empty and I won’t have to do any null checks.</p>

<p>And, actually, since this is a TypeScript book, let me add some types in here:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="kr">interface</code> <code class="nx">IValidatable</code> <code class="p">{</code>
    <code class="nx">validate</code><code class="p">()</code><code class="o">:</code> <code class="nx">IValidationResult</code><code class="p">[];</code>
<code class="p">}</code>

<code class="kr">export</code> <code class="kr">interface</code> <code class="nx">IValidationResult</code> <code class="p">{</code> 
    <code class="nx">isValid</code><code class="o">:</code> <code class="kr">boolean</code><code class="p">;</code> 
    <code class="nx">message</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code> 
    <code class="nx">property</code><code class="o">?:</code> <code class="nx">string</code><code class="p">;</code>
<code class="p">}</code>

<code class="kr">export</code> <code class="kr">interface</code> <code class="nx">IValidator</code> <code class="p">{</code>
    <code class="p">(</code><code class="nx">instance</code><code class="o">:</code> <code class="nb">Object</code><code class="p">)</code><code class="o">:</code> <code class="nx">IValidationResult</code><code class="p">;</code>
<code class="p">}</code>

<code class="kr">export</code> <code class="kd">function</code> <code class="nx">validate</code><code class="p">()</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">validators</code><code class="o">:</code> <code class="nx">IValidator</code><code class="p">[]</code> <code class="o">=</code> <code class="p">[].</code><code class="nx">concat</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">_validators</code><code class="p">),</code>
        <code class="nx">errors</code><code class="o">:</code> <code class="nx">IValidationResult</code><code class="p">[]</code> <code class="o">=</code> <code class="p">[];</code>
    
    <code class="k">for</code><code class="p">(</code><code class="kd">let</code> <code class="nx">validator</code> <code class="k">of</code> <code class="nx">validators</code><code class="p">)</code> <code class="p">{</code>
        <code class="kd">let</code> <code class="nx">result</code> <code class="o">=</code> <code class="nx">validator</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>
        
        <code class="k">if</code><code class="p">(</code><code class="o">!</code><code class="nx">result</code><code class="p">.</code><code class="nx">isValid</code><code class="p">)</code> <code class="p">{</code>
            <code class="nx">errors</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="nx">result</code><code class="p">);</code>
        <code class="p">}</code>
    <code class="p">}</code>
    
    <code class="k">return</code> <code class="nx">errors</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Now that I have my <code>validate</code> function, let’s go ahead and add it to a class by assigning it to the class’s prototype.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">ValidatableTodo</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">_validators</code> <code class="o">=</code> <code class="p">[];</code>
<code class="nx">ValidatableTodo</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">validate</code> <code class="o">=</code> <code class="nx">validate</code><code class="p">;</code>
</pre></div>

</figure>

<p>Ok, if that’s how you’d attach behavior using the Decorator pattern <em>without</em> the decorator syntax, let’s see how I can use a decorator `to accomplish this same thing in a little bit cleaner way…</p>

<p>Just like the method decorator function, I’ll start with a function that just has one parameter:  the class’s constructor function.</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="kd">function</code> <code class="nx">validatable</code><code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Function</code><code class="p">)</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>And inside this function I can apply the same exact logic I just applied to the <code>ValidatableTodo</code> class, but in a more generic way:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="kd">function</code> <code class="nx">validatable</code><code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Function</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">target</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">validate</code> <code class="o">=</code> <code class="nx">validate</code><code class="p">;</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>Now, I can apply this decorator to any class using the same exact syntax used to decorate a method:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="err">@</code><code class="nx">validatable</code>
<code class="kr">export</code> <code class="kr">class</code> <code class="nx">ValidatableTodo</code> <code class="kr">implements</code> <code class="nx">Todo</code> <code class="p">{</code>
    
    <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>And, since the <code>validatable</code> decorator adds the <code>validate</code> method dynamically, I can let TypeScript know that this class now implements the <code>IValidatable</code> interface by adding a merged declaration that says exactly that:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">export</code> <code class="kr">interface</code> <code class="nx">ValidatableTodo</code> <code class="kr">extends</code> <code class="nx">IValidatable</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>Then, to try it out, I can refactor the <code>add</code> method on the <code>TodoService</code> to use this new class to validate new <code>Todo</code>s as they are created:</p>

<figure class="code">
  <figcaption>TodoService.ts</figcaption>

<div class="highlight"><pre>    import { ValidatableTodo } from './Validators';

<code class="uil">    let todo = new ValidatableTodo();
</code><code class="uil">    todo.id = generateTodoId();
</code><code class="uil">    todo.state = TodoState.Active;
</code>
    if (typeof input === 'string') {
        todo.name = input;
    }
    else if (typeof input.name === 'string') {
        todo.name = input.name;
    } else {
        throw 'Invalid Todo name!';
    }

<code class="uil">    let errors = todo.validate();
</code><code class="uil">
</code><code class="uil">    if(errors.length) {
</code><code class="uil">        let combinedErrors = errors.map(x =&gt; `${x.property}: ${x.message}`) 
</code><code class="uil">        throw `Invalid Todo! ${errors.join('; ')}`;
</code><code class="uil">    }
</code></pre></div>

</figure>

<p>With this new logic in place, all of the <code>Todo</code> objects will be validated with the various rules that I’ll apply to the <code>ValidatableTodo</code> class in the rest of this chapter.</p>

<p>Speaking of which, let’s move on to the next section where I’ll show you how to use property decorators to add this validation logic!</p>

<h3 id="property-decorators">Implementing Property Decorators</h3>

<p>In the previous few sections, I showed you how to create decorator functions that you could use to decorate methods and classes.  In this section, I’m going to show you how to implement property decorators that will allow you to dynamically add behavior to your properties.</p>

<p>The signature of a property decorator is right in between a class decorator and a method decorator:  </p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">required</code><code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyName</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
</pre></div>

</figure>

<p>It takes two parameters: the target object and the name of the property on that object.</p>

<p>Then, within this function I can define the logic that I want to execute any time the property decorator is applied to a property.</p>

<p>In this instance, what I want to do is add a validation function to the list of validators on the target object.  So, first, I’ll need to get a reference to that list of validators like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="lineno">1 </code><code class="kd">function</code> <code class="nx">required</code><code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyName</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
<code class="lineno">2 </code>    
<code class="lineno">3 </code>    <code class="kd">let</code> <code class="nx">validatable</code> <code class="o">=</code> <code class="o">&lt;</code><code class="p">{</code> <code class="nx">_validators</code><code class="o">:</code> <code class="nx">IValidator</code><code class="p">[]</code> <code class="p">}</code><code class="o">&gt;</code><code class="nx">target</code><code class="p">,</code> 
<code class="lineno">4 </code>        <code class="nx">validators</code> <code class="o">=</code> <code class="p">(</code><code class="nx">validatable</code><code class="p">.</code><code class="nx">_validators</code> <code class="o">||</code> <code class="p">(</code><code class="nx">validatable</code><code class="p">.</code><code class="nx">_validators</code> <code class="o">=</code> <code class="p">[]));</code>
<code class="lineno">5 </code>
<code class="lineno">6 </code><code class="p">}</code>
</pre></div>

</figure>

<p>Notice how I’m using an anonymous type on line 3 so that I can still get the benefits of typing just in this method even though this isn’t an formally-defined type.</p>

<p>Then, I can define and add a validation function to this list.  </p>

<figure class="code">
<div class="highlight"><pre>	function required(target: Object, propertyName: string) {
	
	    let validatable = &lt;{ _validators: IValidator[] }&gt;target, 
	        validators = (validatable._validators || (validatable._validators = [])\
);

<code class="uil">	    validators.push(function (instance) {
</code><code class="uil">	    });
</code>	}
</pre></div>

</figure>

<p>I’ll start by getting the value of the property for this particular instance:</p>

<figure class="code">
<div class="highlight"><pre>	function required(target: Object, propertyName: string) {
	
	    let validatable = &lt;{ _validators: IValidator[] }&gt;target, 
	        validators = (validatable._validators || (validatable._validators = [])\
);
	    
	    validators.push(function (instance) {
<code class="uil">	        let propertyValue = instance[propertyName];
</code>	    });
	}
</pre></div>

</figure>

<p>Then, since this decorator is enforcing the fact that the property must have a value, I’ll check that property value to make sure it’s assigned to something, and - if it’s a string - that it contains at least one character.</p>

<figure class="code">
<div class="highlight"><pre>    validators.push(function (instance) {
        let propertyValue = instance[propertyName],
<code class="uil">            isValid = propertyValue != undefined;
</code><code class="uil">
</code><code class="uil">        if (typeof propertyValue === 'string') {
</code><code class="uil">            isValid = propertyValue &amp;&amp; propertyValue.length &gt; 0;
</code><code class="uil">        }
</code>    });
</pre></div>

</figure>

<p>And, finally, I’ll return an object literal that meets the contract defined by the <code>IValidationResult</code> interface:</p>

<figure class="code">
<div class="highlight"><pre>function required(target: Object, propertyName: string) {

	let validatable = &lt;{ _validators: IValidator[] }&gt;target, 
		validators = (validatable._validators || (validatable._validators = []));
	
	validators.push(function (instance) {
		let propertyValue = instance[propertyName],
			isValid = propertyValue != undefined;

		if (typeof propertyValue === 'string') {
			isValid = propertyValue &amp;&amp; propertyValue.length &gt; 0;
		}
		
<code class="uil">		return { 
</code><code class="uil">			isValid, 
</code><code class="uil">			message: `${propertyName} is required`,
</code><code class="uil">			property: propertyName 
</code><code class="uil">		};
</code>	});
}
</pre></div>

</figure>

<p>Now that I’ve defined the property decorator, I can go ahead and add it to my property, using the same syntax that I used for the method and class decorators in the previous sections:  the <code>@</code> character, followed by the decorator function name:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="err">@</code><code class="nx">validatable</code>
<code class="kr">export</code> <code class="kr">class</code> <code class="nx">ValidatableTodo</code> <code class="kr">implements</code> <code class="nx">Todo</code> <code class="p">{</code>

    <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
    
    <code class="err">@</code><code class="nx">required</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
    
    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>With all that in place, I can run the site and try to add an empty todo item to see the new validation in action.   </p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Decorators----required-decorator-error.png" alt="Required validation error">
  <figcaption>Required validation error</figcaption>
</figure>


<p>Of course, if I try to add a value that actually has some characters in it, it goes through just fine…</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Decorators----required-decorator-success.png" alt="No more validation errors">
  <figcaption>No more validation errors</figcaption>
</figure>


<p>It’s probably best to point out that if this were a real application I wouldn’t be throwing an error like this – instead, I’d send the error objects up to the view and display them to the user so they have some idea of what properties are invalid and why.  However, all of that is just slightly outside of the scope of this book.</p>

<p>But, you know what’s <em>not</em> outside of the scope of this book? The next section, where I’ll show you how to pass parameters into a decorator using a pattern called a decorator factory.</p>

<h3 id="leanpub-auto-implementing-decorator-factories">Implementing Decorator Factories</h3>

<p>So far in this chapter I have shown you how to create and apply class, method, and property decorators and, until now, all of the decorators I’ve shown you have been functions whose parameters are the things they are decorating - for example, class constructors, methods, or properties, such as this property decorator:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">regex</code><code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyName</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>But, what if you wanted to pass a parameter to one of those decorator functions?  In the case of this decorator, what if I wanted to pass a regex string that I could execute in order to validate the property value?</p>

<p>Well, that wouldn’t work because decorators need to have a specific signature and don’t leave any room for other parameters.  In cases like these you need a <strong>decorator factory</strong>.</p>

<p>The concept of a decorator factory is actually quite simple:  it’s a function that returns a decorator function.  In other words, the factory function itself doesn’t have to match the signature of, say, a property decorator - it just needs to return a function with a signature that matches a property decorator… like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">regex</code><code class="p">(</code><code class="nx">pattern</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">flags</code><code class="o">?:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>

	<code class="k">return</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyName</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
	<code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>And, as with any other inner JavaScript function, the decorator function created inside of the decorator factory has full access to any of the parameters passed into the decorator factory function itself.</p>

<p>In other words, take the <code>pattern</code> parameter that’s passed into the decorator factory – I’ll have access to that inside of the decorator function to validate the value of the property at runtime.  So, if I make a copy of the <code>required</code> validator from before…</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">regex</code><code class="p">(</code><code class="nx">pattern</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">flags</code><code class="o">?:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
    
	<code class="k">return</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyName</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>

        <code class="kd">let</code> <code class="nx">validatable</code> <code class="o">=</code> <code class="o">&lt;</code><code class="p">{</code> <code class="nx">_validators</code><code class="o">:</code> <code class="nx">IValidator</code><code class="p">[]</code> <code class="p">}</code><code class="o">&gt;</code><code class="nx">target</code><code class="p">,</code> 
            <code class="nx">validators</code> <code class="o">=</code> <code class="p">(</code><code class="nx">validatable</code><code class="p">.</code><code class="nx">_validators</code> <code class="o">||</code> <code class="p">(</code><code class="nx">validatable</code><code class="p">.</code><code class="nx">_validators</code> <code class="o">=</code> <code class="o">\</code>
<code class="p">[]));</code>
	
	    <code class="nx">validators</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">instance</code><code class="p">)</code> <code class="p">{</code>
	        <code class="kd">let</code> <code class="nx">propertyValue</code> <code class="o">=</code> <code class="nx">instance</code><code class="p">[</code><code class="nx">propertyName</code><code class="p">],</code>
	            <code class="nx">isValid</code> <code class="o">=</code> <code class="nx">propertyValue</code> <code class="o">!=</code> <code class="kc">undefined</code><code class="p">;</code>
	
	        <code class="k">return</code> <code class="p">{</code>
	            <code class="nx">isValid</code><code class="p">,</code>
	            <code class="nx">message</code><code class="o">:</code> <code class="sb">`</code><code class="si">${</code><code class="nx">propertyName</code><code class="si">}</code><code class="sb"> is required`</code><code class="p">,</code>
	            <code class="nx">property</code><code class="o">:</code> <code class="nx">propertyName</code>
	        <code class="p">};</code>
	    <code class="p">});</code>
	
	<code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>I can modify the validation logic from checking for an undefined property value to checking to see if the property value is a string that matches the regular expression:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">regex</code><code class="p">(</code><code class="nx">pattern</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">flags</code><code class="o">?:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
    
    <code class="kd">let</code> <code class="nx">expression</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">RegExp</code><code class="p">(</code><code class="nx">pattern</code><code class="p">,</code> <code class="nx">flags</code><code class="p">);</code>

    <code class="k">return</code> <code class="kd">function</code><code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyName</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>

        <code class="kd">let</code> <code class="nx">validatable</code> <code class="o">=</code> <code class="o">&lt;</code><code class="p">{</code> <code class="nx">_validators</code><code class="o">:</code> <code class="nx">IValidator</code><code class="p">[]</code> <code class="p">}</code><code class="o">&gt;</code><code class="nx">target</code><code class="p">,</code> 
            <code class="nx">validators</code> <code class="o">=</code> <code class="p">(</code><code class="nx">validatable</code><code class="p">.</code><code class="nx">_validators</code> <code class="o">||</code> <code class="p">(</code><code class="nx">validatable</code><code class="p">.</code><code class="nx">_validators</code> <code class="o">=</code> <code class="o">\</code>
<code class="p">[]));</code>
    
        <code class="nx">validators</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">instance</code><code class="p">)</code> <code class="p">{</code>
            <code class="kd">let</code> <code class="nx">propertyValue</code> <code class="o">=</code> <code class="nx">instance</code><code class="p">[</code><code class="nx">propertyName</code><code class="p">],</code>
                <code class="nx">isValid</code> <code class="o">=</code> <code class="nx">expression</code><code class="p">.</code><code class="nx">match</code><code class="p">(</code><code class="nx">propertyValue</code><code class="p">);</code>

            <code class="k">return</code> <code class="p">{</code>
                <code class="nx">isValid</code><code class="p">,</code>
                <code class="nx">message</code><code class="o">:</code> <code class="sb">`</code><code class="si">${</code><code class="nx">propertyName</code><code class="si">}</code><code class="sb"> does not match </code><code class="si">${</code><code class="nx">expression</code><code class="si">}</code><code class="sb">`</code><code class="p">,</code>
                <code class="nx">property</code><code class="o">:</code> <code class="nx">propertyName</code>
            <code class="p">};</code>
        <code class="p">});</code>

    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>Then I use this new decorator factory almost exactly as I use a normal decorator function, except that I call it as a function with parentheses and pass in parameters.</p>

<p>For instance, if I wanted to make sure that the <code>name</code> property only included alpha-numeric characters or spaces, I could apply the new decorator factory with this regular expression:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="err">@</code><code class="nx">validatable</code>
<code class="kr">export</code> <code class="kr">class</code> <code class="nx">ValidatableTodo</code> <code class="kr">implements</code> <code class="nx">Todo</code> <code class="p">{</code>

    <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>

    <code class="err">@</code><code class="nx">required</code>
    <code class="err">@</code><code class="nx">regex</code><code class="p">(</code><code class="sb">`^[a-zA-Z ]*$`</code><code class="p">)</code>
    <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>

    <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>And, yes - it’s totally valid to apply multiple decorators to a single property, class, or method!</p>

<p>With this in place, I can run the site and if I give the name property a value - but that value has non-alphanumeric characters -  I can see my new regex validator kicking in!</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Decorators----regex-decorator-error.png" alt="Regex validation error">
  <figcaption>Regex validation error</figcaption>
</figure>


<p>And, of course, if I update the name property to include only alphanumeric characters, I no longer get any validation errors.</p>


<figure class="image center">
  <img src="./Read Essential TypeScript _ Leanpub_files/Decorators----regex-decorator-success.png" alt="No more validation errors!">
  <figcaption>No more validation errors!</figcaption>
</figure>


<p>Frankly, I found decorator factories a bit awkward at first – a function that returns a decorator function can seem pretty weird.  But, the approach grew on me and now I use both decorators and decorator factories on a regular basis to centralize all of the cross-cutting concerns in my application such as logging and validation.  I have even used decorators to implement far more complex concepts such as dependency injection!  I consider decorators to be a great help and I’m willing to bet that once you start using them, it’s going to be hard for you to stop!</p>

<h2 id="leanpub-auto-appendix-syntax-examples">
<span class="section-number">12. </span>Appendix: Syntax Examples</h2>

<h3 id="leanpub-auto-ecmascript-6-features">ECMAScript 6 Features</h3>

<h4 id="leanpub-auto-optionaldefault-parameters">Optional/Default parameters</h4>

<figure class="code">
<div class="highlight"><pre><code></code><code class="c1">// "final" and "interval" parameters are optional.</code>
<code class="c1">// If omitted, they will be defaulted to 0 and 1 (respectively)</code>
<code class="kd">function</code> <code class="nx">countdown</code><code class="p">(</code><code class="nx">initial</code><code class="p">,</code> <code class="kr">final</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">interval</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code> <code class="p">{</code>
  <code class="c1">// Countdown logic</code>
<code class="p">}</code>

<code class="c1">// You can then call the method with one, two, or three parameters:</code>
<code class="nx">countdown</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code>       <code class="c1">// -&gt; countdown(10, 0, 1)</code>
<code class="nx">countdown</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="o">-</code><code class="mi">10</code><code class="p">)</code>  <code class="c1">// -&gt; countdown(10, -10, 1)</code>
<code class="nx">countdown</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="o">-</code><code class="mi">10</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code> 
</pre></div>

</figure>

<h4 id="leanpub-auto-template-strings">Template strings</h4>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">var</code> <code class="nx">name</code> <code class="o">=</code> <code class="s1">'Ada Lovelace'</code><code class="p">;</code>
<code class="kd">var</code> <code class="nx">birthDate</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">(</code><code class="mi">1815</code><code class="p">,</code> <code class="mi">12</code><code class="p">,</code> <code class="mi">10</code><code class="p">);</code>

<code class="kd">var</code> <code class="nx">template</code> <code class="o">=</code> <code class="sb">`</code>
<code class="sb">    &lt;div class="user"&gt;</code>
<code class="sb">      &lt;p class='name'&gt;</code><code class="si">${</code><code class="nx">name</code><code class="si">}</code><code class="sb">&lt;/p&gt;</code>
<code class="sb">      &lt;p&gt;</code>
<code class="sb">        &lt;span class='birthDate'&gt;</code><code class="si">${</code><code class="nx">birthDate</code><code class="p">.</code><code class="nx">toDateString</code><code class="p">()</code><code class="si">}</code><code class="sb">&lt;/span&gt;</code>
<code class="sb">        &lt;span class='age'&gt;</code>
<code class="sb">          </code><code class="si">${</code> <code class="nb">Math</code><code class="p">.</code><code class="nx">floor</code><code class="p">(</code> <code class="p">(</code><code class="k">new</code> <code class="nb">Date</code><code class="p">()</code> <code class="o">-</code> <code class="nx">birthDate</code><code class="p">)</code> <code class="o">/</code> <code class="mi">31536000000</code><code class="p">)</code> <code class="si">}</code><code class="sb"> </code>
<code class="sb">          years old</code>
<code class="sb">        &lt;/span&gt;</code>
<code class="sb">      &lt;/p&gt;</code>
<code class="sb">    &lt;/div&gt;</code>
<code class="sb">`</code><code class="p">;</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-let-and-const">
<code>let</code> and <code>const</code>
</h4>

<h5 id="leanpub-auto-let"><code>let</code></h5>
<p>Use <code>let</code> anywhere that you previously used <code>var</code>, especially in places where you wouldn’t expect variables to creep out of their scope, such as:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">x</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">x</code> <code class="o">&lt;=</code> <code class="mi">5</code><code class="p">;</code> <code class="nx">x</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">var</code> <code class="nx">counter</code> <code class="o">=</code> <code class="nx">x</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">counter</code><code class="p">);</code> <code class="c1">// Prints 5... how odd!</code>
</pre></div>

</figure>

<p>Instead, with <code>let</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">for</code><code class="p">(</code><code class="kd">let</code> <code class="nx">x</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">x</code> <code class="o">&lt;=</code> <code class="mi">5</code><code class="p">;</code> <code class="nx">x</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="kd">let</code> <code class="nx">counter</code> <code class="o">=</code> <code class="nx">x</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">counter</code><code class="p">);</code> <code class="c1">// Browser says "I don't know about 'counter'" (like you'd\</code>
 <code class="nx">expect</code><code class="o">!</code><code class="p">)</code>
</pre></div>

</figure>

<h5 id="leanpub-auto-const"><code>const</code></h5>

<figure class="code">
<div class="highlight"><pre><code></code><code class="k">for</code><code class="p">(</code><code class="kd">let</code> <code class="nx">x</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">x</code> <code class="o">&lt;</code> <code class="mi">5</code><code class="p">;</code> <code class="nx">x</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>
    <code class="kr">const</code> <code class="nx">counter</code> <code class="o">=</code> <code class="nx">x</code><code class="p">;</code>  <code class="c1">// Assign a constant to an initial value...</code>
    <code class="nx">counter</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>        <code class="c1">// Try to reassign and get a runtime error, "can't reass\</code>
<code class="nx">ign</code> <code class="nx">constant</code> <code class="nx">variable</code><code class="err">"</code>
<code class="p">}</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-forof-loops-1">For..of loops</h4>

<p>Use <code>for</code>/<code>of</code> anywhere that you previously would have used <code>for</code>/<code>in</code>:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code>  <code class="s2">"Clean Batcave"</code><code class="p">,</code> <code class="s2">"Save Gotham"</code> <code class="p">];</code>

  <code class="c1">// Old way:</code>
  <code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">index</code> <code class="k">in</code> <code class="nx">array</code><code class="p">)</code> <code class="p">{</code>
      <code class="kd">var</code> <code class="nx">value</code> <code class="o">=</code> <code class="nx">array</code><code class="p">[</code><code class="nx">index</code><code class="p">];</code>
      <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
  <code class="p">}</code>

  <code class="c1">// New way:</code>
  <code class="k">for</code><code class="p">(</code><code class="kd">var</code> <code class="nx">value</code> <code class="k">of</code> <code class="nx">array</code><code class="p">)</code> <code class="p">{</code>
      <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>
  <code class="p">}</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-arrow-functions">Arrow Functions</h4>

<p>Use arrow functions <em>almost</em> anywhere that you would have used an anonymous function:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">var</code> <code class="nx">todos</code> <code class="o">=</code> <code class="p">[</code> 
    <code class="p">{</code> <code class="nx">name</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code> <code class="nx">completed</code><code class="o">:</code> <code class="kc">false</code> <code class="p">},</code>
    <code class="p">{</code> <code class="nx">name</code><code class="o">:</code> <code class="s2">"Clean Batcave"</code><code class="p">,</code> <code class="nx">completed</code><code class="o">:</code> <code class="kc">true</code> <code class="p">},</code>
    <code class="p">{</code> <code class="nx">name</code><code class="o">:</code> <code class="s2">"Save Gotham"</code><code class="p">,</code> <code class="nx">completed</code><code class="o">:</code> <code class="kc">false</code> <code class="p">}</code>
  <code class="p">];</code>
  
  <code class="c1">// Old way:</code>
  <code class="kd">var</code> <code class="nx">completed</code> <code class="o">=</code> <code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">todo</code><code class="p">)</code> <code class="p">{</code> 
    <code class="k">return</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">completed</code><code class="p">;</code>
  <code class="p">});</code>
  
  <code class="c1">// New way:</code>
  <code class="kd">var</code> <code class="nx">completed</code> <code class="o">=</code> <code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">((</code><code class="nx">todo</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code> <code class="k">return</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">completed</code><code class="p">;</code> <code class="p">});</code>

  <code class="c1">// Of course, the parentheses around the parameter list are optional if there \</code>
<code class="nx">is</code> <code class="nx">only</code> <code class="nx">one</code> <code class="nx">parameter</code><code class="o">:</code>
  <code class="kd">var</code> <code class="nx">completed</code> <code class="o">=</code> <code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="nx">todo</code> <code class="o">=&gt;</code> <code class="p">{</code> <code class="k">return</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">completed</code><code class="p">;</code> <code class="p">});</code>

  <code class="c1">// And if you've only got one line/expression, you don't even need the bracket\</code>
<code class="nx">s</code><code class="p">.</code>
  <code class="c1">// (Bonus: the return value is the result of the expression!)</code>
  <code class="kd">var</code> <code class="nx">completed</code> <code class="o">=</code> <code class="nx">todos</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="nx">todo</code> <code class="o">=&gt;</code> <code class="nx">todo</code><code class="p">.</code><code class="nx">completed</code><code class="p">);</code>
</pre></div>

</figure>

<p><strong>Caveat: the <code>this</code> keyword</strong></p>

<p>The only time arrow functions actually change the functionality of a function is by saving a reference to the <code>this</code> keyword.  Often, this is exactly what you want to happen!</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">function</code> <code class="nx">CounterButton</code><code class="p">(</code><code class="nx">element</code><code class="p">)</code> <code class="p">{</code>
  
    <code class="k">this</code><code class="p">.</code><code class="nx">counter</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
  
    <code class="nx">element</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
      <code class="k">this</code><code class="p">.</code><code class="nx">counter</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>  <code class="c1">// Doesn't work  :(</code>
    <code class="p">})</code>
  
    <code class="c1">// Works great!</code>
    <code class="nx">element</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="k">this</code><code class="p">.</code><code class="nx">counter</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">);</code>
    
  <code class="p">}</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-destructuring">Destructuring</h4>

<p>Assigning a set of variables from a simple array:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">var</code> <code class="nx">array</code> <code class="o">=</code> <code class="p">[</code><code class="mi">123</code><code class="p">,</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code> <code class="kc">false</code><code class="p">];</code>
  <code class="kd">var</code> <code class="p">[</code><code class="nx">id</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">completed</code><code class="p">]</code> <code class="o">=</code> <code class="nx">array</code><code class="p">;</code>   <code class="c1">// -&gt;  id = 123, title = "Pick up drycle\</code>
<code class="nx">aning</code><code class="err">"</code><code class="p">,</code> <code class="nx">completed</code> <code class="o">=</code> <code class="kc">false</code>
</pre></div>

</figure>

<p>Swapping the values of variables:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">var</code> <code class="nx">a</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code>
  <code class="kd">var</code> <code class="nx">b</code> <code class="o">=</code> <code class="mi">5</code><code class="p">;</code>
  
  <code class="p">[</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="nx">b</code><code class="p">,</code> <code class="nx">a</code><code class="p">];</code>  <code class="c1">// -&gt; a = 5, b = 1</code>
</pre></div>

</figure>

<p>Assigning a set of variables from an object:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">var</code> <code class="nx">todo</code> <code class="o">=</code> <code class="p">{</code> 
      <code class="nx">id</code><code class="o">:</code> <code class="mi">123</code><code class="p">,</code> 
      <code class="nx">title</code><code class="o">:</code> <code class="s2">"Pick up drycleaning"</code><code class="p">,</code> 
      <code class="nx">completed</code><code class="o">:</code> <code class="kc">false</code>
  <code class="p">};</code>
  
  <code class="kd">var</code> <code class="p">{</code> <code class="nx">id</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">completed</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">;</code>   <code class="c1">// -&gt;  id = 123, title = "Pick up drycl\</code>
<code class="nx">eaning</code><code class="err">"</code><code class="p">,</code> <code class="nx">completed</code> <code class="o">=</code> <code class="kc">false</code>
</pre></div>

</figure>

<p>Assigning a set of variables from an object where the target variable name is different from the object property name:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">var</code> <code class="p">{</code> <code class="nx">completed</code><code class="o">:</code> <code class="nx">isCompleted</code><code class="p">,</code> <code class="nx">title</code><code class="p">,</code> <code class="nx">id</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">;</code>   <code class="c1">// -&gt;  id = 123, title = "\</code>
<code class="nx">Pick</code> <code class="nx">up</code> <code class="nx">drycleaning</code><code class="err">"</code><code class="p">,</code> <code class="nx">isCompleted</code> <code class="o">=</code> <code class="kc">false</code>
</pre></div>

</figure>

<p>You can even set default values:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">var</code> <code class="nx">todo</code> <code class="p">{</code> <code class="nx">name</code><code class="o">:</code> <code class="s1">'Pick up drycleaning'</code> <code class="p">};</code>
  <code class="kd">var</code> <code class="p">{</code> <code class="nx">name</code><code class="p">,</code> <code class="nx">isCompleted</code> <code class="o">=</code> <code class="kc">false</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">todo</code><code class="p">;</code>   <code class="c1">// -&gt; name = 'Pick up drycleaning'\</code>
<code class="p">,</code> <code class="nx">isCompleted</code> <code class="o">=</code> <code class="kc">false</code>
</pre></div>

</figure>

<p>And, perhaps the coolest usage: destructing a function parameter object to a set of variables in the function (with default values!):</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">function</code> <code class="nx">countdown</code><code class="p">({</code> <code class="nx">initial</code><code class="p">,</code> <code class="kr">final</code><code class="o">:</code> <code class="kr">final</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">interval</code><code class="o">:</code> <code class="nx">interval</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code> <code class="nx">initia</code><code class="o">\</code>
<code class="nx">l</code><code class="o">:</code> <code class="nx">current</code> <code class="p">})</code> <code class="p">{</code>
    <code class="c1">// Countdown logic...</code>
  <code class="p">}</code>
  
  <code class="nx">countdown</code><code class="p">({</code> <code class="nx">initial</code><code class="o">:</code> <code class="mi">20</code> <code class="p">})</code>                            <code class="c1">// -&gt; initial = 20, fina\</code>
<code class="nx">l</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="nx">interval</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code> <code class="nx">current</code> <code class="o">=</code> <code class="mi">20</code>
  <code class="nx">countdown</code><code class="p">({</code> <code class="nx">initial</code><code class="o">:</code> <code class="mi">20</code><code class="p">,</code> <code class="kr">final</code><code class="o">:</code> <code class="o">-</code><code class="mi">10</code> <code class="p">})</code>                <code class="c1">// -&gt; initial = 20, fina\</code>
<code class="nx">l</code> <code class="o">=</code> <code class="o">-</code><code class="mi">10</code><code class="p">,</code> <code class="nx">interval</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code> <code class="nx">current</code> <code class="o">=</code> <code class="mi">20</code>
  <code class="nx">countdown</code><code class="p">({</code> <code class="nx">initial</code><code class="o">:</code> <code class="mi">20</code><code class="p">,</code> <code class="kr">final</code><code class="o">:</code> <code class="o">-</code><code class="mi">10</code><code class="p">,</code> <code class="nx">interval</code><code class="o">:</code> <code class="mi">5</code> <code class="p">})</code>   <code class="c1">// -&gt; initial = 20, fina\</code>
<code class="nx">l</code> <code class="o">=</code> <code class="o">-</code><code class="mi">10</code><code class="p">,</code> <code class="nx">interval</code> <code class="o">=</code> <code class="mi">5</code><code class="p">,</code> <code class="nx">current</code> <code class="o">=</code> <code class="mi">20</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-the-spread-operator">The spread operator</h4>

<p>Use the spread operator (<code>...</code>) to accept any number of function parameters into a single array variable:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">function</code> <code class="nx">add</code><code class="p">(...</code><code class="nx">values</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">values</code><code class="p">.</code><code class="nx">reduce</code><code class="p">(</code> <code class="p">(</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">a</code> <code class="o">+</code> <code class="nx">b</code> <code class="p">);</code>
  <code class="p">}</code>
</pre></div>

</figure>

<p>The function can still have other parameters, as long as the spread parameter comes last:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">function</code> <code class="nx">calculate</code><code class="p">(</code><code class="nx">action</code><code class="p">,</code> <code class="p">...</code><code class="nx">values</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">switch</code> <code class="p">(</code><code class="nx">action</code><code class="p">)</code> <code class="p">{</code>
      
      <code class="k">case</code> <code class="s1">'add'</code><code class="o">:</code>
        <code class="k">return</code> <code class="nx">values</code><code class="p">.</code><code class="nx">reduce</code><code class="p">(</code> <code class="p">(</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">a</code> <code class="o">+</code> <code class="nx">b</code> <code class="p">);</code>
        
      <code class="k">case</code> <code class="s1">'subtract'</code><code class="o">:</code>
        <code class="k">return</code> <code class="nx">values</code><code class="p">.</code><code class="nx">reduce</code><code class="p">(</code> <code class="p">(</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">a</code> <code class="o">-</code> <code class="nx">b</code> <code class="p">);</code>
        
      <code class="k">default</code><code class="o">:</code>
        <code class="k">throw</code> <code class="sb">`Unknown action </code><code class="si">${</code><code class="nx">action</code><code class="si">}</code><code class="sb">!`</code><code class="p">;</code>
    <code class="p">}</code>
  <code class="p">}</code>
</pre></div>

</figure>

<p>Or, use it to concatenate arrays together:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kd">var</code> <code class="nx">source</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code> <code class="p">];</code>
  <code class="kd">var</code> <code class="nx">target</code> <code class="o">=</code> <code class="p">[</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="p">...</code><code class="nx">source</code> <code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">7</code> <code class="p">];</code>  <code class="c1">// -&gt; [ 1, 2, 3, 4, 5, 6, 7 ]</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-computed-properties-1">Computed properties</h4>

<p>Define property names on the fly:</p>

<figure class="code">
<div class="highlight"><pre><code></code>  <code class="kr">const</code> <code class="nx">osPrefix</code> <code class="o">=</code> <code class="s1">'os_'</code><code class="p">;</code> 
  
  <code class="kd">var</code> <code class="nx">support</code> <code class="o">=</code> <code class="p">{</code>
      <code class="p">[</code><code class="nx">osPrefix</code> <code class="o">+</code> <code class="s1">'Windows'</code><code class="p">]</code><code class="o">:</code> <code class="kc">false</code><code class="p">,</code>
      <code class="p">[</code><code class="nx">osPrefix</code> <code class="o">+</code> <code class="s1">'iOS'</code><code class="p">]</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
      <code class="p">[</code><code class="nx">osPrefix</code> <code class="o">+</code> <code class="s1">'Android'</code><code class="p">]</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>
  <code class="p">};</code>
  
  <code class="nx">support</code> <code class="c1">// -&gt; { os_Windows: false, os_iOS: true, os_Android: true }</code>
</pre></div>

</figure>

<div class="page-break"></div>
<p>## Fundamentals</p>

<h4 id="leanpub-auto-specifying-a-type">Specifying a type</h4>

<p>Declaring the type of a variable:</p>

<p>var name: string;</p>

<p>Or, using type inference, just assign it to a string!</p>

<p>var name = ‘Jess’;</p>

<p>Or, if you really want to be explicit, do both:</p>

<p>var name: string = ‘Jess’;</p>

<p>Alternatively, if you want to completely and explictly <strong>opt out</strong> of typing, you can specify the <code>any</code> type:</p>

<p>var name: any; </p>

<p>Of course, function parameters are just variables, so you can use the same syntax there, too:</p>

<p>function sayName(name: string) {
  }</p>

<p>And speaking of functions, use the same syntax to identify the function’s return type:</p>

<p>function add(x: number, y: number): number {
    return x + y;
  }</p>

<h4 id="leanpub-auto-union-types-1">Union Types</h4>

<p>Want to accept multiple different types for the same parameter?<br>
No problem (as long as they share the same base type… like <code>object</code> for instance).
You can even access any properties that they both share!</p>

<p>function getLength(x: (string | any[])): number {
      return x &amp;&amp; x.length;
  }</p>

<h4 id="leanpub-auto-function-overloads-1">Function overloads</h4>

<p>Many people prefer the function overload option to define a function that accepts multiple different parameter types, like this:</p>

<p>function getLength(x: string): number
  function getLength(x: any[]): number
  function getLength(x: any) : number {
      return x &amp;&amp; x.length;
  }</p>

<h3 id="leanpub-auto-custom-types-1">Custom Types</h3>

<p>TypeScript is all about types - heck, it’s even in the name!<br>
In addition to the standard JavaScript types, there are multiple ways to define your own custom types. </p>

<h4 id="leanpub-auto-interface">Interface</h4>

<p>The TypeScript syntax to define an interface should be incredibly familiar to anyone who’s used C, C++, C#, or Java:</p>

<p>interface IAnimal {</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="c1">// Can have properties:</code>
<code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
<code class="nx">birthYear</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>

<code class="c1">// Or methods:</code>
<code class="nx">getAge</code><code class="p">()</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
</pre></div>

</figure>

<p>}</p>

<h4 id="leanpub-auto-enum">Enum</h4>

<p>The TypeScript syntax to define an enum should be incredibly familiar to anyone who’s used C, C++, C#, or Java:</p>

<p>enum Gender {
    Female,
    Male,
    Other
  }</p>

<p>You can even give them custom values:</p>

<p>enum Gender {
    Female = 20,
    Male = 30,
    Other  // Guess what value this is? (Hint: Male + 1)
  }</p>

<p>Once you’ve defined an enum, you can access its numeric value or its textual value:</p>

<p>Colors.Female          // -&gt; 20
  Colors[Colors.Female]  // -&gt; “Female”</p>

<h4 id="leanpub-auto-anonymous-type">Anonymous type</h4>

<p>You don’t have to define a type in order to use it as a constraint - just define an anonymous type (looks a lot like a JSON object) right there inline in place of where you’d use a type name:</p>

<p>// Accepts any object that has a “length” property that’s a number type
  function getLength(x: { length: number }): number {
    return x.length;
  }</p>

<div class="page-break"></div>
<p>## Classes</p>

<h4 id="leanpub-auto-basic-class">Basic Class</h4>

<p>class Animal {</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="c1">// Can have properties:</code>
<code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
<code class="nx">birthYear</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>

<code class="c1">// Even private/protected properties:    </code>
<code class="kr">private</code> <code class="nx">_birthYear</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
<code class="kr">private</code> <code class="nx">_id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>

<code class="c1">// Can have getter/setter properties</code>
<code class="c1">// Note: they look like properties from the outside, </code>
<code class="c1">//       which means that they even satisfy an interface!</code>
<code class="nx">get</code> <code class="nx">birthYear</code><code class="p">()</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
  <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">_birthYear</code><code class="p">;</code>
<code class="p">}</code>
<code class="nx">set</code> <code class="nx">birthYear</code><code class="p">(</code><code class="nx">year</code><code class="o">:</code> <code class="nx">number</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">_birthYear</code> <code class="o">=</code> <code class="nx">year</code><code class="p">;</code>
<code class="p">}</code>

<code class="nx">get</code> <code class="nx">id</code><code class="p">()</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
  <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">_id</code><code class="p">;</code>
<code class="p">}</code>

<code class="c1">// A constructor (aka the constructor function)</code>
<code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code><code class="p">;</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">_id</code> <code class="o">=</code> <code class="nx">Animal</code><code class="p">.</code><code class="nx">generateId</code><code class="p">();</code>
<code class="p">}</code>

<code class="c1">// Or methods:</code>
<code class="nx">getAge</code><code class="p">()</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
  <code class="k">return</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">().</code><code class="nx">getFullYear</code><code class="p">()</code> <code class="o">-</code> <code class="k">this</code><code class="p">.</code><code class="nx">birthYear</code><code class="p">;</code>
<code class="p">}</code>

<code class="c1">// Even static methods and properties...</code>

<code class="kr">static</code> <code class="nx">_lastId</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>

<code class="kr">static</code> <code class="nx">generateId</code><code class="p">()</code><code class="o">:</code> <code class="nx">number</code> <code class="p">{</code>
  <code class="k">return</code> <code class="nx">Animal</code><code class="p">.</code><code class="nx">_lastId</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">;</code>
<code class="p">}</code> 
</pre></div>

</figure>

<p>}</p>

<p>And, by the way, since it is common to accept a constructor parameter and immediately save the value to a property, there’s a shortcut for that:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">class</code> <code class="nx">Animal</code> <code class="p">{</code>
  
  <code class="c1">// Automatically creates a string property called "name"</code>
  <code class="nx">constructor</code><code class="p">(</code><code class="kr">public</code> <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
  <code class="p">}</code>
  
<code class="p">}</code>

<code class="c1">// Example usage:</code>
<code class="kd">let</code> <code class="nx">animal</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Animal</code><code class="p">(</code><code class="s1">'Fido'</code><code class="p">);</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">animal</code><code class="p">.</code><code class="nx">name</code><code class="p">);</code>         <code class="c1">// -&gt; "Fido"</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-inheritance">Inheritance</h4>

<p>In order to inherit from another class, just use the <code>extends</code> keyword:</p>

<p>class Dog extends Animal {</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">speak</code><code class="p">()</code><code class="o">:</code> <code class="nx">string</code> <code class="p">{</code>
  <code class="k">return</code> <code class="s1">'Woof!'</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>}</p>

<p>Extended classes also inherit constructors from their base classes:</p>

<p>let animal = new Dog(‘Fido’);  // Works!</p>

<h4 id="leanpub-auto-abstract-base-class">Abstract base class</h4>

<p>If you want to make sure that a class is only ever used as a base class, you can mark it as <code>abstract</code>:</p>

<p>abstract class Animal {
    // …
  }</p>

<p>You can also make methods abstract as well:</p>

<p>abstract class Animal {
    // …</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">abstract</code> <code class="nx">speak</code><code class="p">()</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
</pre></div>

</figure>
<p>}</p>

<p>Then you <code>extend</code> the base class and implement its abstract members just like you would if it were a regular class:</p>

<p>class Dog extends Animal {</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">speak</code><code class="p">()</code><code class="o">:</code> <code class="nx">string</code> <code class="p">{</code>
  <code class="k">return</code> <code class="s1">'Woof!'</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>}</p>

<div class="page-break"></div>
<p>### Implementing an interface</p>

<p>You can also implement an interface, which looks similar to inheriting from a class, only using the <code>implements</code> keyword instead of <code>extends</code>:</p>

<p>class Dog implements IAnimal {
    // …
  } </p>

<p>And there’s nothing stopping a class from both implementing an interface and extending another class:</p>

<p>class Dog extends Animal implements IAnimal {
    // …
  } </p>

<p>Plus, TypeScript is smart enough to know that if a base class implements an interface, so do all of the classes that inherit/extend from that base class:</p>

<p>abstract class Animal implements IAnimal {
    // …
  }</p>

<p>// Also implements IAnimal!
  class Dog extends Animal {
    // …
  }</p>

<p>let animal: IAnimal = new Dog(‘Fido’);  // Works!</p>

<div class="page-break"></div>
<p>## Generics</p>

<h4 id="leanpub-auto-generic-function">Generic function</h4>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">clone</code><code class="o">&lt;</code><code class="nx">T</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">value</code><code class="o">:</code> <code class="nx">T</code><code class="p">)</code><code class="o">:</code> <code class="nx">T</code> <code class="p">{</code>
	<code class="k">return</code> <code class="nx">JSON</code><code class="p">.</code><code class="nx">parse</code><code class="p">(</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">value</code><code class="p">));</code>
<code class="p">}</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-generic-class">Generic class</h4>

<p>class KeyValuePair&lt;T, U&gt; {
    key: T;
    value: U;
  }</p>

<h4 id="leanpub-auto-generic-constraints">Generic constraints</h4>

<p>You can constrain the types you can use as generic parameters by saying that it “extends” a type:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="o">&lt;</code><code class="nx">T</code> <code class="kr">extends</code> <code class="p">{</code> <code class="nx">length</code><code class="o">:</code> <code class="nx">number</code> <code class="p">}</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">T</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">T</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>That’s an example with an anonymous type, but of course you can use an interface or class as well:</p>

<p>interface IHaveALength {
    length: number;
  }</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">totalLength</code><code class="o">&lt;</code><code class="nx">T</code> <code class="kr">extends</code> <code class="nx">IHaveALength</code><code class="o">&gt;</code><code class="p">(</code><code class="nx">x</code><code class="o">:</code> <code class="nx">T</code><code class="p">,</code> <code class="nx">y</code><code class="o">:</code> <code class="nx">T</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">return</code> <code class="nx">x</code><code class="p">.</code><code class="nx">length</code> <code class="o">+</code> <code class="nx">y</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code>
<code class="p">}</code>
</pre></div>

</figure>

<div class="page-break"></div>
<p>## Modules</p>

<h4 id="leanpub-auto-internal-modules-namespaces">Internal Modules (Namespaces)</h4>

<p>Use the <code>namespace</code> keyword, which acts kind of like an IIFE:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="nx">namespace</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code> <code class="p">{</code>

    <code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
        <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
        <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
        <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
        <code class="nx">New</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
        <code class="nx">Active</code><code class="p">,</code>
        <code class="nx">Complete</code><code class="p">,</code>
        <code class="nx">Deleted</code>
    <code class="p">}</code>

  <code class="kd">var</code> <code class="nx">someVariable</code><code class="p">;</code> <code class="c1">// only accessible within this block of code	   </code>
<code class="p">}</code>
</pre></div>

</figure>

<p>var todo: TodoApp.Model.Todo; // ERROR!  Don’t know about that type!(?)</p>

<p>If you want to access members of a namespace (even in the same file), you need to <code>export</code> them:</p>

 	namespace TodoApp.Model {

<figure class="code">
<div class="highlight"><pre><code></code>    <code class="kr">export</code> <code class="kr">interface</code> <code class="nx">Todo</code> <code class="p">{</code>
        <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code>
        <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code><code class="p">;</code>
        <code class="nx">state</code><code class="o">:</code> <code class="nx">TodoState</code><code class="p">;</code>
    <code class="p">}</code>

    <code class="kr">export</code> <code class="kr">enum</code> <code class="nx">TodoState</code> <code class="p">{</code>
        <code class="nx">New</code> <code class="o">=</code> <code class="mi">1</code><code class="p">,</code>
        <code class="nx">Active</code><code class="p">,</code>
        <code class="nx">Complete</code><code class="p">,</code>
        <code class="nx">Deleted</code>
    <code class="p">}</code>

<code class="p">}</code>
</pre></div>

</figure>

<p>var todo: TodoApp.Model.Todo; // Ah, now it works!</p>

<p>You can define an alias so that you don’t need to keep referring to a namespace with its full-fledged name:</p>

<p>namespace TodoApp.App {</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">TodoApp</code><code class="p">.</code><code class="nx">Model</code><code class="p">;</code>

<code class="kd">var</code> <code class="nx">todo</code><code class="o">:</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
</pre></div>

</figure>

<p>}</p>

<h4 id="leanpub-auto-external-modules-exports">External Modules (exports)</h4>

<p>They work the same as <code>namespace</code>s, except the <em>file</em> is the “namespace”.</p>

<p>Just be sure to set the <code>compileSettings.module</code> setting:</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
        <code class="s2">"target"</code><code class="o">:</code> <code class="s2">"es5"</code><code class="p">,</code>
        <code class="s2">"module"</code><code class="o">:</code> <code class="s2">"system"</code><code class="p">,</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-import-with-require">Import with require</h4>

<p>Say I’m in other file in the same folder as the <code>Model.ts</code> file I’ve been showing.
I can refer to items in that <code>Model.ts</code> file with this syntax:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'./Model'</code><code class="p">);</code>
</pre></div>

</figure>

<p>I can even establish an alias for items in that file like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="nx">Model</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'./Model'</code><code class="p">);</code>
<code class="kr">import</code> <code class="nx">Todo</code> <code class="o">=</code> <code class="nx">Model</code><code class="p">.</code><code class="nx">Todo</code><code class="p">;</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-import-with-ecmascript-import-keyword">Import with ECMAScript <code>import</code> keyword</h4>

<p>Say I’m in other file in the same folder as the <code>Model.ts</code> file I’ve been showing.
I can refer to items in that <code>Model.ts</code> file with this syntax:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="o">*</code> <code class="nx">as</code> <code class="nx">Model</code> <code class="nx">from</code> <code class="s1">'./Model'</code><code class="p">;</code>
</pre></div>

</figure>

<p>I can even establish an alias for items in that file by importing them explictly like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kr">import</code> <code class="p">{</code> <code class="nx">Todo</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./model'</code><code class="p">;</code>
</pre></div>

</figure>

<div class="page-break"></div>
<p>## Decorators</p>

<p>Since decorators are an experimental feature, you first have to enable them in your configuration:</p>

<figure class="code">
  <figcaption>tsconfig.json</figcaption>

<div class="highlight"><pre><code></code><code class="p">{</code>
    <code class="s2">"compilerOptions"</code><code class="o">:</code> <code class="p">{</code>
        <code class="s2">"experimentalDecorators"</code><code class="o">:</code> <code class="kc">true</code>
    <code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<h4 id="leanpub-auto-class-decorator">Class Decorator</h4>

<p>First, create your decorator function, which is just a plain old function that accepts the target parameter:</p>

<p>function validatable(target: Function) {
    target.prototype.validate = function() {
      console.log(‘TODO: implement validation!’);
    };
	}</p>

<p>Then, apply it to your class:</p>

<p>@validatable
  class Request {
  }</p>

<p>In this example, the <code>validatable</code> decorator dynamically adds a new method called <code>validate</code> to every <code>Request</code> object, which means that I can do this:</p>

<p>let request = new Request();
  request.validate();           // -&gt; “TODO: implement validation!”   </p>

<h4 id="leanpub-auto-method-decorator">Method Decorator</h4>

<p>Method decorators are the same basic principle as Class Decorators, only with a slightly more complex signature that looks like this:</p>

<p>Here’s a working example of a “log” decorator that wraps a method and logs its parameters and return values:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">log</code><code class="p">(</code>
    <code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">methodName</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> 
    <code class="nx">descriptor</code><code class="o">:</code> <code class="nx">TypedPropertyDescriptor</code><code class="o">&lt;</code><code class="nb">Function</code><code class="o">&gt;</code>
<code class="p">)</code> <code class="p">{</code>
    
    <code class="kd">var</code> <code class="nx">originalMethod</code> <code class="o">=</code> <code class="nx">descriptor</code><code class="p">.</code><code class="nx">value</code><code class="p">;</code>
    
    <code class="nx">descriptor</code><code class="p">.</code><code class="nx">value</code> <code class="o">=</code> <code class="kd">function</code> <code class="p">(...</code><code class="nx">args</code><code class="p">)</code> <code class="p">{</code>
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">methodName</code><code class="si">}</code><code class="sb">(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">args</code><code class="p">)</code><code class="si">}</code><code class="sb">)`</code><code class="p">)</code>
        
        <code class="kd">let</code> <code class="nx">returnValue</code> <code class="o">=</code> <code class="nx">originalMethod</code><code class="p">.</code><code class="nx">apply</code><code class="p">(</code><code class="k">this</code><code class="p">,</code> <code class="nx">args</code><code class="p">);</code>
    
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">methodName</code><code class="si">}</code><code class="sb">(</code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="nx">args</code><code class="p">)</code><code class="si">}</code><code class="sb">) =&gt; </code><code class="si">${</code><code class="nx">JSON</code><code class="p">.</code><code class="nx">stringify</code><code class="p">(</code><code class="o">\</code>
<code class="nx">returnValue</code><code class="p">)</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code>
        
        <code class="k">return</code> <code class="nx">returnValue</code><code class="p">;</code>
    <code class="p">}</code>
    
<code class="p">}</code>
</pre></div>

</figure>

<p>Then just apply it like you apply a class decorator:</p>

<p>@log
  function getLength(x: { length: number}) { 
    return x.length; 
  }</p>

<h4 id="leanpub-auto-property-decorator">Property Decorator</h4>

<p>A property decorator is just a function with this signature:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">name</code><code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyKey</code><code class="o">:</code> <code class="nx">string</code> <code class="o">|</code> <code class="nx">symbol</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="k">void</code><code class="p">;</code>
</pre></div>

</figure>

<p><code>target</code> is the instance of the object being created.</p>

<p>For example:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">required</code><code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyName</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">propertyName</code><code class="si">}</code><code class="sb"> is required`</code><code class="p">);</code>
</pre></div>

</figure>
<p>}</p>

<p>class SomeClass {</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="err">@</code><code class="nx">required</code>
<code class="nx">importantProperty</code><code class="p">;</code>
</pre></div>

</figure>

<p>}</p>

<p>new SomeClass();  // -&gt; “importantProperty is required”</p>

<h4 id="leanpub-auto-decorator-factory">Decorator Factory</h4>

<p>A decorator factory is a function that returns a decorator function, like this:</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="kd">function</code> <code class="nx">regex</code><code class="p">(</code><code class="nx">pattern</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
	<code class="k">return</code> <code class="kd">function</code> <code class="p">(</code><code class="nx">target</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code> <code class="nx">propertyName</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">propertyName</code><code class="si">}</code><code class="sb"> must match regex </code><code class="si">${</code><code class="nx">pattern</code><code class="si">}</code><code class="sb">`</code><code class="p">);</code>
	<code class="p">}</code>
<code class="p">}</code>
</pre></div>

</figure>

<p>class SomeClass {</p>

<figure class="code">
<div class="highlight"><pre><code></code><code class="err">@</code><code class="nx">regex</code><code class="p">(</code><code class="s1">'[a-zA-Z0-9]'</code><code class="p">)</code>
<code class="nx">importantProperty</code><code class="p">;</code>
</pre></div>

</figure>

<p>}</p>

<p>new SomeClass();  // -&gt; “importantProperty must match regex [a-zA-Z0-9]</p>


</div>


</section>
</div>

</div>
<div id="react-modal"></div>

<footer class="footer">
<div class="container--medium">
<h1 class="footer-logo">
<a href="https://leanpub.com/"><img src="./Read Essential TypeScript _ Leanpub_files/logo-white-96-67-2x-59bc6e27ee93432fdf870def24412756.png" alt="Logo white 96 67 2x">
</a></h1>
<div class="footer-links">
<ul class="footer-list">
<li>
<h5 class="footer-list-title">About</h5>
</li>
<li><a href="https://leanpub.com/about">About Leanpub</a></li>
<li><a href="https://medium.com/@leanpub">Blog</a></li>
<li><a href="https://leanpub.com/team">Team</a></li>
<li><a href="https://itunes.apple.com/ca/podcast/leanpub-podcast/id517117137" target="_blank">Podcast</a></li>
<li><a href="https://leanpub.com/contact">Contact</a></li>
<li><a href="https://leanpub.com/press">Press</a></li>
</ul>
<ul class="footer-list">
<li>
<h5 class="footer-list-title">Authors</h5>
</li>
<li><a href="https://leanpub.com/authors">Why Leanpub</a></li>
<li><a href="https://leanpub.com/pricing">Pricing</a></li>
<li><a href="https://leanpub.com/manifesto">Manifesto</a></li>
<li><a href="https://leanpub.com/romance">Romance Authors</a></li>
</ul>
<ul class="footer-list">
<li>
<h5 class="footer-list-title">Author Support</h5>
</li>
<li><a href="http://help.leanpub.com/author-help">Author Help</a></li>
<li><a href="https://leanpub.com/help">Getting Started</a></li>
<li><a href="https://leanpub.com/help/manual">Manual</a></li>
<li><a href="https://leanpub.com/help/api">API Docs</a></li>
</ul>
<ul class="footer-list">
<li>
<h5 class="footer-list-title">More</h5>
</li>
<li><a href="http://help.leanpub.com/reader-help">Reader Help</a></li>
<li><a href="https://leanpub.com/p">Publishers</a></li>
<li><a href="https://leanpub.com/causes">Causes</a></li>
</ul>
<ul class="footer-list">
<li>
<h5 class="footer-list-title">Legal</h5>
</li>
<li><a href="https://leanpub.com/terms">Terms of Service</a></li>
<li><a href="https://leanpub.com/takedown">Copyright Policy</a></li>
<li><a href="https://leanpub.com/privacy">Privacy Policy</a></li>
</ul>
</div>
<p class="footer-copyright">
Leanpub is copyright © 2010-2017 <a href="http://ruboss.com/">Ruboss Technology Corp.</a> All rights reserved.
</p>
</div>
</footer>


<script src="./Read Essential TypeScript _ Leanpub_files/application-df3800d639800864275fc8dd84b4634f.js.download"></script>
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window,document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
 fbq('init', '210960779347704');
fbq('track', 'PageView');
</script>
<noscript>
 &lt;img height="1" width="1"
src="https://www.facebook.com/tr?id=210960779347704&amp;ev=PageView
&amp;noscript=1"/&gt;
</noscript>
<!-- End Facebook Pixel Code -->

<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','nw0pa');
twq('track','PageView');
</script>
<!-- End Twitter universal website tag code -->

<script type="text/javascript">  var _gaq = _gaq || [];
  _gaq.push(['account2._setAccount', 'UA-74747073-1']);
  _gaq.push(['account2._setDomainName', 'leanpub.com']);
  _gaq.push(['account2._trackPageview']);
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, monospace;"></div></div></body></html>